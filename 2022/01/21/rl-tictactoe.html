<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Solving Tic-Tac-Toe with RL | reconb</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Solving Tic-Tac-Toe with RL" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Jupyter notebook database." />
<meta property="og:description" content="Jupyter notebook database." />
<link rel="canonical" href="https://nb.recohut.com/2022/01/21/rl-tictactoe.html" />
<meta property="og:url" content="https://nb.recohut.com/2022/01/21/rl-tictactoe.html" />
<meta property="og:site_name" content="reconb" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-21T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Solving Tic-Tac-Toe with RL" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-21T00:00:00-06:00","datePublished":"2022-01-21T00:00:00-06:00","description":"Jupyter notebook database.","headline":"Solving Tic-Tac-Toe with RL","mainEntityOfPage":{"@type":"WebPage","@id":"https://nb.recohut.com/2022/01/21/rl-tictactoe.html"},"url":"https://nb.recohut.com/2022/01/21/rl-tictactoe.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nb.recohut.com/feed.xml" title="reconb" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">reconb</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Solving Tic-Tac-Toe with RL</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-21T00:00:00-06:00" itemprop="datePublished">
        Jan 21, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      19 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/recohut/notebook/tree/master/_notebooks/2022-01-21-rl-tictactoe.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/recohut/notebook/master?filepath=_notebooks%2F2022-01-21-rl-tictactoe.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/recohut/notebook/blob/master/_notebooks/2022-01-21-rl-tictactoe.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frecohut%2Fnotebook%2Fblob%2Fmaster%2F_notebooks%2F2022-01-21-rl-tictactoe.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-01-21-rl-tictactoe.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Imports">Imports<a class="anchor-link" href="#Imports"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Params">Params<a class="anchor-link" href="#Params"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Args</span><span class="p">:</span>

    <span class="n">agent_type</span> <span class="o">=</span> <span class="s2">&quot;q&quot;</span> <span class="c1"># &#39;q&#39; for Q-learning, &#39;s&#39; for SARSA, Specify the computer agent learning algorithm.</span>
    <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Specify the path for the agent pickle file. Defaults to q_agent.pkl for AGENT_TYPE=&#39;q&#39; and &quot;sarsa_agent.pkl for AGENT_TYPE=&#39;s&#39;.</span>
    <span class="n">load</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># whether to load trained agent</span>
    <span class="n">teacher_episodes</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># employ teacher agent who knows the optimal strategy and will play for TEACHER_EPISODES games</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">get_args</span><span class="p">():</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">Args</span><span class="p">()</span>
    <span class="c1"># set default path</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">args</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;q_agent.pkl&#39;</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span> <span class="k">else</span> <span class="s1">&#39;sarsa_agent.pkl&#39;</span>
    <span class="k">return</span> <span class="n">args</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logger">Logger<a class="anchor-link" href="#Logger"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span>
                    <span class="n">level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> [</span><span class="si">%(levelname)s</span><span class="s1">] : </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
                    <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">-%b-%y %H:%M:%S&#39;</span><span class="p">)</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;Tic-Tac-Toe Logger&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Utilities">Utilities<a class="anchor-link" href="#Utilities"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Environment">Environment<a class="anchor-link" href="#Environment"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Game</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; The game class. New instance created for each new game. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="n">teacher</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span> <span class="o">=</span> <span class="n">agent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="o">=</span> <span class="n">teacher</span>
        <span class="c1"># initialize the game board</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">playerMove</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Querry player for a move and update the board accordingly.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span><span class="o">.</span><span class="n">makeMove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">printBoard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">move</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Your move! Please select a row and column from 0-2 &quot;</span>
                             <span class="s2">&quot;in the format row,col: &quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">move</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INVALID INPUT! Please use the correct format.&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">row</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INVALID MOVE! Choose again.&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span>
                <span class="k">break</span>

    <span class="k">def</span> <span class="nf">agentMove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update board according to agent&#39;s move.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span>

    <span class="k">def</span> <span class="nf">checkForWin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check to see whether the player/agent with token &#39;key&#39; has won.</span>
<span class="sd">        Returns a boolean holding truth value.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : string</span>
<span class="sd">            token of most recent player. Either &#39;O&#39; or &#39;X&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check for player win on diagonals</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># check for player win on rows/columns</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">col</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">row</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">checkForDraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check to see whether the game has ended in a draw. Returns a</span>
<span class="sd">        boolean holding truth value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">draw</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elt</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">draw</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">draw</span>

    <span class="k">def</span> <span class="nf">checkForEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if player/agent with token &#39;key&#39; has ended the game. Returns -1</span>
<span class="sd">        if the game is still going, 0 if it is a draw, and 1 if the player/agent</span>
<span class="sd">        has won.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : string</span>
<span class="sd">            token of most recent player. Either &#39;O&#39; or &#39;X&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForWin</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">printBoard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Player wins!&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;RL agent wins!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForDraw</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">printBoard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;It&#39;s a draw!&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">playGame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player_first</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Begin the tic-tac-toe game loop. </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        player_first : boolean</span>
<span class="sd">            Whether or not the player will move first. If False, the</span>
<span class="sd">            agent goes first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize the agent&#39;s state and action</span>
        <span class="k">if</span> <span class="n">player_first</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerMove</span><span class="p">()</span>
        <span class="n">prev_state</span> <span class="o">=</span> <span class="n">getStateKey</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>
        <span class="n">prev_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">prev_state</span><span class="p">)</span>

        <span class="c1"># iterate until game is over</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># execute oldAction, observe reward and state</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agentMove</span><span class="p">(</span><span class="n">prev_action</span><span class="p">)</span>
            <span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForEnd</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">check</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># game is over. +1 reward if win, 0 if draw</span>
                <span class="n">reward</span> <span class="o">=</span> <span class="n">check</span>
                <span class="k">break</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">playerMove</span><span class="p">()</span>
            <span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkForEnd</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">check</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1"># game is over. -1 reward if lose, 0 if draw</span>
                <span class="n">reward</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">check</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># game continues. 0 reward</span>
                <span class="n">reward</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">new_state</span> <span class="o">=</span> <span class="n">getStateKey</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">board</span><span class="p">)</span>

            <span class="c1"># determine new action (epsilon-greedy)</span>
            <span class="n">new_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">get_action</span><span class="p">(</span><span class="n">new_state</span><span class="p">)</span>
            <span class="c1"># update Q-values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">prev_state</span><span class="p">,</span> <span class="n">new_state</span><span class="p">,</span> <span class="n">prev_action</span><span class="p">,</span> <span class="n">new_action</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>
            <span class="c1"># reset &quot;previous&quot; values</span>
            <span class="n">prev_state</span> <span class="o">=</span> <span class="n">new_state</span>
            <span class="n">prev_action</span> <span class="o">=</span> <span class="n">new_action</span>
            <span class="c1"># append reward</span>

        <span class="c1"># Game over. Perform final update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">prev_state</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">prev_action</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reward</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to determine who moves first, and subsequently, start the game.</span>
<span class="sd">        If a teacher is employed, first mover is selected at random.</span>
<span class="sd">        If a human is playing, the human is asked whether he/she would</span>
<span class="sd">        like to move fist. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># During teaching, chose who goes first randomly with equal probability</span>
            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">playGame</span><span class="p">(</span><span class="n">player_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">playGame</span><span class="p">(</span><span class="n">player_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Would you like to go first? [y/n]: &quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">or</span> <span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playGame</span><span class="p">(</span><span class="n">player_first</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">elif</span> <span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">response</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playGame</span><span class="p">(</span><span class="n">player_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please enter &#39;y&#39; or &#39;n&#39;.&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">printBoard</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prints the game board as text output to the terminal.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    board : list of lists</span>
<span class="sd">        the current game board</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;    0   1   2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">   &#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">   &#39;</span> <span class="o">%</span> <span class="n">elt</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">getStateKey</span><span class="p">(</span><span class="n">board</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts 2D list representing the board state into a string key</span>
<span class="sd">    for that state. Keys are used for Q-value hashing.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    board : list of lists</span>
<span class="sd">        the current game board</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">board</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">+=</span> <span class="n">elt</span>
    <span class="k">return</span> <span class="n">key</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Teacher</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    A class to implement a teacher that knows the optimal playing strategy.</span>
<span class="sd">    Teacher returns the best move at any time given the current state of the game.</span>
<span class="sd">    Note: things are a bit more hard-coded here, as this was not the main focus of</span>
<span class="sd">    the exercise so I did not spend as much time on design/style. Everything works</span>
<span class="sd">    properly when tested.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    level : float </span>
<span class="sd">        teacher ability level. This is a value between 0-1 that indicates the</span>
<span class="sd">        probability of making the optimal move at any given time.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ability level determines the probability that the teacher will follow</span>
<span class="sd">        the optimal strategy as opposed to choosing a random available move.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ability_level</span> <span class="o">=</span> <span class="n">level</span>

    <span class="k">def</span> <span class="nf">win</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If we have two in a row and the 3rd is available, take it. &quot;&quot;&quot;</span>
        <span class="c1"># Check for diagonal wins</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind</span>
        <span class="k">elif</span> <span class="n">b</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">b</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
        <span class="c1"># Now check for 2 in a row/column + empty 3rd</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ind</span><span class="p">,</span> <span class="n">i</span>
            <span class="k">elif</span> <span class="n">d</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">d</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ind</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">blockWin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Block the opponent if she has a win available. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fork</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create a fork opportunity such that we have 2 threats to win. &quot;&quot;&quot;</span>
        <span class="c1"># Check all adjacent side middles</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="c1"># Check all cross corners</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">blockFork</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Block the opponents fork if she has one available. &quot;&quot;&quot;</span>
        <span class="n">corners</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span>
        <span class="c1"># Check all adjacent side middles</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="c1"># Check all cross corners (first check for double fork opp using the corners array)</span>
        <span class="k">elif</span> <span class="n">corners</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">corners</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pick the center if it is available. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">corner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pick a corner move. &quot;&quot;&quot;</span>
        <span class="c1"># Pick opposite corner of opponent if available</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span> <span class="ow">and</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="c1"># Pick any corner if no opposites are available</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">sideEmpty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pick an empty side. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">board</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">randomMove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Chose a random move from the available options. &quot;&quot;&quot;</span>
        <span class="n">possibles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">board</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">possibles</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">possibles</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibles</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">makeMove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">board</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Trainer goes through a hierarchy of moves, making the best move that</span>
<span class="sd">        is currently available each time. A touple is returned that represents</span>
<span class="sd">        (row, col).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Chose randomly with some probability so that the teacher does not always win</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">ability_level</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">randomMove</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="c1"># Follow optimal strategy</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">win</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockWin</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fork</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blockFork</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sideEmpty</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">randomMove</span><span class="p">(</span><span class="n">board</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Agents">Agents<a class="anchor-link" href="#Agents"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Learner</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parent class for Q-learning and SARSA agents.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    alpha : float </span>
<span class="sd">        learning rate</span>
<span class="sd">    gamma : float</span>
<span class="sd">        temporal discounting rate</span>
<span class="sd">    eps : float </span>
<span class="sd">        probability of random action vs. greedy action</span>
<span class="sd">    eps_decay : float</span>
<span class="sd">        epsilon decay rate. Larger value = more decay</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_decay</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="c1"># Agent parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps_decay</span> <span class="o">=</span> <span class="n">eps_decay</span>
        <span class="c1"># Possible actions correspond to the set of all x,y coordinate pairs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
        <span class="c1"># Initialize Q values to 0 for all state-action pairs.</span>
        <span class="c1"># Access value for action a, state s via Q[a][s]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="c1"># Keep a list of reward received at each episode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select an action given the current game state.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : string</span>
<span class="sd">            state</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Only consider the allowed actions (empty board spaces)</span>
        <span class="n">possible_actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">:</span>
            <span class="c1"># Random choose.</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">possible_actions</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">possible_actions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Greedy choose.</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">possible_actions</span><span class="p">])</span>
            <span class="c1"># Find location of max</span>
            <span class="n">ix_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">values</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ix_max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If multiple actions were max, then sample from them</span>
                <span class="n">ix_select</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ix_max</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If unique max action, select that one</span>
                <span class="n">ix_select</span> <span class="o">=</span> <span class="n">ix_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">possible_actions</span><span class="p">[</span><span class="n">ix_select</span><span class="p">]</span>

        <span class="c1"># update epsilon; geometric decay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eps</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">eps_decay</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">action</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pickle the agent object instance to save the agent&#39;s state. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;model saved at </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">Qlearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to implement the Q-learning agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_decay</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_decay</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform the Q-Learning update of Q values.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : string</span>
<span class="sd">            previous state</span>
<span class="sd">        s_ : string</span>
<span class="sd">            new state</span>
<span class="sd">        a : (i,j) tuple</span>
<span class="sd">            previous action</span>
<span class="sd">        a_ : (i,j) tuple</span>
<span class="sd">            new action. NOT used by Q-learner!</span>
<span class="sd">        r : int</span>
<span class="sd">            reward received after executing action &quot;a&quot; in state &quot;s&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Update Q(s,a)</span>
        <span class="k">if</span> <span class="n">s_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># hold list of Q values for all a_,s_ pairs. We will access the max later</span>
            <span class="n">possible_actions</span> <span class="o">=</span> <span class="p">[</span><span class="n">action</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="k">if</span> <span class="n">s_</span><span class="p">[</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="n">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">]</span>
            <span class="n">Q_options</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">action</span><span class="p">][</span><span class="n">s_</span><span class="p">]</span> <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">possible_actions</span><span class="p">]</span>
            <span class="c1"># update</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">Q_options</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># terminal state update</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>

        <span class="c1"># add r to rewards list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">SARSAlearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to implement the SARSA agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_decay</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_decay</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s_</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform the SARSA update of Q values.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : string</span>
<span class="sd">            previous state</span>
<span class="sd">        s_ : string</span>
<span class="sd">            new state</span>
<span class="sd">        a : (i,j) tuple</span>
<span class="sd">            previous action</span>
<span class="sd">        a_ : (i,j) tuple</span>
<span class="sd">            new action</span>
<span class="sd">        r : int</span>
<span class="sd">            reward received after executing action &quot;a&quot; in state &quot;s&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Update Q(s,a)</span>
        <span class="k">if</span> <span class="n">s_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a_</span><span class="p">][</span><span class="n">s_</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># terminal state update</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="n">s</span><span class="p">])</span>

        <span class="c1"># add r to rewards list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simulation">Simulation<a class="anchor-link" href="#Simulation"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">GameLearning</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that holds the state of the learning process. Learning</span>
<span class="sd">    agents are created/loaded here, and a count is kept of the</span>
<span class="sd">    games that have been played.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">load</span><span class="p">:</span>
            <span class="c1"># load an existing agent and continue training</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot load agent: file does not exist.&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">agent</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># check if agent state file already exists, and ask</span>
            <span class="c1"># user whether to overwrite if so</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;An agent is already saved at </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Are you sure you want to overwrite? [y/n]: &quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]:</span>
                        <span class="k">break</span>
                    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK. Quitting.&quot;</span><span class="p">)</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please choose &#39;y&#39; or &#39;n&#39;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">==</span> <span class="s2">&quot;q&quot;</span><span class="p">:</span>
                <span class="n">agent</span> <span class="o">=</span> <span class="n">Qlearner</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">agent</span> <span class="o">=</span> <span class="n">SARSAlearner</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">epsilon</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span> <span class="o">=</span> <span class="n">agent</span>

    <span class="k">def</span> <span class="nf">beginPlaying</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Loop through game iterations with a human player. &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Welcome to Tic-Tac-Toe. You are &#39;X&#39; and the computer is &#39;O&#39;.&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">play_again</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Games played: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span><span class="p">)</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">play</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Do you want to play again? [y/n]: &quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">play</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">play</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">play</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span> <span class="ow">or</span> <span class="n">play</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid input. Please choose &#39;y&#39; or &#39;n&#39;.&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">)</span>
            <span class="n">game</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">play_again</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OK. Quitting.&quot;</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="k">def</span> <span class="nf">beginTeaching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">episodes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Loop through game iterations with a teaching agent. &quot;&quot;&quot;</span>
        <span class="n">teacher</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">()</span>
        <span class="c1"># Train for alotted number of episodes</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span> <span class="o">&lt;</span> <span class="n">episodes</span><span class="p">:</span>
            <span class="n">game</span> <span class="o">=</span> <span class="n">Game</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="p">,</span> <span class="n">teacher</span><span class="o">=</span><span class="n">teacher</span><span class="p">)</span>
            <span class="n">game</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Monitor progress</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Games played: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">games_played</span><span class="p">)</span>
        <span class="c1"># save final agent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">plot_agent_reward</span><span class="p">(</span><span class="n">rewards</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Function to plot agent&#39;s accumulated reward vs. iteration &quot;&quot;&quot;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rewards</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Agent Cumulative Reward vs. Iteration&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reward&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Episode&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Jobs">Jobs<a class="anchor-link" href="#Jobs"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB START: employing expert to play game with q-learning&#39;</span><span class="p">)</span>
<span class="c1"># get default args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="c1"># set args</span>
<span class="n">args</span><span class="o">.</span><span class="n">teacher_episodes</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="c1"># initialize game instance</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">GameLearning</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="c1"># letting teacher/expert play</span>
<span class="n">gl</span><span class="o">.</span><span class="n">beginTeaching</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">teacher_episodes</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB END: employing expert to play game with q-learning&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 10:52:21 [INFO] : JOB START: employing expert to play game with q-learning
An agent is already saved at q_agent.pkl.
Are you sure you want to overwrite? [y/n]: y
08-Nov-21 10:52:23 [INFO] : Games played: 1000
08-Nov-21 10:52:23 [INFO] : JOB END: employing expert to play game with q-learning
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB START: playing game with on q-learning&#39;</span><span class="p">)</span>
<span class="c1"># get default args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="c1"># initialize game instance</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">GameLearning</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="c1"># start playing</span>
<span class="n">gl</span><span class="o">.</span><span class="n">beginPlaying</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB END: playing game with on q-learning&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 10:53:20 [INFO] : JOB START: playing game with on q-learning
An agent is already saved at q_agent.pkl.
Are you sure you want to overwrite? [y/n]: y
Welcome to Tic-Tac-Toe. You are &#39;X&#39; and the computer is &#39;O&#39;.
Would you like to go first? [y/n]: y

    0   1   2

0   -   -   -   

1   -   -   -   

2   -   -   -   

Your move! Please select a row and column from 0-2 in the format row,col: 2,0


    0   1   2

0   -   -   -   

1   -   O   -   

2   X   -   -   

Your move! Please select a row and column from 0-2 in the format row,col: 0,0


    0   1   2

0   X   -   -   

1   O   O   -   

2   X   -   -   

Your move! Please select a row and column from 0-2 in the format row,col: 1,2


    0   1   2

0   X   -   -   

1   O   O   X   

2   X   O   -   

Your move! Please select a row and column from 0-2 in the format row,col: 0,1


    0   1   2

0   X   X   O   

1   O   O   X   

2   X   O   -   

Your move! Please select a row and column from 0-2 in the format row,col: 2,2


    0   1   2

0   X   X   O   

1   O   O   X   

2   X   O   X   

It&#39;s a draw!
08-Nov-21 10:56:46 [INFO] : Games played: 1
Do you want to play again? [y/n]: n
OK. Quitting.
08-Nov-21 10:56:51 [INFO] : JOB END: playing game with on q-learning
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB START: employing expert to play game with sarsa&#39;</span><span class="p">)</span>
<span class="c1"># get default args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="c1"># set args</span>
<span class="n">args</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
<span class="n">args</span><span class="o">.</span><span class="n">teacher_episodes</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="c1"># initialize game instance</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">GameLearning</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="c1"># letting teacher/expert play</span>
<span class="n">gl</span><span class="o">.</span><span class="n">beginTeaching</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">teacher_episodes</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB END: employing expert to play game with sarsa&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 10:57:33 [INFO] : JOB START: employing expert to play game with sarsa
An agent is already saved at q_agent.pkl.
Are you sure you want to overwrite? [y/n]: y
08-Nov-21 10:57:46 [INFO] : Games played: 1000
08-Nov-21 10:57:46 [INFO] : JOB END: employing expert to play game with sarsa
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB START: playing game with on sarsa&#39;</span><span class="p">)</span>
<span class="c1"># get default args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="c1"># set args</span>
<span class="n">args</span><span class="o">.</span><span class="n">agent_type</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
<span class="c1"># initialize game instance</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">GameLearning</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="c1"># start playing</span>
<span class="n">gl</span><span class="o">.</span><span class="n">beginPlaying</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB END: playing game with on sarsa&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 10:58:27 [INFO] : JOB START: playing game with on sarsa
An agent is already saved at q_agent.pkl.
Are you sure you want to overwrite? [y/n]: y
Welcome to Tic-Tac-Toe. You are &#39;X&#39; and the computer is &#39;O&#39;.
Would you like to go first? [y/n]: y

    0   1   2

0   -   -   -   

1   -   -   -   

2   -   -   -   

Your move! Please select a row and column from 0-2 in the format row,col: 0,0


    0   1   2

0   X   -   -   

1   -   -   -   

2   -   -   O   

Your move! Please select a row and column from 0-2 in the format row,col: 2,0


    0   1   2

0   X   -   -   

1   -   -   O   

2   X   -   O   

Your move! Please select a row and column from 0-2 in the format row,col: 1,0


    0   1   2

0   X   -   -   

1   X   -   O   

2   X   -   O   

Player wins!
08-Nov-21 10:59:19 [INFO] : Games played: 1
Do you want to play again? [y/n]: n
OK. Quitting.
08-Nov-21 10:59:24 [INFO] : JOB END: playing game with on sarsa
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB START: plotting agent rewards&#39;</span><span class="p">)</span>
<span class="c1"># get default args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="c1"># loading agent</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="c1"># plot rewards</span>
<span class="n">plot_agent_reward</span><span class="p">(</span><span class="n">agent</span><span class="o">.</span><span class="n">rewards</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;JOB END: plotting agent rewards&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 11:06:02 [INFO] : JOB START: plotting agent rewards
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>08-Nov-21 11:06:02 [INFO] : JOB END: plotting agent rewards
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/2022/01/21/rl-tictactoe.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Jupyter notebook database.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/recohut" target="_blank" title="recohut"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
