<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>RecSys RetailRocket | reconb</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="RecSys RetailRocket" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Jupyter notebook database." />
<meta property="og:description" content="Jupyter notebook database." />
<link rel="canonical" href="https://nb.recohut.com/2022/01/16/retailrocket.html" />
<meta property="og:url" content="https://nb.recohut.com/2022/01/16/retailrocket.html" />
<meta property="og:site_name" content="reconb" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-16T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="RecSys RetailRocket" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-16T00:00:00-06:00","datePublished":"2022-01-16T00:00:00-06:00","description":"Jupyter notebook database.","headline":"RecSys RetailRocket","mainEntityOfPage":{"@type":"WebPage","@id":"https://nb.recohut.com/2022/01/16/retailrocket.html"},"url":"https://nb.recohut.com/2022/01/16/retailrocket.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nb.recohut.com/feed.xml" title="reconb" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">reconb</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">RecSys RetailRocket</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-01-16T00:00:00-06:00" itemprop="datePublished">
        Jan 16, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/recohut/notebook/tree/master/_notebooks/2022-01-16-retailrocket.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/recohut/notebook/master?filepath=_notebooks%2F2022-01-16-retailrocket.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/recohut/notebook/blob/master/_notebooks/2022-01-16-retailrocket.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frecohut%2Fnotebook%2Fblob%2Fmaster%2F_notebooks%2F2022-01-16-retailrocket.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-01-16-retailrocket.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !pip install --upgrade --force-reinstall --no-deps kaggle</span>
<span class="c1"># !mkdir ~/.kaggle</span>
<span class="c1"># !cp /content/drive/MyDrive/kaggle.json ~/.kaggle/</span>
<span class="c1"># !chmod 600 ~/.kaggle/kaggle.json</span>
<span class="c1"># # !kaggle datasets list</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>kaggle datasets download -d retailrocket/ecommerce-dataset
<span class="o">!</span>mkdir -p ./data <span class="o">&amp;&amp;</span> unzip ecommerce-dataset.zip
<span class="o">!</span>mv ./*.csv ./data <span class="o">&amp;&amp;</span> rm ecommerce-dataset.zip
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">bz2</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Loading">Data Loading<a class="anchor-link" href="#Data-Loading"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">events_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/events.csv&#39;</span><span class="p">)</span>
<span class="n">category_tree_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/category_tree.csv&#39;</span><span class="p">)</span>
<span class="n">item_properties_1_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/item_properties_part1.csv&#39;</span><span class="p">)</span>
<span class="n">item_properties_2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/item_properties_part2.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_prop_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">item_properties_1_df</span><span class="p">,</span> <span class="n">item_properties_2_df</span><span class="p">])</span>
<span class="n">item_prop_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">del</span> <span class="n">item_properties_1_df</span>
<span class="k">del</span> <span class="n">item_properties_2_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">events_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>visitorid</th>
      <th>event</th>
      <th>itemid</th>
      <th>transactionid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1433221332117</td>
      <td>257597</td>
      <td>view</td>
      <td>355908</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1433224214164</td>
      <td>992329</td>
      <td>view</td>
      <td>248676</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1433221999827</td>
      <td>111016</td>
      <td>view</td>
      <td>318965</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1433221955914</td>
      <td>483717</td>
      <td>view</td>
      <td>253185</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1433221337106</td>
      <td>951259</td>
      <td>view</td>
      <td>367447</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>itemid</th>
      <th>property</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1435460400000</td>
      <td>460429</td>
      <td>categoryid</td>
      <td>1338</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1441508400000</td>
      <td>206783</td>
      <td>888</td>
      <td>1116713 960601 n277.200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1439089200000</td>
      <td>395014</td>
      <td>400</td>
      <td>n552.000 639502 n720.000 424566</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1431226800000</td>
      <td>59481</td>
      <td>790</td>
      <td>n15360.000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1431831600000</td>
      <td>156781</td>
      <td>917</td>
      <td>828513</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Property is the Item's attributes such as category id and availability while the rest are hashed for confidentiality purposes</p>
</li>
<li><p>Value is the item's property value e.g. availability is 1 if there is stock and 0 otherwise</p>
</li>
<li><p>Note: Values that start with "n" indicate that the value preceeding it is a number e.g. n277.200 is equal to <code>277.2</code></p>
</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">category_tree_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>categoryid</th>
      <th>parentid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1016</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>809</td>
      <td>169.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>570</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1691</td>
      <td>885.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>536</td>
      <td>1691.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="EDA">EDA<a class="anchor-link" href="#EDA"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q: what are the items under category id <code>1016</code>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">property</span> <span class="o">==</span> <span class="s1">&#39;categoryid&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;1016&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>itemid</th>
      <th>property</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18236968</th>
      <td>1431226800000</td>
      <td>6777</td>
      <td>categoryid</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>8597591</th>
      <td>1431226800000</td>
      <td>161686</td>
      <td>categoryid</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>9496408</th>
      <td>1431226800000</td>
      <td>276491</td>
      <td>categoryid</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>17880130</th>
      <td>1431226800000</td>
      <td>443058</td>
      <td>categoryid</td>
      <td>1016</td>
    </tr>
    <tr>
      <th>18202530</th>
      <td>1431226800000</td>
      <td>462004</td>
      <td>categoryid</td>
      <td>1016</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q: What is the parent category of <code>1016</code>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">category_tree_df</span><span class="p">[</span><span class="n">category_tree_df</span><span class="o">.</span><span class="n">categoryid</span><span class="o">==</span><span class="mi">1016</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>categoryid</th>
      <th>parentid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1016</td>
      <td>213.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Q: What are items under category <code>213</code>?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">property</span> <span class="o">==</span> <span class="s1">&#39;categoryid&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">item_prop_df</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;213&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>itemid</th>
      <th>property</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>visitors who bought something, assuming that there were no repeat users with different visitor IDs</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">customer_purchased</span> <span class="o">=</span> <span class="n">events_df</span><span class="p">[</span><span class="n">events_df</span><span class="o">.</span><span class="n">transactionid</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">visitorid</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">all_customers</span> <span class="o">=</span> <span class="n">events_df</span><span class="o">.</span><span class="n">visitorid</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">customer_browsed</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_customers</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">customer_purchased</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_customers</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">customer_browsed</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_customers</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>11719 out of 1407580
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Snapshot of a random session with visitor id 102019</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">events_df</span><span class="p">[</span><span class="n">events_df</span><span class="o">.</span><span class="n">visitorid</span> <span class="o">==</span> <span class="mi">102019</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>visitorid</th>
      <th>event</th>
      <th>itemid</th>
      <th>transactionid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19690</th>
      <td>1433175714335</td>
      <td>102019</td>
      <td>view</td>
      <td>49521</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19501</th>
      <td>1433175801314</td>
      <td>102019</td>
      <td>addtocart</td>
      <td>49521</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14842</th>
      <td>1433175812596</td>
      <td>102019</td>
      <td>view</td>
      <td>150318</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19573</th>
      <td>1433175871497</td>
      <td>102019</td>
      <td>view</td>
      <td>49521</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8701</th>
      <td>1433175894837</td>
      <td>102019</td>
      <td>view</td>
      <td>49521</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19708</th>
      <td>1433175945872</td>
      <td>102019</td>
      <td>view</td>
      <td>150318</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8740</th>
      <td>1433176042269</td>
      <td>102019</td>
      <td>view</td>
      <td>49521</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>814</th>
      <td>1433176736375</td>
      <td>102019</td>
      <td>transaction</td>
      <td>150318</td>
      <td>13556.0</td>
    </tr>
    <tr>
      <th>19724</th>
      <td>1433176736422</td>
      <td>102019</td>
      <td>transaction</td>
      <td>49521</td>
      <td>13556.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_todatetime</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dt</span><span class="o">/</span><span class="mi">1000</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Range of transaction dates = &#39;</span><span class="p">,</span> <span class="n">_todatetime</span><span class="p">(</span><span class="n">events_df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="s1">&#39;to&#39;</span><span class="p">,</span> <span class="n">_todatetime</span><span class="p">(</span><span class="n">events_df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Range of transaction dates =  2015-05-03 03:00:04 to 2015-09-18 02:59:47
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing">Preprocessing<a class="anchor-link" href="#Preprocessing"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">preprocess_events</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

  <span class="c1"># convert unix time to pandas datetime</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;unix&#39;</span><span class="p">)</span>
  
  <span class="c1"># label the events</span>
  <span class="c1"># events.event.replace(to_replace=dict(view=1, addtocart=2, transaction=3), inplace=True)</span>

  <span class="c1"># convert event to categorical</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;event_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>

  <span class="c1"># # drop the transcationid and timestamp columns</span>
  <span class="c1"># df.drop([&#39;transactionid&#39;, &#39;timestamp&#39;], axis=1, inplace=True)</span>

  <span class="c1"># # label encode</span>
  <span class="c1"># le_users = LabelEncoder()</span>
  <span class="c1"># le_items = LabelEncoder()</span>
  <span class="c1"># events[&#39;visitorid&#39;] = le_users.fit_transform(events[&#39;visitorid&#39;])</span>
  <span class="c1"># events[&#39;itemid&#39;] = le_items.fit_transform(events[&#39;itemid&#39;])</span>
  
  <span class="c1"># return train, valid, test</span>
  <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">events_processed</span> <span class="o">=</span> <span class="n">preprocess_events</span><span class="p">(</span><span class="n">events_df</span><span class="p">)</span>
<span class="n">events_processed</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>visitorid</th>
      <th>event</th>
      <th>itemid</th>
      <th>transactionid</th>
      <th>date</th>
      <th>event_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1433221332117</td>
      <td>257597</td>
      <td>view</td>
      <td>355908</td>
      <td>NaN</td>
      <td>2015-06-02 05:02:12.117</td>
      <td>view</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1433224214164</td>
      <td>992329</td>
      <td>view</td>
      <td>248676</td>
      <td>NaN</td>
      <td>2015-06-02 05:50:14.164</td>
      <td>view</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1433221999827</td>
      <td>111016</td>
      <td>view</td>
      <td>318965</td>
      <td>NaN</td>
      <td>2015-06-02 05:13:19.827</td>
      <td>view</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1433221955914</td>
      <td>483717</td>
      <td>view</td>
      <td>253185</td>
      <td>NaN</td>
      <td>2015-06-02 05:12:35.914</td>
      <td>view</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1433221337106</td>
      <td>951259</td>
      <td>view</td>
      <td>367447</td>
      <td>NaN</td>
      <td>2015-06-02 05:02:17.106</td>
      <td>view</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfx</span> <span class="o">=</span> <span class="n">events_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sessionize</span><span class="p">(</span><span class="n">events_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>

  <span class="n">session_duration</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
  <span class="n">gpby_visitorid</span> <span class="o">=</span> <span class="n">events_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;visitorid&#39;</span><span class="p">)</span>

  <span class="n">session_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">a_visitorid</span> <span class="ow">in</span> <span class="n">gpby_visitorid</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>

    <span class="n">visitor_df</span> <span class="o">=</span> <span class="n">events_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">gpby_visitorid</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">a_visitorid</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visitor_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">visitor_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Initialise first session</span>
        <span class="n">startdate</span> <span class="o">=</span> <span class="n">visitor_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:][</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
        <span class="n">visitorid</span> <span class="o">=</span> <span class="n">a_visitorid</span>
        <span class="n">items_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">events_df</span><span class="p">[</span><span class="s1">&#39;event_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span> <span class="p">])</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">visitor_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>

            <span class="c1"># Check if current event date is within session duration</span>
            <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">startdate</span> <span class="o">&lt;=</span> <span class="n">session_duration</span><span class="p">:</span>
            <span class="c1"># Add itemid to the list according to event type (i.e. view, addtocart or transaction)</span>
                <span class="n">items_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span>
                <span class="n">enddate</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Complete current session</span>
                <span class="n">session_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">visitorid</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">])</span>
                <span class="c1"># Start a new session</span>
                <span class="n">startdate</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
                <span class="n">items_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">events_df</span><span class="p">[</span><span class="s1">&#39;event_type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span> <span class="p">])</span>
                <span class="c1"># Add current itemid</span>
                <span class="n">items_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">])</span>

        <span class="c1"># If dict if not empty, add item data as last session.</span>
        <span class="n">incomplete_session</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">incomplete_session</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">incomplete_session</span><span class="p">:</span>
            <span class="n">session_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">visitorid</span><span class="p">,</span> <span class="n">startdate</span><span class="p">,</span> <span class="n">enddate</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">items_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

  <span class="k">return</span> <span class="n">session_list</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">session_list</span> <span class="o">=</span> <span class="n">sessionize</span><span class="p">(</span><span class="n">dfx</span><span class="p">)</span>
<span class="n">sessions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">session_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;visitorid&#39;</span><span class="p">,</span> <span class="s1">&#39;startdate&#39;</span><span class="p">,</span> <span class="s1">&#39;enddate&#39;</span><span class="p">,</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">,</span> <span class="s1">&#39;transaction&#39;</span><span class="p">,</span> <span class="s1">&#39;view&#39;</span><span class="p">])</span>
<span class="n">sessions_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>visitorid</th>
      <th>startdate</th>
      <th>enddate</th>
      <th>addtocart</th>
      <th>transaction</th>
      <th>view</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24</td>
      <td>2015-05-22 18:21:49.615</td>
      <td>2015-05-22 18:21:49.615</td>
      <td>[]</td>
      <td>[]</td>
      <td>[346051]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27</td>
      <td>2015-07-24 08:51:19.750</td>
      <td>2015-07-24 08:51:19.750</td>
      <td>[]</td>
      <td>[]</td>
      <td>[314714]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>64</td>
      <td>2015-06-15 22:58:56.974</td>
      <td>2015-06-15 22:58:56.974</td>
      <td>[]</td>
      <td>[]</td>
      <td>[160984]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>81</td>
      <td>2015-09-10 16:20:45.920</td>
      <td>2015-09-10 16:20:45.920</td>
      <td>[]</td>
      <td>[]</td>
      <td>[337512]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>150</td>
      <td>2015-06-07 23:26:40.541</td>
      <td>2015-06-07 23:26:40.541</td>
      <td>[]</td>
      <td>[]</td>
      <td>[186933]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">BaseDataset</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_path</span> <span class="o">=</span> <span class="n">input_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_path</span> <span class="o">=</span> <span class="n">output_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_output_path</span><span class="p">()</span>

        <span class="c1"># input file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;inters.dat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;items.dat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;users.dat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>

        <span class="c1"># output file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_item_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_user_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_output_files</span><span class="p">()</span>

        <span class="c1"># selected feature fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_fields</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_fields</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">check_output_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_output_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output_inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;.inter&#39;</span><span class="p">)</span>
        <span class="n">output_item_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;.item&#39;</span><span class="p">)</span>
        <span class="n">output_user_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">+</span> <span class="s1">&#39;.user&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_inter_file</span><span class="p">,</span> <span class="n">output_item_file</span><span class="p">,</span> <span class="n">output_user_file</span>

    <span class="k">def</span> <span class="nf">load_inter_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">load_item_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">load_user_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">convert_inter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">input_inter_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_inter_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">input_inter_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This dataset can</span><span class="se">\&#39;</span><span class="s1">t be converted to inter file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">input_item_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_item_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">input_item_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_item_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This dataset can</span><span class="se">\&#39;</span><span class="s1">t be converted to item file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">convert_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">input_user_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_user_data</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">input_user_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_fields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_user_file</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This dataset can</span><span class="se">\&#39;</span><span class="s1">t be converted to user file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">selected_fields</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">selected_fields</span><span class="p">:</span>
            <span class="n">output_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">column</span><span class="p">]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">selected_fields</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">output_data</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">output_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
                                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">parse_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">g</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                <span class="k">yield</span> <span class="nb">eval</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">df</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_json</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">RETAILROCKETDataset</span><span class="p">(</span><span class="n">BaseDataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">interaction_type</span><span class="p">,</span> <span class="n">duplicate_removal</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RETAILROCKETDataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_name</span> <span class="o">=</span> <span class="s1">&#39;retailrocket&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">=</span> <span class="n">interaction_type</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;transaction&#39;</span><span class="p">],</span> <span class="s1">&#39;interaction_type must be in [view, addtocart, transaction]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duplicate_removal</span> <span class="o">=</span> <span class="n">duplicate_removal</span>

        <span class="c1"># input file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;events.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_file1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;item_properties_part1.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_file2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;item_properties_part2.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>

        <span class="c1"># output file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;retailrocket-view.inter&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;retailrocket-addtocart.inter&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;retailrocket-transaction.inter&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_item_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="s1">&#39;retailrocket.item&#39;</span><span class="p">)</span>

        <span class="c1"># selected feature fields</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplicate_removal</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;count:float&#39;</span><span class="p">}</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;count:float&#39;</span><span class="p">}</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;count:float&#39;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">}</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">}</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">==</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;timestamp:float&#39;</span><span class="p">,</span>
                                     <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;visitor_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">,</span>
                                     <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;transaction_id:token&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item_fields</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;item_timestamp:float&#39;</span><span class="p">,</span>
                            <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;item_id:token&#39;</span><span class="p">,</span>
                            <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;property:token&#39;</span><span class="p">,</span>
                            <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;value:token_seq&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">convert_inter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duplicate_removal</span><span class="p">:</span>
            <span class="n">fin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inter_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

            <span class="n">lines_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fin</span><span class="p">:</span>
                <span class="n">lines_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">fin</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lines_count</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="k">continue</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span>
                        <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                            <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">fin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inter_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_inter_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

            <span class="n">lines_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fin</span><span class="p">:</span>
                <span class="n">lines_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">fin</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inter_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lines_count</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">fin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="k">continue</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">fin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">interaction_type</span> <span class="o">!=</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">line_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">del</span> <span class="n">line_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line_list</span><span class="p">))])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">fin</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">convert_item</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fin1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_file1</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">fin2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">item_file2</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">fout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_item_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="n">lines_count1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fin1</span><span class="p">:</span>
            <span class="n">lines_count1</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">fin1</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">lines_count2</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">fin2</span><span class="p">:</span>
            <span class="n">lines_count2</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">fin2</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">item_fields</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lines_count1</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">fin1</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">fin1</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line_list</span><span class="p">))]))</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lines_count2</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">fin2</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">fin2</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">line_list</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="n">fout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">line_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line_list</span><span class="p">))]))</span>

        <span class="n">fin1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">fin2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">fout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># data_object.convert_inter()</span>
<span class="c1"># data_object.convert_item()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11000000/11000000 [00:23&lt;00:00, 472602.35it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 9275904/9275904 [00:19&lt;00:00, 478121.32it/s]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-Engineering">Feature Engineering<a class="anchor-link" href="#Feature-Engineering"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Page Time</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sessions_df</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sessions_df</span><span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">pages_more_than1</span> <span class="o">=</span> <span class="n">sessions_df</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span>
<span class="n">pages_less_than1</span> <span class="o">=</span> <span class="n">pages_more_than1</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">)</span>
<span class="n">sessions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pages_more_than1</span><span class="p">,</span> <span class="s1">&#39;pagetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">sessions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pages_more_than1</span><span class="p">,</span> <span class="s1">&#39;enddate&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">sessions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pages_more_than1</span><span class="p">,</span> <span class="s1">&#39;startdate&#39;</span><span class="p">])</span> <span class="o">/</span>\
                                                <span class="p">(</span><span class="n">sessions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pages_more_than1</span><span class="p">,</span> <span class="s1">&#39;pages&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sessions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pages_less_than1</span><span class="p">,</span> <span class="s1">&#39;pagetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sessions_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>visitorid</th>
      <th>startdate</th>
      <th>enddate</th>
      <th>addtocart</th>
      <th>transaction</th>
      <th>view</th>
      <th>pages</th>
      <th>pagetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>24</td>
      <td>2015-05-22 18:21:49.615</td>
      <td>2015-05-22 18:21:49.615</td>
      <td>[]</td>
      <td>[]</td>
      <td>[346051]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27</td>
      <td>2015-07-24 08:51:19.750</td>
      <td>2015-07-24 08:51:19.750</td>
      <td>[]</td>
      <td>[]</td>
      <td>[314714]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>2</th>
      <td>64</td>
      <td>2015-06-15 22:58:56.974</td>
      <td>2015-06-15 22:58:56.974</td>
      <td>[]</td>
      <td>[]</td>
      <td>[160984]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>3</th>
      <td>81</td>
      <td>2015-09-10 16:20:45.920</td>
      <td>2015-09-10 16:20:45.920</td>
      <td>[]</td>
      <td>[]</td>
      <td>[337512]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>4</th>
      <td>150</td>
      <td>2015-06-07 23:26:40.541</td>
      <td>2015-06-07 23:26:40.541</td>
      <td>[]</td>
      <td>[]</td>
      <td>[186933]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>5</th>
      <td>224</td>
      <td>2015-08-03 05:27:35.713</td>
      <td>2015-08-03 05:27:35.713</td>
      <td>[]</td>
      <td>[]</td>
      <td>[168697]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>6</th>
      <td>255</td>
      <td>2015-08-27 07:49:07.215</td>
      <td>2015-08-27 07:49:07.215</td>
      <td>[]</td>
      <td>[]</td>
      <td>[83574]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>7</th>
      <td>264</td>
      <td>2015-09-07 17:09:12.830</td>
      <td>2015-09-07 17:09:12.830</td>
      <td>[]</td>
      <td>[]</td>
      <td>[161949]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>8</th>
      <td>295</td>
      <td>2015-07-16 22:56:09.078</td>
      <td>2015-07-16 22:56:09.078</td>
      <td>[]</td>
      <td>[]</td>
      <td>[445817]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
    <tr>
      <th>9</th>
      <td>301</td>
      <td>2015-06-10 21:04:18.505</td>
      <td>2015-06-10 21:04:18.505</td>
      <td>[]</td>
      <td>[]</td>
      <td>[209372]</td>
      <td>1</td>
      <td>0 days</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The rule of thumb on creating a simple yet effective recommender system is to downsample the data without losing quality. It means, you can take only maybe 50 latest transactions for each user and you still get the quality you want because behavior changes over-time.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans</span> <span class="o">=</span> <span class="n">events_df</span><span class="p">[</span><span class="n">events_df</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;transaction&#39;</span><span class="p">]</span>
<span class="n">trans2</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;visitorid&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">trans2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>visitorid</th>
      <th>event</th>
      <th>itemid</th>
      <th>transactionid</th>
      <th>date</th>
      <th>event_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>1433222276276</td>
      <td>599528</td>
      <td>transaction</td>
      <td>356475</td>
      <td>4000.0</td>
      <td>2015-06-02 05:17:56.276</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>304</th>
      <td>1433193500981</td>
      <td>121688</td>
      <td>transaction</td>
      <td>15335</td>
      <td>11117.0</td>
      <td>2015-06-01 21:18:20.981</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>418</th>
      <td>1433193915008</td>
      <td>552148</td>
      <td>transaction</td>
      <td>81345</td>
      <td>5444.0</td>
      <td>2015-06-01 21:25:15.008</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>814</th>
      <td>1433176736375</td>
      <td>102019</td>
      <td>transaction</td>
      <td>150318</td>
      <td>13556.0</td>
      <td>2015-06-01 16:38:56.375</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>843</th>
      <td>1433174518180</td>
      <td>189384</td>
      <td>transaction</td>
      <td>310791</td>
      <td>7244.0</td>
      <td>2015-06-01 16:01:58.180</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2755082</th>
      <td>1438388436295</td>
      <td>1155978</td>
      <td>transaction</td>
      <td>430050</td>
      <td>4316.0</td>
      <td>2015-08-01 00:20:36.295</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>2755285</th>
      <td>1438380441389</td>
      <td>218648</td>
      <td>transaction</td>
      <td>446271</td>
      <td>10485.0</td>
      <td>2015-07-31 22:07:21.389</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>2755294</th>
      <td>1438377176570</td>
      <td>1050575</td>
      <td>transaction</td>
      <td>31640</td>
      <td>8354.0</td>
      <td>2015-07-31 21:12:56.570</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>2755508</th>
      <td>1438357730123</td>
      <td>855941</td>
      <td>transaction</td>
      <td>235771</td>
      <td>4385.0</td>
      <td>2015-07-31 15:48:50.123</td>
      <td>transaction</td>
    </tr>
    <tr>
      <th>2755607</th>
      <td>1438358989163</td>
      <td>1051054</td>
      <td>transaction</td>
      <td>312728</td>
      <td>17579.0</td>
      <td>2015-07-31 16:09:49.163</td>
      <td>transaction</td>
    </tr>
  </tbody>
</table>
<p>19939 rows Ã— 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">visitors</span> <span class="o">=</span> <span class="n">trans</span><span class="p">[</span><span class="s1">&#39;visitorid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">trans</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">trans2</span><span class="p">[</span><span class="s1">&#39;visitors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans2</span><span class="p">[</span><span class="s1">&#39;visitorid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">visitors</span> <span class="o">==</span> <span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">trans2</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trans2</span><span class="p">[</span><span class="s1">&#39;itemid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">items</span> <span class="o">==</span> <span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trans2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>timestamp</th>
      <th>visitorid</th>
      <th>event</th>
      <th>itemid</th>
      <th>transactionid</th>
      <th>date</th>
      <th>event_type</th>
      <th>visitors</th>
      <th>items</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>1433222276276</td>
      <td>599528</td>
      <td>transaction</td>
      <td>356475</td>
      <td>4000.0</td>
      <td>2015-06-02 05:17:56.276</td>
      <td>transaction</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>304</th>
      <td>1433193500981</td>
      <td>121688</td>
      <td>transaction</td>
      <td>15335</td>
      <td>11117.0</td>
      <td>2015-06-01 21:18:20.981</td>
      <td>transaction</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>418</th>
      <td>1433193915008</td>
      <td>552148</td>
      <td>transaction</td>
      <td>81345</td>
      <td>5444.0</td>
      <td>2015-06-01 21:25:15.008</td>
      <td>transaction</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>814</th>
      <td>1433176736375</td>
      <td>102019</td>
      <td>transaction</td>
      <td>150318</td>
      <td>13556.0</td>
      <td>2015-06-01 16:38:56.375</td>
      <td>transaction</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>843</th>
      <td>1433174518180</td>
      <td>189384</td>
      <td>transaction</td>
      <td>310791</td>
      <td>7244.0</td>
      <td>2015-06-01 16:01:58.180</td>
      <td>transaction</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create the user-item matrix</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>

<span class="n">occurences</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">((</span><span class="n">visitors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">items</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int8&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">set_occurences</span><span class="p">(</span><span class="n">visitor</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="n">occurences</span><span class="p">[</span><span class="n">visitor</span><span class="p">,</span> <span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">trans2</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">set_occurences</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;visitors&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">occurences</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/scipy/sparse/_index.py:84: SparseEfficiencyWarning: Changing the sparsity structure of a csr_matrix is expensive. lil_matrix is more efficient.
  self._set_intXint(row, col, x.flat[0])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;11719x12025 sparse matrix of type &#39;&lt;class &#39;numpy.int8&#39;&gt;&#39;
	with 18905 stored elements in Compressed Sparse Row format&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Co-occurrence is a better occurrence</p>
<p>Letâ€™s construct an item-item matrix where each element means how many times both items bought together by a user. Call it the co-occurrence matrix.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cooc</span> <span class="o">=</span> <span class="n">occurences</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">occurences</span><span class="p">)</span>
<span class="n">cooc</span><span class="o">.</span><span class="n">setdiag</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>  <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
  <span class="n">train</span><span class="p">,</span> <span class="n">valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Train:</span><span class="si">{}</span><span class="s1">, Valid:</span><span class="si">{}</span><span class="s1">, Test:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                                            <span class="n">valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                                            <span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://nbviewer.jupyter.org/github/tkokkeng/EB5202-RetailRocket/blob/master/retailrocket-features.ipynb">https://nbviewer.jupyter.org/github/tkokkeng/EB5202-RetailRocket/blob/master/retailrocket-features.ipynb</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="data:image/png;base64,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" alt="image.png" /></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Matrix-factorization-model">Matrix factorization model<a class="anchor-link" href="#Matrix-factorization-model"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_users</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">visitorid</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">n_items</span> <span class="o">=</span> <span class="n">events</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="c1"># set the number of latent factors</span>
<span class="n">n_latent_factors</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># import the required layers</span>
<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Flatten</span>

<span class="c1"># create input layer for items</span>
<span class="n">item_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Items&#39;</span><span class="p">)</span>

<span class="c1"># create embedding layer for items</span>
<span class="n">item_embed</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_items</span><span class="p">,</span>
                       <span class="n">n_latent_factors</span><span class="p">,</span>
                       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ItemsEmbedding&#39;</span><span class="p">)(</span><span class="n">item_input</span><span class="p">)</span>
<span class="n">item_vec</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ItemsFlatten&#39;</span><span class="p">)(</span><span class="n">item_embed</span><span class="p">)</span>

<span class="c1"># create the input and embedding layer for users also</span>
<span class="n">user_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Users&#39;</span><span class="p">)</span>
<span class="n">user_embed</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span>
                       <span class="n">n_latent_factors</span><span class="p">,</span> 
                       <span class="n">name</span><span class="o">=</span><span class="s1">&#39;UsersEmbedding&#39;</span><span class="p">)(</span><span class="n">user_input</span><span class="p">)</span>
<span class="n">user_vec</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;UsersFlatten&#39;</span><span class="p">)(</span><span class="n">user_embed</span><span class="p">)</span>

<span class="c1"># create a layer for the dot product of both vector space representations</span>
<span class="n">dot_prod</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="n">item_vec</span><span class="p">,</span> <span class="n">user_vec</span><span class="p">],</span><span class="n">axes</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;DotProduct&#39;</span><span class="p">)</span>

<span class="c1"># build and compile the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">item_input</span><span class="p">,</span> <span class="n">user_input</span><span class="p">],</span> <span class="n">dot_prod</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="s1">&#39;mse&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: &#34;model_5&#34;
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Items (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
Users (InputLayer)              [(None, 1)]          0                                            
__________________________________________________________________________________________________
ItemsEmbedding (Embedding)      (None, 1, 5)         1175305     Items[0][0]                      
__________________________________________________________________________________________________
UsersEmbedding (Embedding)      (None, 1, 5)         7037900     Users[0][0]                      
__________________________________________________________________________________________________
ItemsFlatten (Flatten)          (None, 5)            0           ItemsEmbedding[0][0]             
__________________________________________________________________________________________________
UsersFlatten (Flatten)          (None, 5)            0           UsersEmbedding[0][0]             
__________________________________________________________________________________________________
DotProduct (Dot)                (None, 1)            0           ItemsFlatten[0][0]               
                                                                 UsersFlatten[0][0]               
==================================================================================================
Total params: 8,213,205
Trainable params: 8,213,205
Non-trainable params: 0
__________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> 
                       <span class="n">to_file</span><span class="o">=</span><span class="s1">&#39;model.png&#39;</span><span class="p">,</span> 
                       <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                       <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">display</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;model.png&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train</span><span class="o">.</span><span class="n">visitorid</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">itemid</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">event</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">test</span><span class="o">.</span><span class="n">visitorid</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">itemid</span><span class="p">],</span> <span class="n">test</span><span class="o">.</span><span class="n">event</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean squared error:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Neural-net-model">Neural net model<a class="anchor-link" href="#Neural-net-model"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_lf_visitor</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_lf_item</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">item_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Items&#39;</span><span class="p">)</span>
<span class="n">item_embed</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                           <span class="n">n_lf_visitor</span><span class="p">,</span> 
                           <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ItemsEmbedding&#39;</span><span class="p">)(</span><span class="n">item_input</span><span class="p">)</span>
<span class="n">item_vec</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ItemsFlatten&#39;</span><span class="p">)(</span><span class="n">item_embed</span><span class="p">)</span>

<span class="n">visitor_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Visitors&#39;</span><span class="p">)</span>
<span class="n">visitor_embed</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_visitors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> 
                              <span class="n">n_lf_item</span><span class="p">,</span>
                              <span class="n">name</span><span class="o">=</span><span class="s1">&#39;VisitorsEmbedding&#39;</span><span class="p">)(</span><span class="n">visitor_input</span><span class="p">)</span>
<span class="n">visitor_vec</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;VisitorsFlatten&#39;</span><span class="p">)(</span><span class="n">visitor_embed</span><span class="p">)</span>

<span class="n">concat</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">item_vec</span><span class="p">,</span> <span class="n">visitor_vec</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Concat&#39;</span><span class="p">)</span>
<span class="n">fc_1</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FC-1&#39;</span><span class="p">)(</span><span class="n">concat</span><span class="p">)</span>
<span class="n">fc_2</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FC-2&#39;</span><span class="p">)(</span><span class="n">fc_1</span><span class="p">)</span>
<span class="n">fc_3</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;FC-3&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">fc_2</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Output&#39;</span><span class="p">)(</span><span class="n">fc_3</span><span class="p">)</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">([</span><span class="n">item_input</span><span class="p">,</span> <span class="n">visitor_input</span><span class="p">],</span> <span class="n">output</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span> <span class="s1">&#39;mse&#39;</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">train</span><span class="o">.</span><span class="n">visitorid</span><span class="p">,</span> <span class="n">train</span><span class="o">.</span><span class="n">itemid</span><span class="p">],</span> <span class="n">train</span><span class="o">.</span><span class="n">event</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">test</span><span class="o">.</span><span class="n">visitorid</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">itemid</span><span class="p">],</span> <span class="n">test</span><span class="o">.</span><span class="n">event</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mean squared error:&#39;</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_activity_count</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">events</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">visitorid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_activity_count</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">visitorid</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;view&#39;</span><span class="p">:</span><span class="mi">0</span> <span class="p">,</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">};</span>
    <span class="k">if</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;addtocart&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">visitorid</span><span class="p">][</span><span class="s1">&#39;addtocart&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;transaction&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">visitorid</span><span class="p">][</span><span class="s1">&#39;transaction&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">row</span><span class="o">.</span><span class="n">event</span> <span class="o">==</span> <span class="s1">&#39;view&#39;</span><span class="p">:</span>
        <span class="n">user_activity_count</span><span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">visitorid</span><span class="p">][</span><span class="s1">&#39;view&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span> 

<span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">user_activity_count</span><span class="p">)</span>
<span class="n">dataframe</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="c1"># Activity range</span>
<span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;activity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;addtocart&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;transaction&#39;</span><span class="p">]</span>

<span class="c1"># removing users with only a single view</span>
<span class="n">cleaned_data</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">dataframe</span><span class="p">[</span><span class="s1">&#39;activity&#39;</span><span class="p">]</span><span class="o">!=</span><span class="mi">1</span><span class="p">]</span>

<span class="n">cleaned_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>view</th>
      <th>addtocart</th>
      <th>transaction</th>
      <th>activity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>257597</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>992329</th>
      <td>30</td>
      <td>0</td>
      <td>0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>111016</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>483717</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>972639</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the data is very sparse, data cleaning is required to reduce the inherent noise. Steps performed</p>
<ul>
<li>Found activity per item basis. Activity is view / addtocart / transaction</li>
<li>Removed items with just a single view/activity (confirmed that, addtocard ones have both view+addtocart)</li>
<li>Removed users with no activity</li>
<li>Gave new itemId and userId to all users and items with some event attached and not removed in above steps.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr />

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/2022/01/16/retailrocket.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Jupyter notebook database.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/recohut" target="_blank" title="recohut"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
