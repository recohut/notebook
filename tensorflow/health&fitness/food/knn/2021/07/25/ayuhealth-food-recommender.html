<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>AyuHealth Healthy Food Recommendation | reconb</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="AyuHealth Healthy Food Recommendation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Healthy Food Recommendation System using Content Based (KNN) &amp; Collaborative Filtering (matrix-factorization) Method" />
<meta property="og:description" content="Healthy Food Recommendation System using Content Based (KNN) &amp; Collaborative Filtering (matrix-factorization) Method" />
<link rel="canonical" href="https://nb.recohut.com/tensorflow/health&fitness/food/knn/2021/07/25/ayuhealth-food-recommender.html" />
<meta property="og:url" content="https://nb.recohut.com/tensorflow/health&fitness/food/knn/2021/07/25/ayuhealth-food-recommender.html" />
<meta property="og:site_name" content="reconb" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-25T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AyuHealth Healthy Food Recommendation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-07-25T00:00:00-05:00","datePublished":"2021-07-25T00:00:00-05:00","description":"Healthy Food Recommendation System using Content Based (KNN) &amp; Collaborative Filtering (matrix-factorization) Method","headline":"AyuHealth Healthy Food Recommendation","mainEntityOfPage":{"@type":"WebPage","@id":"https://nb.recohut.com/tensorflow/health&fitness/food/knn/2021/07/25/ayuhealth-food-recommender.html"},"url":"https://nb.recohut.com/tensorflow/health&fitness/food/knn/2021/07/25/ayuhealth-food-recommender.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nb.recohut.com/feed.xml" title="reconb" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">reconb</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">AyuHealth Healthy Food Recommendation</h1><p class="page-description">Healthy Food Recommendation System using Content Based (KNN) & Collaborative Filtering (matrix-factorization) Method</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-25T00:00:00-05:00" itemprop="datePublished">
        Jul 25, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      23 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Tensorflow">Tensorflow</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Health&Fitness">Health&Fitness</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Food">Food</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#KNN">KNN</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/recohut/notebook/tree/master/_notebooks/2021-07-25-ayuhealth-food-recommender.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/recohut/notebook/master?filepath=_notebooks%2F2021-07-25-ayuhealth-food-recommender.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/recohut/notebook/blob/master/_notebooks/2021-07-25-ayuhealth-food-recommender.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frecohut%2Fnotebook%2Fblob%2Fmaster%2F_notebooks%2F2021-07-25-ayuhealth-food-recommender.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Setup">Setup </a></li>
<li class="toc-entry toc-h2"><a href="#KNN-model">KNN model </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Feature-selection">Feature selection </a></li>
<li class="toc-entry toc-h3"><a href="#Scaling">Scaling </a></li>
<li class="toc-entry toc-h3"><a href="#Model-fitting">Model fitting </a></li>
<li class="toc-entry toc-h3"><a href="#Testing">Testing </a></li>
<li class="toc-entry toc-h3"><a href="#Save-and-load-the-model">Save and load the model </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Collaborative-filtering-model">Collaborative-filtering model </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Encode-user_id-and-food_code">Encode user_id and food_code </a></li>
<li class="toc-entry toc-h3"><a href="#Build-Tensorflow-Recommendation-model">Build Tensorflow Recommendation model </a></li>
<li class="toc-entry toc-h3"><a href="#Model-structure">Model structure </a></li>
<li class="toc-entry toc-h3"><a href="#Train/validation-split">Train/validation split </a></li>
<li class="toc-entry toc-h3"><a href="#Setting-the-callback">Setting the callback </a></li>
<li class="toc-entry toc-h3"><a href="#Model-training">Model training </a></li>
<li class="toc-entry toc-h3"><a href="#Plot-results">Plot results </a></li>
<li class="toc-entry toc-h3"><a href="#Recommendation-function">Recommendation function </a></li>
<li class="toc-entry toc-h3"><a href="#Recommending-for-a-single-user">Recommending for a single user </a></li>
<li class="toc-entry toc-h3"><a href="#Recommending-for-all-users">Recommending for all users </a></li>
<li class="toc-entry toc-h3"><a href="#Save-predicted-data-to-csv-file">Save predicted data to csv file </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-25-ayuhealth-food-recommender.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">
<a class="anchor" href="#Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup<a class="anchor-link" href="#Setup"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">sparsh</span><span class="o">-</span><span class="n">ai</span><span class="o">/</span><span class="n">reco</span><span class="o">-</span><span class="n">data</span><span class="o">/</span><span class="n">raw</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">ayuhealth</span><span class="o">/</span><span class="n">ayuhealth</span><span class="o">.</span><span class="n">zip</span>
<span class="err">!</span><span class="n">unzip</span> <span class="n">ayuhealth</span><span class="o">.</span><span class="n">zip</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">Reshape</span><span class="p">,</span> <span class="n">Dot</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">concatenate</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.callbacks</span> <span class="kn">import</span> <span class="n">ModelCheckpoint</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">model_to_dot</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">load_model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">q</span> <span class="n">watermark</span>
<span class="o">%</span><span class="n">reload_ext</span> <span class="n">watermark</span>
<span class="o">%</span><span class="n">watermark</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">iv</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Compiler    : GCC 7.5.0
OS          : Linux
Release     : 5.4.104+
Machine     : x86_64
Processor   : x86_64
CPU cores   : 2
Architecture: 64bit

numpy     : 1.19.5
matplotlib: 3.2.2
IPython   : 5.5.0
pandas    : 1.1.5
tensorflow: 2.5.0
sklearn   : 0.0

</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">RATED_FOOD_PATH</span> <span class="o">=</span> <span class="s1">'food.csv'</span>
<span class="n">RATED_FOOD_PATH</span> <span class="o">=</span> <span class="s1">'rated_food.csv'</span>
<span class="n">RATING_PATH</span> <span class="o">=</span> <span class="s1">'ratings.csv'</span>
<span class="n">USER_PATH</span> <span class="o">=</span> <span class="s1">'users.csv'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="KNN-model">
<a class="anchor" href="#KNN-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>KNN model<a class="anchor-link" href="#KNN-model"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">RATED_FOOD_PATH</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food_id</th>
      <th>food_code</th>
      <th>name</th>
      <th>category</th>
      <th>type</th>
      <th>calories</th>
      <th>protein</th>
      <th>carbs</th>
      <th>fat</th>
      <th>fiber</th>
      <th>sugar</th>
      <th>vitamin_a</th>
      <th>vitamin_b6</th>
      <th>vitamin_b12</th>
      <th>vitamin_c</th>
      <th>vitamin_d</th>
      <th>vitamin_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>11432000</td>
      <td>Yogurt, low fat milk, fruit</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>89.0</td>
      <td>4.66</td>
      <td>14.46</td>
      <td>1.37</td>
      <td>0.1</td>
      <td>12.01</td>
      <td>12.0</td>
      <td>0.046</td>
      <td>0.49</td>
      <td>1.8</td>
      <td>1.2</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>11435100</td>
      <td>Yogurt, Greek, with oats</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>160.0</td>
      <td>8.90</td>
      <td>22.38</td>
      <td>4.29</td>
      <td>1.9</td>
      <td>12.07</td>
      <td>88.0</td>
      <td>0.077</td>
      <td>0.53</td>
      <td>0.1</td>
      <td>0.7</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15</td>
      <td>11446000</td>
      <td>Yogurt parfait, low fat, with fruit</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>84.0</td>
      <td>3.36</td>
      <td>15.86</td>
      <td>1.01</td>
      <td>1.1</td>
      <td>11.68</td>
      <td>30.0</td>
      <td>0.233</td>
      <td>0.88</td>
      <td>14.3</td>
      <td>1.2</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>14710200</td>
      <td>Beer cheese soup, made with milk</td>
      <td>Soups</td>
      <td>Food</td>
      <td>192.0</td>
      <td>6.19</td>
      <td>6.52</td>
      <td>15.43</td>
      <td>0.3</td>
      <td>0.80</td>
      <td>182.0</td>
      <td>0.037</td>
      <td>0.26</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23</td>
      <td>26109133</td>
      <td>Cod, coated, baked or broiled, no added fat</td>
      <td>Fish</td>
      <td>Food</td>
      <td>137.0</td>
      <td>17.32</td>
      <td>13.10</td>
      <td>1.16</td>
      <td>0.6</td>
      <td>1.15</td>
      <td>9.0</td>
      <td>0.121</td>
      <td>1.81</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>0.54</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-selection">
<a class="anchor" href="#Feature-selection" aria-hidden="true"><span class="octicon octicon-link"></span></a>Feature selection<a class="anchor-link" href="#Feature-selection"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">knn_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">knn_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'food_id'</span><span class="p">,</span><span class="s1">'food_code'</span><span class="p">,</span><span class="s1">'name'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">,</span><span class="s1">'type'</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">knn_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>calories</th>
      <th>protein</th>
      <th>carbs</th>
      <th>fat</th>
      <th>fiber</th>
      <th>sugar</th>
      <th>vitamin_a</th>
      <th>vitamin_b6</th>
      <th>vitamin_b12</th>
      <th>vitamin_c</th>
      <th>vitamin_d</th>
      <th>vitamin_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>89.0</td>
      <td>4.66</td>
      <td>14.46</td>
      <td>1.37</td>
      <td>0.1</td>
      <td>12.01</td>
      <td>12.0</td>
      <td>0.046</td>
      <td>0.49</td>
      <td>1.8</td>
      <td>1.2</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>160.0</td>
      <td>8.90</td>
      <td>22.38</td>
      <td>4.29</td>
      <td>1.9</td>
      <td>12.07</td>
      <td>88.0</td>
      <td>0.077</td>
      <td>0.53</td>
      <td>0.1</td>
      <td>0.7</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>84.0</td>
      <td>3.36</td>
      <td>15.86</td>
      <td>1.01</td>
      <td>1.1</td>
      <td>11.68</td>
      <td>30.0</td>
      <td>0.233</td>
      <td>0.88</td>
      <td>14.3</td>
      <td>1.2</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>192.0</td>
      <td>6.19</td>
      <td>6.52</td>
      <td>15.43</td>
      <td>0.3</td>
      <td>0.80</td>
      <td>182.0</td>
      <td>0.037</td>
      <td>0.26</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>137.0</td>
      <td>17.32</td>
      <td>13.10</td>
      <td>1.16</td>
      <td>0.6</td>
      <td>1.15</td>
      <td>9.0</td>
      <td>0.121</td>
      <td>1.81</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>0.54</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scaling">
<a class="anchor" href="#Scaling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Scaling<a class="anchor-link" href="#Scaling"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">min_max_scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">knn_df</span> <span class="o">=</span> <span class="n">min_max_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">knn_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-fitting">
<a class="anchor" href="#Model-fitting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model fitting<a class="anchor-link" href="#Model-fitting"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nbrs</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">'ball_tree'</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">knn_df</span><span class="p">)</span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">knn_df</span><span class="p">)</span>
<span class="n">all_code</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Testing">
<a class="anchor" href="#Testing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Testing<a class="anchor-link" href="#Testing"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">random_food_code</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">food_code</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">random_food_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">food_code</span><span class="o">==</span><span class="n">random_food_code</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">'name'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># find 10 similar items</span>
<span class="n">searched_food_code</span> <span class="o">=</span> <span class="n">all_code</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">random_food_code</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">similar_foods</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">searched_food_code</span><span class="p">]]</span>

<span class="c1"># print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"FnB that related to : "</span><span class="p">,</span> <span class="n">random_food_name</span><span class="p">)</span>
<span class="n">similar_foods</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>FnB that related to :  Wrap sandwich, filled with vegetables
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food_id</th>
      <th>food_code</th>
      <th>name</th>
      <th>category</th>
      <th>type</th>
      <th>calories</th>
      <th>protein</th>
      <th>carbs</th>
      <th>fat</th>
      <th>fiber</th>
      <th>sugar</th>
      <th>vitamin_a</th>
      <th>vitamin_b6</th>
      <th>vitamin_b12</th>
      <th>vitamin_c</th>
      <th>vitamin_d</th>
      <th>vitamin_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>70</th>
      <td>237</td>
      <td>58200250</td>
      <td>Wrap sandwich, filled with vegetables</td>
      <td>Sandwiches</td>
      <td>Food</td>
      <td>123.0</td>
      <td>3.20</td>
      <td>13.96</td>
      <td>6.35</td>
      <td>1.7</td>
      <td>3.05</td>
      <td>132.0</td>
      <td>0.098</td>
      <td>0.03</td>
      <td>16.6</td>
      <td>0.0</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>79</th>
      <td>271</td>
      <td>72202020</td>
      <td>Broccoli casserole with rice</td>
      <td>Vegetable dishes</td>
      <td>Food</td>
      <td>106.0</td>
      <td>4.13</td>
      <td>15.09</td>
      <td>3.50</td>
      <td>1.9</td>
      <td>1.22</td>
      <td>49.0</td>
      <td>0.101</td>
      <td>0.05</td>
      <td>19.8</td>
      <td>0.2</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>73</th>
      <td>263</td>
      <td>71704000</td>
      <td>Stewed potatoes with tomatoes</td>
      <td>Potatoes</td>
      <td>Food</td>
      <td>94.0</td>
      <td>1.61</td>
      <td>15.40</td>
      <td>3.17</td>
      <td>1.4</td>
      <td>2.31</td>
      <td>13.0</td>
      <td>0.221</td>
      <td>0.00</td>
      <td>12.7</td>
      <td>0.0</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>86</th>
      <td>286</td>
      <td>75418020</td>
      <td>Squash, summer, casserole with tomato and cheese</td>
      <td>Vegetable dishes</td>
      <td>Food</td>
      <td>84.0</td>
      <td>3.46</td>
      <td>8.91</td>
      <td>4.19</td>
      <td>1.4</td>
      <td>3.35</td>
      <td>44.0</td>
      <td>0.125</td>
      <td>0.08</td>
      <td>13.8</td>
      <td>0.2</td>
      <td>0.44</td>
    </tr>
    <tr>
      <th>72</th>
      <td>251</td>
      <td>71601040</td>
      <td>Potato salad with egg, made with Italian dressing</td>
      <td>Potatoes</td>
      <td>Food</td>
      <td>113.0</td>
      <td>2.81</td>
      <td>15.80</td>
      <td>4.42</td>
      <td>1.3</td>
      <td>2.41</td>
      <td>19.0</td>
      <td>0.212</td>
      <td>0.14</td>
      <td>5.3</td>
      <td>0.3</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>90</th>
      <td>293</td>
      <td>75440610</td>
      <td>Vegetable curry with rice</td>
      <td>Vegetable dishes</td>
      <td>Food</td>
      <td>102.0</td>
      <td>2.02</td>
      <td>16.43</td>
      <td>3.25</td>
      <td>1.3</td>
      <td>1.96</td>
      <td>39.0</td>
      <td>0.118</td>
      <td>0.01</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>24</th>
      <td>117</td>
      <td>27415140</td>
      <td>Hunan beef</td>
      <td>Stir-fry and soy-based sauce mixtures</td>
      <td>Food</td>
      <td>105.0</td>
      <td>7.08</td>
      <td>7.29</td>
      <td>5.30</td>
      <td>1.5</td>
      <td>2.41</td>
      <td>63.0</td>
      <td>0.161</td>
      <td>0.48</td>
      <td>11.6</td>
      <td>0.1</td>
      <td>0.82</td>
    </tr>
    <tr>
      <th>16</th>
      <td>95</td>
      <td>27213010</td>
      <td>Biryani with meat</td>
      <td>Rice mixed dishes</td>
      <td>Food</td>
      <td>145.0</td>
      <td>8.50</td>
      <td>12.20</td>
      <td>6.77</td>
      <td>1.0</td>
      <td>1.69</td>
      <td>16.0</td>
      <td>0.136</td>
      <td>0.47</td>
      <td>5.6</td>
      <td>0.1</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>87</th>
      <td>287</td>
      <td>75418030</td>
      <td>Squash, summer, casserole, with rice and tomat...</td>
      <td>Vegetable dishes</td>
      <td>Food</td>
      <td>83.0</td>
      <td>2.32</td>
      <td>14.90</td>
      <td>1.65</td>
      <td>1.1</td>
      <td>2.39</td>
      <td>17.0</td>
      <td>0.118</td>
      <td>0.02</td>
      <td>10.4</td>
      <td>0.0</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>65</th>
      <td>214</td>
      <td>58160000</td>
      <td>Biryani with vegetables</td>
      <td>Rice mixed dishes</td>
      <td>Food</td>
      <td>108.0</td>
      <td>1.93</td>
      <td>17.88</td>
      <td>3.16</td>
      <td>1.2</td>
      <td>1.16</td>
      <td>61.0</td>
      <td>0.071</td>
      <td>0.01</td>
      <td>4.1</td>
      <td>0.0</td>
      <td>0.20</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save-and-load-the-model">
<a class="anchor" href="#Save-and-load-the-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Save and load the model<a class="anchor-link" href="#Save-and-load-the-model"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
 
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">nbrs</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'content_based_knn_model.pkl'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">))</span>
 
<span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">'content_based_knn_model.pkl'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">))</span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">knn_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Collaborative-filtering-model">
<a class="anchor" href="#Collaborative-filtering-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Collaborative-filtering model<a class="anchor-link" href="#Collaborative-filtering-model"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>1. Read Exported CSV From DB</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">food_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">RATED_FOOD_PATH</span><span class="p">)</span>
<span class="n">food_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food_id</th>
      <th>food_code</th>
      <th>name</th>
      <th>category</th>
      <th>type</th>
      <th>calories</th>
      <th>protein</th>
      <th>carbs</th>
      <th>fat</th>
      <th>fiber</th>
      <th>sugar</th>
      <th>vitamin_a</th>
      <th>vitamin_b6</th>
      <th>vitamin_b12</th>
      <th>vitamin_c</th>
      <th>vitamin_d</th>
      <th>vitamin_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>11432000</td>
      <td>Yogurt, low fat milk, fruit</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>89.0</td>
      <td>4.66</td>
      <td>14.46</td>
      <td>1.37</td>
      <td>0.1</td>
      <td>12.01</td>
      <td>12.0</td>
      <td>0.046</td>
      <td>0.49</td>
      <td>1.8</td>
      <td>1.2</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13</td>
      <td>11435100</td>
      <td>Yogurt, Greek, with oats</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>160.0</td>
      <td>8.90</td>
      <td>22.38</td>
      <td>4.29</td>
      <td>1.9</td>
      <td>12.07</td>
      <td>88.0</td>
      <td>0.077</td>
      <td>0.53</td>
      <td>0.1</td>
      <td>0.7</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>15</td>
      <td>11446000</td>
      <td>Yogurt parfait, low fat, with fruit</td>
      <td>Yogurt</td>
      <td>Food</td>
      <td>84.0</td>
      <td>3.36</td>
      <td>15.86</td>
      <td>1.01</td>
      <td>1.1</td>
      <td>11.68</td>
      <td>30.0</td>
      <td>0.233</td>
      <td>0.88</td>
      <td>14.3</td>
      <td>1.2</td>
      <td>0.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16</td>
      <td>14710200</td>
      <td>Beer cheese soup, made with milk</td>
      <td>Soups</td>
      <td>Food</td>
      <td>192.0</td>
      <td>6.19</td>
      <td>6.52</td>
      <td>15.43</td>
      <td>0.3</td>
      <td>0.80</td>
      <td>182.0</td>
      <td>0.037</td>
      <td>0.26</td>
      <td>0.3</td>
      <td>0.3</td>
      <td>0.45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23</td>
      <td>26109133</td>
      <td>Cod, coated, baked or broiled, no added fat</td>
      <td>Fish</td>
      <td>Food</td>
      <td>137.0</td>
      <td>17.32</td>
      <td>13.10</td>
      <td>1.16</td>
      <td>0.6</td>
      <td>1.15</td>
      <td>9.0</td>
      <td>0.121</td>
      <td>1.81</td>
      <td>0.0</td>
      <td>0.6</td>
      <td>0.54</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">rating</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">RATING_PATH</span><span class="p">)</span>
<span class="n">rating</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating_id</th>
      <th>user_id</th>
      <th>food_id</th>
      <th>food_code</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>1</td>
      <td>120</td>
      <td>27445220</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>1</td>
      <td>176</td>
      <td>32105210</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>1</td>
      <td>184</td>
      <td>41311030</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>1</td>
      <td>193</td>
      <td>42401100</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>4</td>
      <td>365</td>
      <td>42403010</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">user_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">USER_PATH</span><span class="p">)</span>
<span class="n">user_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>name</th>
      <th>username</th>
      <th>email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Gugun Andriawan</td>
      <td>username0</td>
      <td>username0@ayohealthy.id</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>Mikey</td>
      <td>username4</td>
      <td>username4@ayohealthy.id</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>BrutusSmith</td>
      <td>username5</td>
      <td>username5@ayohealthy.id</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>Guts</td>
      <td>username6</td>
      <td>username6@ayohealthy.id</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
      <td>Imam Septian</td>
      <td>username9</td>
      <td>username9@ayohealthy.id</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">rating</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">rating</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>rating_id    0
user_id      0
food_id      0
food_code    0
rating       0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Encode-user_id-and-food_code">
<a class="anchor" href="#Encode-user_id-and-food_code" aria-hidden="true"><span class="octicon octicon-link"></span></a>Encode user_id and food_code<a class="anchor-link" href="#Encode-user_id-and-food_code"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">user_enc</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">rating</span><span class="p">[</span><span class="s1">'User_ID'</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">])</span>

<span class="n">food_enc</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">rating</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]</span> <span class="o">=</span> <span class="n">food_enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">])</span>
<span class="n">rating</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating_id</th>
      <th>user_id</th>
      <th>food_id</th>
      <th>food_code</th>
      <th>rating</th>
      <th>User_ID</th>
      <th>Food_ID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>1</td>
      <td>120</td>
      <td>27445220</td>
      <td>2</td>
      <td>0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>1</td>
      <td>176</td>
      <td>32105210</td>
      <td>2</td>
      <td>0</td>
      <td>59</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>1</td>
      <td>184</td>
      <td>41311030</td>
      <td>3</td>
      <td>0</td>
      <td>65</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>1</td>
      <td>193</td>
      <td>42401100</td>
      <td>2</td>
      <td>0</td>
      <td>69</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>4</td>
      <td>365</td>
      <td>42403010</td>
      <td>4</td>
      <td>1</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">userid_nunique</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="s1">'User_ID'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">food_unique</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'User_id total unique:'</span><span class="p">,</span> <span class="n">userid_nunique</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Food_id total unique:'</span><span class="p">,</span> <span class="n">food_unique</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>User_id total unique: 138
Food_id total unique: 140
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Build-Tensorflow-Recommendation-model">
<a class="anchor" href="#Build-Tensorflow-Recommendation-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build Tensorflow Recommendation model<a class="anchor-link" href="#Build-Tensorflow-Recommendation-model"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">RecommenderV2</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_food</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">):</span>
    
    <span class="c1"># User Embedding</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">)(</span><span class="n">user</span><span class="p">)</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">U</span><span class="p">)</span>
    
    <span class="c1"># Food Rating Embedding</span>
    <span class="n">food</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">n_food</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">)(</span><span class="n">food</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">M</span><span class="p">)</span>
    

    <span class="n">merged_vector</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">U</span><span class="p">,</span> <span class="n">M</span><span class="p">])</span>
    <span class="n">dense_1</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)(</span><span class="n">merged_vector</span><span class="p">)</span>
    <span class="n">dense_2</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)(</span><span class="n">dense_1</span><span class="p">)</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">dense_2</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">user</span><span class="p">,</span> <span class="n">food</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="n">final</span><span class="p">)</span>
    
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">Adam</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mean_squared_error'</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-structure">
<a class="anchor" href="#Model-structure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model structure<a class="anchor-link" href="#Model-structure"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RecommenderV2</span><span class="p">(</span><span class="n">userid_nunique</span><span class="p">,</span> <span class="n">food_unique</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">SVG</span><span class="p">(</span><span class="n">model_to_dot</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_layer_names</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s1">'dot'</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">'svg'</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<svg height="737pt" viewbox="0.00 0.00 659.50 553.00" width="879pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1.3333 1.3333) rotate(0) translate(4 549)">
<title>G</title>
<polygon fill="#ffffff" points="-4,4 -4,-549 655.5,-549 655.5,4 -4,4" stroke="transparent"></polygon>
<!-- 140718024234832 -->
<g class="node" id="node1">
<title>140718024234832</title>
<polygon fill="none" points="18.5,-498.5 18.5,-544.5 290.5,-544.5 290.5,-498.5 18.5,-498.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="85" y="-517.8">input_1: InputLayer</text>
<polyline fill="none" points="151.5,-498.5 151.5,-544.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="180.5" y="-529.3">input:</text>
<polyline fill="none" points="151.5,-521.5 209.5,-521.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="180.5" y="-506.3">output:</text>
<polyline fill="none" points="209.5,-498.5 209.5,-544.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="250" y="-529.3">[(None, 1)]</text>
<polyline fill="none" points="209.5,-521.5 290.5,-521.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="250" y="-506.3">[(None, 1)]</text>
</g>
<!-- 140718020480656 -->
<g class="node" id="node3">
<title>140718020480656</title>
<polygon fill="none" points="0,-415.5 0,-461.5 309,-461.5 309,-415.5 0,-415.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="78" y="-434.8">embedding: Embedding</text>
<polyline fill="none" points="156,-415.5 156,-461.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="185" y="-446.3">input:</text>
<polyline fill="none" points="156,-438.5 214,-438.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="185" y="-423.3">output:</text>
<polyline fill="none" points="214,-415.5 214,-461.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="261.5" y="-446.3">(None, 1)</text>
<polyline fill="none" points="214,-438.5 309,-438.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="261.5" y="-423.3">(None, 1, 32)</text>
</g>
<!-- 140718024234832&#45;&gt;140718020480656 -->
<g class="edge" id="edge1">
<title>140718024234832-&gt;140718020480656</title>
<path d="M154.5,-498.3799C154.5,-490.1745 154.5,-480.7679 154.5,-471.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="158.0001,-471.784 154.5,-461.784 151.0001,-471.784 158.0001,-471.784" stroke="#000000"></polygon>
</g>
<!-- 140718020535504 -->
<g class="node" id="node2">
<title>140718020535504</title>
<polygon fill="none" points="353.5,-498.5 353.5,-544.5 625.5,-544.5 625.5,-498.5 353.5,-498.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="420" y="-517.8">input_2: InputLayer</text>
<polyline fill="none" points="486.5,-498.5 486.5,-544.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="515.5" y="-529.3">input:</text>
<polyline fill="none" points="486.5,-521.5 544.5,-521.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="515.5" y="-506.3">output:</text>
<polyline fill="none" points="544.5,-498.5 544.5,-544.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="585" y="-529.3">[(None, 1)]</text>
<polyline fill="none" points="544.5,-521.5 625.5,-521.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="585" y="-506.3">[(None, 1)]</text>
</g>
<!-- 140718020333904 -->
<g class="node" id="node4">
<title>140718020333904</title>
<polygon fill="none" points="327.5,-415.5 327.5,-461.5 651.5,-461.5 651.5,-415.5 327.5,-415.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="413" y="-434.8">embedding_1: Embedding</text>
<polyline fill="none" points="498.5,-415.5 498.5,-461.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="527.5" y="-446.3">input:</text>
<polyline fill="none" points="498.5,-438.5 556.5,-438.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="527.5" y="-423.3">output:</text>
<polyline fill="none" points="556.5,-415.5 556.5,-461.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="604" y="-446.3">(None, 1)</text>
<polyline fill="none" points="556.5,-438.5 651.5,-438.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="604" y="-423.3">(None, 1, 32)</text>
</g>
<!-- 140718020535504&#45;&gt;140718020333904 -->
<g class="edge" id="edge2">
<title>140718020535504-&gt;140718020333904</title>
<path d="M489.5,-498.3799C489.5,-490.1745 489.5,-480.7679 489.5,-471.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="493.0001,-471.784 489.5,-461.784 486.0001,-471.784 493.0001,-471.784" stroke="#000000"></polygon>
</g>
<!-- 140718020479504 -->
<g class="node" id="node5">
<title>140718020479504</title>
<polygon fill="none" points="58,-332.5 58,-378.5 309,-378.5 309,-332.5 58,-332.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="107" y="-351.8">flatten: Flatten</text>
<polyline fill="none" points="156,-332.5 156,-378.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="185" y="-363.3">input:</text>
<polyline fill="none" points="156,-355.5 214,-355.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="185" y="-340.3">output:</text>
<polyline fill="none" points="214,-332.5 214,-378.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="261.5" y="-363.3">(None, 1, 32)</text>
<polyline fill="none" points="214,-355.5 309,-355.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="261.5" y="-340.3">(None, 32)</text>
</g>
<!-- 140718020480656&#45;&gt;140718020479504 -->
<g class="edge" id="edge3">
<title>140718020480656-&gt;140718020479504</title>
<path d="M162.5781,-415.3799C165.5074,-406.9962 168.8748,-397.3584 172.0399,-388.2996" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="175.3702,-389.3788 175.3646,-378.784 168.762,-387.0699 175.3702,-389.3788" stroke="#000000"></polygon>
</g>
<!-- 140718023685456 -->
<g class="node" id="node6">
<title>140718023685456</title>
<polygon fill="none" points="341.5,-332.5 341.5,-378.5 607.5,-378.5 607.5,-332.5 341.5,-332.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="398" y="-351.8">flatten_1: Flatten</text>
<polyline fill="none" points="454.5,-332.5 454.5,-378.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="483.5" y="-363.3">input:</text>
<polyline fill="none" points="454.5,-355.5 512.5,-355.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="483.5" y="-340.3">output:</text>
<polyline fill="none" points="512.5,-332.5 512.5,-378.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="560" y="-363.3">(None, 1, 32)</text>
<polyline fill="none" points="512.5,-355.5 607.5,-355.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="560" y="-340.3">(None, 32)</text>
</g>
<!-- 140718020333904&#45;&gt;140718023685456 -->
<g class="edge" id="edge4">
<title>140718020333904-&gt;140718023685456</title>
<path d="M485.3217,-415.3799C483.8388,-407.1745 482.1388,-397.7679 480.5323,-388.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="483.9307,-388.0021 478.708,-378.784 477.0422,-389.2471 483.9307,-388.0021" stroke="#000000"></polygon>
</g>
<!-- 140718023107472 -->
<g class="node" id="node7">
<title>140718023107472</title>
<polygon fill="none" points="133,-249.5 133,-295.5 510,-295.5 510,-249.5 133,-249.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="213" y="-268.8">concatenate: Concatenate</text>
<polyline fill="none" points="293,-249.5 293,-295.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="322" y="-280.3">input:</text>
<polyline fill="none" points="293,-272.5 351,-272.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="322" y="-257.3">output:</text>
<polyline fill="none" points="351,-249.5 351,-295.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="430.5" y="-280.3">[(None, 32), (None, 32)]</text>
<polyline fill="none" points="351,-272.5 510,-272.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="430.5" y="-257.3">(None, 64)</text>
</g>
<!-- 140718020479504&#45;&gt;140718023107472 -->
<g class="edge" id="edge5">
<title>140718020479504-&gt;140718023107472</title>
<path d="M221.9407,-332.3799C238.1042,-322.6583 257.0714,-311.2505 274.09,-301.0147" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="276.0213,-303.9375 282.7868,-295.784 272.4134,-297.9388 276.0213,-303.9375" stroke="#000000"></polygon>
</g>
<!-- 140718023685456&#45;&gt;140718023107472 -->
<g class="edge" id="edge6">
<title>140718023685456-&gt;140718023107472</title>
<path d="M431.881,-332.3799C413.6376,-322.4832 392.1727,-310.8388 373.0453,-300.4625" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="374.6144,-297.3319 364.1556,-295.6399 371.2765,-303.4849 374.6144,-297.3319" stroke="#000000"></polygon>
</g>
<!-- 140718020552336 -->
<g class="node" id="node8">
<title>140718020552336</title>
<polygon fill="none" points="203,-166.5 203,-212.5 440,-212.5 440,-166.5 203,-166.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249" y="-185.8">dense: Dense</text>
<polyline fill="none" points="295,-166.5 295,-212.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="324" y="-197.3">input:</text>
<polyline fill="none" points="295,-189.5 353,-189.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="324" y="-174.3">output:</text>
<polyline fill="none" points="353,-166.5 353,-212.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="396.5" y="-197.3">(None, 64)</text>
<polyline fill="none" points="353,-189.5 440,-189.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="396.5" y="-174.3">(None, 128)</text>
</g>
<!-- 140718023107472&#45;&gt;140718020552336 -->
<g class="edge" id="edge7">
<title>140718023107472-&gt;140718020552336</title>
<path d="M321.5,-249.3799C321.5,-241.1745 321.5,-231.7679 321.5,-222.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="325.0001,-222.784 321.5,-212.784 318.0001,-222.784 325.0001,-222.784" stroke="#000000"></polygon>
</g>
<!-- 140718003262544 -->
<g class="node" id="node9">
<title>140718003262544</title>
<polygon fill="none" points="195.5,-83.5 195.5,-129.5 447.5,-129.5 447.5,-83.5 195.5,-83.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="249" y="-102.8">dense_1: Dense</text>
<polyline fill="none" points="302.5,-83.5 302.5,-129.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="331.5" y="-114.3">input:</text>
<polyline fill="none" points="302.5,-106.5 360.5,-106.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="331.5" y="-91.3">output:</text>
<polyline fill="none" points="360.5,-83.5 360.5,-129.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="404" y="-114.3">(None, 128)</text>
<polyline fill="none" points="360.5,-106.5 447.5,-106.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="404" y="-91.3">(None, 64)</text>
</g>
<!-- 140718020552336&#45;&gt;140718003262544 -->
<g class="edge" id="edge8">
<title>140718020552336-&gt;140718003262544</title>
<path d="M321.5,-166.3799C321.5,-158.1745 321.5,-148.7679 321.5,-139.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="325.0001,-139.784 321.5,-129.784 318.0001,-139.784 325.0001,-139.784" stroke="#000000"></polygon>
</g>
<!-- 140718020456336 -->
<g class="node" id="node10">
<title>140718020456336</title>
<polygon fill="none" points="199,-.5 199,-46.5 444,-46.5 444,-.5 199,-.5" stroke="#000000"></polygon>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="252.5" y="-19.8">dense_2: Dense</text>
<polyline fill="none" points="306,-.5 306,-46.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="335" y="-31.3">input:</text>
<polyline fill="none" points="306,-23.5 364,-23.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="335" y="-8.3">output:</text>
<polyline fill="none" points="364,-.5 364,-46.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="404" y="-31.3">(None, 64)</text>
<polyline fill="none" points="364,-23.5 444,-23.5 " stroke="#000000"></polyline>
<text fill="#000000" font-family="Times,serif" font-size="14.00" text-anchor="middle" x="404" y="-8.3">(None, 1)</text>
</g>
<!-- 140718003262544&#45;&gt;140718020456336 -->
<g class="edge" id="edge9">
<title>140718003262544-&gt;140718020456336</title>
<path d="M321.5,-83.3799C321.5,-75.1745 321.5,-65.7679 321.5,-56.8786" fill="none" stroke="#000000"></path>
<polygon fill="#000000" points="325.0001,-56.784 321.5,-46.784 318.0001,-56.784 325.0001,-56.784" stroke="#000000"></polygon>
</g>
</g>
</svg>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            [(None, 1)]          0                                            
__________________________________________________________________________________________________
embedding (Embedding)           (None, 1, 32)        4416        input_1[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 1, 32)        4480        input_2[0][0]                    
__________________________________________________________________________________________________
flatten (Flatten)               (None, 32)           0           embedding[0][0]                  
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 32)           0           embedding_1[0][0]                
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 64)           0           flatten[0][0]                    
                                                                 flatten_1[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 128)          8320        concatenate[0][0]                
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           8256        dense[0][0]                      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            65          dense_1[0][0]                    
==================================================================================================
Total params: 25,537
Trainable params: 25,537
Non-trainable params: 0
__________________________________________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Train/validation-split">
<a class="anchor" href="#Train/validation-split" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train/validation split<a class="anchor-link" href="#Train/validation-split"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">rating</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'rating'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="s1">'rating'</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                  <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
                                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">87</span><span class="p">)</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_val</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((568, 6), (143, 6), (568,), (143,))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Setting-the-callback">
<a class="anchor" href="#Setting-the-callback" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting the callback<a class="anchor-link" href="#Setting-the-callback"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="s1">'model1.h5'</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">'val_loss'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">val_loss_cb</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">'val_loss'</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Model-training">
<a class="anchor" href="#Model-training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model training<a class="anchor-link" href="#Model-training"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">X_train</span><span class="p">[</span><span class="s1">'User_ID'</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="p">([</span><span class="n">X_val</span><span class="p">[</span><span class="s1">'User_ID'</span><span class="p">],</span> <span class="n">X_val</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]],</span> <span class="n">y_val</span><span class="p">),</span>
                    <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">val_loss_cb</span><span class="p">,</span><span class="n">checkpoint</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/100
9/9 [==============================] - 1s 25ms/step - loss: 11.7716 - val_loss: 11.2475
Epoch 2/100
9/9 [==============================] - 0s 5ms/step - loss: 10.5831 - val_loss: 9.7883
Epoch 3/100
9/9 [==============================] - 0s 6ms/step - loss: 8.6676 - val_loss: 7.2983
Epoch 4/100
9/9 [==============================] - 0s 4ms/step - loss: 5.5824 - val_loss: 3.7903
Epoch 5/100
9/9 [==============================] - 0s 4ms/step - loss: 2.5139 - val_loss: 1.8200
Epoch 6/100
9/9 [==============================] - 0s 4ms/step - loss: 1.9538 - val_loss: 1.8666
Epoch 7/100
9/9 [==============================] - 0s 4ms/step - loss: 1.5421 - val_loss: 1.7236
Epoch 8/100
9/9 [==============================] - 0s 4ms/step - loss: 1.3546 - val_loss: 1.7583
Epoch 9/100
9/9 [==============================] - 0s 4ms/step - loss: 1.2252 - val_loss: 1.7750
Epoch 10/100
9/9 [==============================] - 0s 4ms/step - loss: 1.1640 - val_loss: 1.8739
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plot-results">
<a class="anchor" href="#Plot-results" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plot results<a class="anchor-link" href="#Plot-results"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">training_loss2</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'loss'</span><span class="p">]</span>
<span class="n">test_loss2</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'val_loss'</span><span class="p">]</span>

<span class="c1"># Create count of the number of epochs</span>
<span class="n">epoch_count</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_loss2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Visualize loss history</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epoch_count</span><span class="p">,</span> <span class="n">training_loss2</span><span class="p">,</span> <span class="s1">'r--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epoch_count</span><span class="p">,</span> <span class="n">test_loss2</span><span class="p">,</span> <span class="s1">'b-'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'Training Loss'</span><span class="p">,</span> <span class="s1">'Test Loss'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Epoch'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recommendation-function">
<a class="anchor" href="#Recommendation-function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recommendation function<a class="anchor-link" href="#Recommendation-function"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">make_pred</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">food_id</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">user_id</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">food_id</span><span class="p">])])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">get_topN_rec</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
    <span class="n">user_ratings</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">]</span>
    <span class="n">converted_id</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">User_ID</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="c1">#remove food that user already rated</span>
    <span class="n">recommendation</span> <span class="o">=</span> <span class="n">rating</span><span class="p">[</span><span class="o">~</span><span class="n">rating</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">user_ratings</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">])][[</span><span class="s1">'Food_ID'</span><span class="p">,</span><span class="s1">'food_code'</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    <span class="c1">#predict user rating for every user non rated food</span>
    <span class="n">recommendation</span><span class="p">[</span><span class="s1">'rating_predict'</span><span class="p">]</span> <span class="o">=</span> <span class="n">recommendation</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">make_pred</span><span class="p">(</span><span class="n">converted_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">],</span> <span class="n">model</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1">#create DF user non rated food sorted by rating prediction descending</span>
    <span class="n">final_rec</span> <span class="o">=</span> <span class="n">recommendation</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'rating_predict'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">food_df</span><span class="p">[[</span><span class="s1">'food_code'</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">,</span><span class="s1">'type'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">]],</span><span class="n">on</span><span class="o">=</span><span class="s1">'food_code'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_rec</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'rating_predict'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="s1">'name'</span><span class="p">,</span><span class="s1">'food_code'</span><span class="p">,</span> <span class="s1">'rating_predict'</span><span class="p">,</span><span class="s1">'type'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recommending-for-a-single-user">
<a class="anchor" href="#Recommending-for-a-single-user" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recommending for a single user<a class="anchor-link" href="#Recommending-for-a-single-user"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">model_name</span> <span class="o">=</span> <span class="s1">'model1.h5'</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>

<span class="n">USER_ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">rating</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'USER ID: </span><span class="si">{}</span><span class="s1"> RATED FOOD'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">USER_ID</span><span class="p">))</span>
<span class="c1"># food_df.loc[food_df['Food_ID'].isin(rating.loc[rating['User_ID']==2]['Food_ID'].to_list())]</span>
<span class="n">rating</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">==</span><span class="n">USER_ID</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">food_df</span><span class="p">[[</span><span class="s1">'food_code'</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">,</span><span class="s1">'type'</span><span class="p">]],</span><span class="n">on</span><span class="o">=</span><span class="s1">'food_code'</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'rating'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>USER ID: 97 RATED FOOD
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating_id</th>
      <th>user_id</th>
      <th>food_id</th>
      <th>food_code</th>
      <th>rating</th>
      <th>User_ID</th>
      <th>Food_ID</th>
      <th>name</th>
      <th>category</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>482</td>
      <td>97</td>
      <td>473</td>
      <td>95312400</td>
      <td>5</td>
      <td>82</td>
      <td>138</td>
      <td>Energy drink, low calorie (Monster)</td>
      <td>Diet drinks</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>1</th>
      <td>457</td>
      <td>97</td>
      <td>324</td>
      <td>11321200</td>
      <td>4</td>
      <td>82</td>
      <td>3</td>
      <td>Soy milk, nonfat, chocolate</td>
      <td>Milk substitutes</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>5</th>
      <td>462</td>
      <td>97</td>
      <td>146</td>
      <td>27550420</td>
      <td>4</td>
      <td>82</td>
      <td>48</td>
      <td>Fish sandwich, grilled</td>
      <td>Sandwiches</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>7</th>
      <td>464</td>
      <td>97</td>
      <td>450</td>
      <td>92613510</td>
      <td>4</td>
      <td>82</td>
      <td>134</td>
      <td>Cornmeal beverage with chocolate milk</td>
      <td>Grain drinks</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>4</th>
      <td>461</td>
      <td>97</td>
      <td>185</td>
      <td>41311040</td>
      <td>3</td>
      <td>82</td>
      <td>66</td>
      <td>Lentil curry with rice</td>
      <td>Bean</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>6</th>
      <td>463</td>
      <td>97</td>
      <td>341</td>
      <td>11513370</td>
      <td>3</td>
      <td>82</td>
      <td>14</td>
      <td>Chocolate milk, made from reduced sugar mix wi...</td>
      <td>Milk</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>0</th>
      <td>456</td>
      <td>97</td>
      <td>120</td>
      <td>27445220</td>
      <td>2</td>
      <td>82</td>
      <td>40</td>
      <td>Kung pao chicken</td>
      <td>Stir-fry and soy-based sauce mixtures</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>3</th>
      <td>459</td>
      <td>97</td>
      <td>147</td>
      <td>27550720</td>
      <td>2</td>
      <td>82</td>
      <td>49</td>
      <td>Tuna salad sandwich, on bread</td>
      <td>Sandwiches</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>2</th>
      <td>458</td>
      <td>97</td>
      <td>328</td>
      <td>11350030</td>
      <td>1</td>
      <td>82</td>
      <td>7</td>
      <td>Almond milk, unsweetened, chocolate</td>
      <td>Milk substitutes</td>
      <td>Beverage</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'RECOMENDATION FOR USER ID : '</span><span class="p">,</span><span class="n">USER_ID</span><span class="p">)</span>
<span class="n">rec_result</span> <span class="o">=</span> <span class="n">get_topN_rec</span><span class="p">(</span><span class="n">USER_ID</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="n">rec_result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>RECOMENDATION FOR USER ID :  97
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food_code</th>
      <th>rating_predict</th>
      <th>type</th>
      <th>category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Chocolate milk, ready to drink, low fat</td>
      <td>11511400</td>
      <td>3.727757</td>
      <td>Beverage</td>
      <td>Milk</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Fish chowder</td>
      <td>28350050</td>
      <td>3.644647</td>
      <td>Food</td>
      <td>Soups</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sushi roll, vegetable</td>
      <td>58151230</td>
      <td>3.566590</td>
      <td>Food</td>
      <td>Egg rolls, dumplings, sushi</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Yogurt, low fat milk, fruit</td>
      <td>11432000</td>
      <td>3.537811</td>
      <td>Food</td>
      <td>Yogurt</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Potato chowder</td>
      <td>71803010</td>
      <td>3.523988</td>
      <td>Food</td>
      <td>Soups</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>Broccoli casserole with noodles</td>
      <td>72202010</td>
      <td>2.368195</td>
      <td>Food</td>
      <td>Vegetable dishes</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Oatmeal beverage with milk</td>
      <td>92611100</td>
      <td>2.292341</td>
      <td>Beverage</td>
      <td>Grain drinks</td>
    </tr>
    <tr>
      <th>128</th>
      <td>Codfish salad, Puerto Rican style, Serenata</td>
      <td>27451070</td>
      <td>2.167300</td>
      <td>Food</td>
      <td>Seafood mixed dishes</td>
    </tr>
    <tr>
      <th>129</th>
      <td>Watermelon juice, 100%</td>
      <td>64133100</td>
      <td>2.104285</td>
      <td>Beverage</td>
      <td>Fruit drinks</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Shrimp salad</td>
      <td>27450070</td>
      <td>2.057433</td>
      <td>Food</td>
      <td>Seafood mixed dishes</td>
    </tr>
  </tbody>
</table>
<p>131 rows Ã— 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Recommending-for-all-users">
<a class="anchor" href="#Recommending-for-all-users" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recommending for all users<a class="anchor-link" href="#Recommending-for-all-users"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">zeros_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span><span class="n">columns</span><span class="o">=</span><span class="n">food_df</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">zeros_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>11432000</th>
      <th>11435100</th>
      <th>11446000</th>
      <th>14710200</th>
      <th>26109133</th>
      <th>26109143</th>
      <th>26127123</th>
      <th>26137123</th>
      <th>26153122</th>
      <th>26205160</th>
      <th>26303160</th>
      <th>26315190</th>
      <th>26319121</th>
      <th>27150010</th>
      <th>27150410</th>
      <th>27151070</th>
      <th>27213010</th>
      <th>27243100</th>
      <th>27250020</th>
      <th>27250030</th>
      <th>27250160</th>
      <th>27350070</th>
      <th>27350410</th>
      <th>27363100</th>
      <th>27415140</th>
      <th>27416400</th>
      <th>27445220</th>
      <th>27450010</th>
      <th>27450020</th>
      <th>27450030</th>
      <th>27450070</th>
      <th>27450080</th>
      <th>27450100</th>
      <th>27451070</th>
      <th>27550420</th>
      <th>27550720</th>
      <th>27550800</th>
      <th>28310110</th>
      <th>28311010</th>
      <th>28340110</th>
      <th>...</th>
      <th>11350030</th>
      <th>11370000</th>
      <th>11511300</th>
      <th>11511400</th>
      <th>11513370</th>
      <th>11513854</th>
      <th>11519205</th>
      <th>42403010</th>
      <th>42404010</th>
      <th>61210010</th>
      <th>61210250</th>
      <th>64100220</th>
      <th>64101010</th>
      <th>64104010</th>
      <th>64104030</th>
      <th>64104600</th>
      <th>64124020</th>
      <th>64132500</th>
      <th>64133100</th>
      <th>64134100</th>
      <th>64201010</th>
      <th>73105000</th>
      <th>73105010</th>
      <th>75132000</th>
      <th>75200700</th>
      <th>78101118</th>
      <th>92510955</th>
      <th>92550040</th>
      <th>92550360</th>
      <th>92550370</th>
      <th>92550400</th>
      <th>92582100</th>
      <th>92611100</th>
      <th>92613010</th>
      <th>92613510</th>
      <th>94220215</th>
      <th>95106000</th>
      <th>95110020</th>
      <th>95312400</th>
      <th>95312410</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>149</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>150</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>151</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>152</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>138 rows Ã— 140 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">user_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">food_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rating</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
  <span class="k">if</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_dict</span><span class="p">):</span>
    <span class="n">user_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'User_ID'</span><span class="p">]</span>

  <span class="k">if</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">food_dict</span><span class="p">):</span>
    <span class="n">food_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'Food_ID'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">total_user</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zeros_df</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">zeros_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">(),</span> <span class="n">total</span><span class="o">=</span><span class="n">zeros_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">arr_rated</span> <span class="o">=</span> <span class="n">rating</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">==</span><span class="n">index</span><span class="p">,</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">arr_rated</span><span class="p">:</span>
    <span class="n">zeros_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="n">rate</span><span class="p">]</span><span class="o">=</span><span class="n">rating</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">==</span><span class="n">index</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">rating</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">==</span><span class="n">rate</span><span class="p">),</span><span class="s1">'rating'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

  <span class="n">not_rated</span> <span class="o">=</span> <span class="n">food_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="o">~</span><span class="n">food_df</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">arr_rated</span><span class="p">)),</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">rate</span> <span class="ow">in</span> <span class="n">not_rated</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>

      <span class="n">zeros_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="n">rate</span><span class="p">]</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">user_dict</span><span class="p">[</span><span class="n">index</span><span class="p">]]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">food_dict</span><span class="p">[</span><span class="n">rate</span><span class="p">]])])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="n">zeros_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="n">rate</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">zeros_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>11432000</th>
      <th>11435100</th>
      <th>11446000</th>
      <th>14710200</th>
      <th>26109133</th>
      <th>26109143</th>
      <th>26127123</th>
      <th>26137123</th>
      <th>26153122</th>
      <th>26205160</th>
      <th>26303160</th>
      <th>26315190</th>
      <th>26319121</th>
      <th>27150010</th>
      <th>27150410</th>
      <th>27151070</th>
      <th>27213010</th>
      <th>27243100</th>
      <th>27250020</th>
      <th>27250030</th>
      <th>27250160</th>
      <th>27350070</th>
      <th>27350410</th>
      <th>27363100</th>
      <th>27415140</th>
      <th>27416400</th>
      <th>27445220</th>
      <th>27450010</th>
      <th>27450020</th>
      <th>27450030</th>
      <th>27450070</th>
      <th>27450080</th>
      <th>27450100</th>
      <th>27451070</th>
      <th>27550420</th>
      <th>27550720</th>
      <th>27550800</th>
      <th>28310110</th>
      <th>28311010</th>
      <th>28340110</th>
      <th>...</th>
      <th>11350030</th>
      <th>11370000</th>
      <th>11511300</th>
      <th>11511400</th>
      <th>11513370</th>
      <th>11513854</th>
      <th>11519205</th>
      <th>42403010</th>
      <th>42404010</th>
      <th>61210010</th>
      <th>61210250</th>
      <th>64100220</th>
      <th>64101010</th>
      <th>64104010</th>
      <th>64104030</th>
      <th>64104600</th>
      <th>64124020</th>
      <th>64132500</th>
      <th>64133100</th>
      <th>64134100</th>
      <th>64201010</th>
      <th>73105000</th>
      <th>73105010</th>
      <th>75132000</th>
      <th>75200700</th>
      <th>78101118</th>
      <th>92510955</th>
      <th>92550040</th>
      <th>92550360</th>
      <th>92550370</th>
      <th>92550400</th>
      <th>92582100</th>
      <th>92611100</th>
      <th>92613010</th>
      <th>92613510</th>
      <th>94220215</th>
      <th>95106000</th>
      <th>95110020</th>
      <th>95312400</th>
      <th>95312410</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.139826</td>
      <td>2.436327</td>
      <td>2.914948</td>
      <td>3.064059</td>
      <td>2.152639</td>
      <td>2.811666</td>
      <td>2.493906</td>
      <td>2.657808</td>
      <td>2.584773</td>
      <td>2.782626</td>
      <td>2.405523</td>
      <td>2.669830</td>
      <td>2.762791</td>
      <td>2.778307</td>
      <td>2.040655</td>
      <td>2.791096</td>
      <td>3.006931</td>
      <td>2.926064</td>
      <td>1.975425</td>
      <td>2.512596</td>
      <td>2.617927</td>
      <td>2.061943</td>
      <td>2.459830</td>
      <td>2.476472</td>
      <td>3.108277</td>
      <td>2.903665</td>
      <td>2.000000</td>
      <td>2.739681</td>
      <td>2.969803</td>
      <td>2.857219</td>
      <td>1.648037</td>
      <td>2.558052</td>
      <td>2.536957</td>
      <td>1.774757</td>
      <td>3.147366</td>
      <td>3.262475</td>
      <td>2.605367</td>
      <td>2.153472</td>
      <td>2.872629</td>
      <td>2.171800</td>
      <td>...</td>
      <td>3.023288</td>
      <td>2.602319</td>
      <td>2.944232</td>
      <td>3.327782</td>
      <td>2.591735</td>
      <td>2.579333</td>
      <td>2.841440</td>
      <td>2.795774</td>
      <td>2.060533</td>
      <td>2.880787</td>
      <td>2.347380</td>
      <td>2.798946</td>
      <td>2.859928</td>
      <td>2.888787</td>
      <td>2.664633</td>
      <td>2.941674</td>
      <td>2.907800</td>
      <td>2.677280</td>
      <td>1.710930</td>
      <td>2.737759</td>
      <td>2.374770</td>
      <td>2.252653</td>
      <td>2.617842</td>
      <td>3.107922</td>
      <td>2.452900</td>
      <td>2.726054</td>
      <td>2.685702</td>
      <td>2.907546</td>
      <td>2.200970</td>
      <td>2.526075</td>
      <td>2.846571</td>
      <td>2.834219</td>
      <td>1.905840</td>
      <td>2.395620</td>
      <td>2.700983</td>
      <td>3.067306</td>
      <td>2.507639</td>
      <td>2.626426</td>
      <td>2.771402</td>
      <td>2.835930</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.669862</td>
      <td>2.965430</td>
      <td>3.452461</td>
      <td>3.601798</td>
      <td>2.669595</td>
      <td>3.353076</td>
      <td>3.050075</td>
      <td>3.191225</td>
      <td>3.114342</td>
      <td>3.322101</td>
      <td>2.941957</td>
      <td>3.201020</td>
      <td>3.302985</td>
      <td>3.300699</td>
      <td>2.588086</td>
      <td>3.336053</td>
      <td>3.541552</td>
      <td>3.459570</td>
      <td>2.512301</td>
      <td>3.053189</td>
      <td>3.147243</td>
      <td>2.600858</td>
      <td>3.009467</td>
      <td>3.017641</td>
      <td>3.635453</td>
      <td>3.428099</td>
      <td>3.451886</td>
      <td>3.285903</td>
      <td>3.501585</td>
      <td>3.395110</td>
      <td>2.197453</td>
      <td>3.105477</td>
      <td>3.079295</td>
      <td>2.312761</td>
      <td>3.664447</td>
      <td>3.798048</td>
      <td>3.156804</td>
      <td>2.704181</td>
      <td>3.401925</td>
      <td>5.000000</td>
      <td>...</td>
      <td>3.556667</td>
      <td>3.144114</td>
      <td>3.490580</td>
      <td>3.856461</td>
      <td>3.137579</td>
      <td>3.114257</td>
      <td>3.372025</td>
      <td>4.000000</td>
      <td>2.595849</td>
      <td>3.419743</td>
      <td>2.895194</td>
      <td>3.335731</td>
      <td>3.407485</td>
      <td>3.435883</td>
      <td>3.205101</td>
      <td>3.492666</td>
      <td>3.452172</td>
      <td>3.217064</td>
      <td>2.260697</td>
      <td>3.263680</td>
      <td>2.909354</td>
      <td>2.777401</td>
      <td>4.000000</td>
      <td>3.641354</td>
      <td>2.993044</td>
      <td>3.265775</td>
      <td>3.226499</td>
      <td>3.436700</td>
      <td>2.737818</td>
      <td>3.062349</td>
      <td>3.379939</td>
      <td>3.367663</td>
      <td>2.436710</td>
      <td>2.936510</td>
      <td>3.247708</td>
      <td>3.597850</td>
      <td>3.043602</td>
      <td>3.159549</td>
      <td>3.310502</td>
      <td>3.364701</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.418125</td>
      <td>2.700677</td>
      <td>3.190980</td>
      <td>3.347853</td>
      <td>2.417435</td>
      <td>3.093761</td>
      <td>2.783133</td>
      <td>2.940970</td>
      <td>2.862434</td>
      <td>3.064229</td>
      <td>2.689584</td>
      <td>2.953817</td>
      <td>3.049258</td>
      <td>3.046716</td>
      <td>2.314783</td>
      <td>3.067389</td>
      <td>3.283703</td>
      <td>3.204821</td>
      <td>2.260939</td>
      <td>2.795557</td>
      <td>3.000000</td>
      <td>2.337665</td>
      <td>2.741246</td>
      <td>2.762860</td>
      <td>3.388149</td>
      <td>3.178975</td>
      <td>4.000000</td>
      <td>3.024255</td>
      <td>3.251913</td>
      <td>3.132350</td>
      <td>1.000000</td>
      <td>2.845098</td>
      <td>2.818588</td>
      <td>2.049076</td>
      <td>3.431306</td>
      <td>3.539194</td>
      <td>2.894186</td>
      <td>2.436807</td>
      <td>3.155767</td>
      <td>2.458141</td>
      <td>...</td>
      <td>2.000000</td>
      <td>2.886539</td>
      <td>3.234364</td>
      <td>5.000000</td>
      <td>2.872076</td>
      <td>2.864752</td>
      <td>3.116311</td>
      <td>3.075591</td>
      <td>2.338839</td>
      <td>3.163671</td>
      <td>2.629338</td>
      <td>3.080821</td>
      <td>3.140918</td>
      <td>3.176437</td>
      <td>2.948175</td>
      <td>3.230287</td>
      <td>3.195191</td>
      <td>2.959949</td>
      <td>1.968241</td>
      <td>3.021387</td>
      <td>2.655794</td>
      <td>2.520521</td>
      <td>2.883660</td>
      <td>3.395758</td>
      <td>2.732279</td>
      <td>3.010690</td>
      <td>2.972227</td>
      <td>3.179803</td>
      <td>2.469668</td>
      <td>2.804341</td>
      <td>3.120473</td>
      <td>3.114037</td>
      <td>2.174402</td>
      <td>2.679722</td>
      <td>2.981174</td>
      <td>3.344523</td>
      <td>2.788077</td>
      <td>2.908690</td>
      <td>3.049494</td>
      <td>3.108704</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3.140695</td>
      <td>2.430627</td>
      <td>2.920830</td>
      <td>3.074741</td>
      <td>2.142952</td>
      <td>2.815847</td>
      <td>2.518559</td>
      <td>2.661634</td>
      <td>2.592177</td>
      <td>2.789658</td>
      <td>2.416993</td>
      <td>2.687958</td>
      <td>2.768197</td>
      <td>2.775356</td>
      <td>2.047959</td>
      <td>2.797256</td>
      <td>3.011007</td>
      <td>5.000000</td>
      <td>1.994749</td>
      <td>3.000000</td>
      <td>2.619419</td>
      <td>2.077413</td>
      <td>2.469057</td>
      <td>2.494969</td>
      <td>3.114035</td>
      <td>2.903510</td>
      <td>2.914690</td>
      <td>2.746105</td>
      <td>3.000000</td>
      <td>2.859377</td>
      <td>1.660676</td>
      <td>2.576134</td>
      <td>2.553147</td>
      <td>1.774537</td>
      <td>3.141793</td>
      <td>3.267422</td>
      <td>2.626473</td>
      <td>2.173021</td>
      <td>2.879908</td>
      <td>2.186207</td>
      <td>...</td>
      <td>3.023678</td>
      <td>2.619180</td>
      <td>2.960673</td>
      <td>3.325539</td>
      <td>2.598362</td>
      <td>2.585235</td>
      <td>2.842360</td>
      <td>2.806824</td>
      <td>2.077277</td>
      <td>2.885804</td>
      <td>2.364807</td>
      <td>2.808401</td>
      <td>1.000000</td>
      <td>2.903756</td>
      <td>2.672080</td>
      <td>2.955141</td>
      <td>2.920173</td>
      <td>2.690963</td>
      <td>1.702841</td>
      <td>2.748159</td>
      <td>2.379744</td>
      <td>2.251827</td>
      <td>2.617647</td>
      <td>3.115585</td>
      <td>2.460579</td>
      <td>4.000000</td>
      <td>2.702945</td>
      <td>2.911737</td>
      <td>2.203524</td>
      <td>2.532005</td>
      <td>2.845287</td>
      <td>2.833868</td>
      <td>1.893058</td>
      <td>2.408458</td>
      <td>2.707647</td>
      <td>3.066044</td>
      <td>2.504212</td>
      <td>2.636261</td>
      <td>2.776914</td>
      <td>2.830992</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.110233</td>
      <td>3.388631</td>
      <td>3.884682</td>
      <td>4.036623</td>
      <td>3.111693</td>
      <td>3.777340</td>
      <td>3.467085</td>
      <td>3.629374</td>
      <td>3.551180</td>
      <td>3.754636</td>
      <td>3.377228</td>
      <td>3.636917</td>
      <td>3.735910</td>
      <td>3.732535</td>
      <td>3.010739</td>
      <td>3.767941</td>
      <td>3.967769</td>
      <td>3.900068</td>
      <td>2.944485</td>
      <td>3.487451</td>
      <td>3.578137</td>
      <td>3.019035</td>
      <td>3.429563</td>
      <td>3.444891</td>
      <td>4.071072</td>
      <td>3.871523</td>
      <td>3.876201</td>
      <td>3.708824</td>
      <td>3.939196</td>
      <td>3.826731</td>
      <td>2.604108</td>
      <td>3.524544</td>
      <td>3.512851</td>
      <td>2.735122</td>
      <td>4.113176</td>
      <td>5.000000</td>
      <td>3.585566</td>
      <td>3.122374</td>
      <td>3.000000</td>
      <td>3.139116</td>
      <td>...</td>
      <td>3.986601</td>
      <td>3.569908</td>
      <td>3.918778</td>
      <td>4.289341</td>
      <td>3.564775</td>
      <td>3.552103</td>
      <td>3.802130</td>
      <td>3.768586</td>
      <td>3.029174</td>
      <td>3.848453</td>
      <td>3.321581</td>
      <td>3.764667</td>
      <td>3.841959</td>
      <td>3.860041</td>
      <td>3.632529</td>
      <td>3.911990</td>
      <td>3.880033</td>
      <td>3.647638</td>
      <td>2.663182</td>
      <td>3.706947</td>
      <td>3.349593</td>
      <td>3.215940</td>
      <td>3.563335</td>
      <td>4.081258</td>
      <td>3.419941</td>
      <td>3.697748</td>
      <td>3.659460</td>
      <td>3.871579</td>
      <td>3.167771</td>
      <td>3.489081</td>
      <td>3.807740</td>
      <td>3.804512</td>
      <td>2.860712</td>
      <td>3.365040</td>
      <td>1.000000</td>
      <td>4.030988</td>
      <td>3.470412</td>
      <td>3.600293</td>
      <td>3.738389</td>
      <td>3.801614</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>148</th>
      <td>3.660884</td>
      <td>2.945788</td>
      <td>3.437949</td>
      <td>3.594311</td>
      <td>2.661306</td>
      <td>3.334161</td>
      <td>3.024336</td>
      <td>3.193805</td>
      <td>3.119968</td>
      <td>3.000000</td>
      <td>2.930118</td>
      <td>3.193261</td>
      <td>3.292401</td>
      <td>3.299298</td>
      <td>2.564566</td>
      <td>3.318362</td>
      <td>5.000000</td>
      <td>3.448887</td>
      <td>2.501697</td>
      <td>3.042773</td>
      <td>3.127557</td>
      <td>2.569144</td>
      <td>2.986380</td>
      <td>2.999103</td>
      <td>3.620724</td>
      <td>3.417765</td>
      <td>3.431499</td>
      <td>3.257668</td>
      <td>3.484841</td>
      <td>3.385199</td>
      <td>2.175112</td>
      <td>3.079462</td>
      <td>3.067136</td>
      <td>2.306721</td>
      <td>3.660966</td>
      <td>3.791862</td>
      <td>3.140352</td>
      <td>2.679653</td>
      <td>3.395775</td>
      <td>2.701946</td>
      <td>...</td>
      <td>3.547731</td>
      <td>3.127278</td>
      <td>3.473796</td>
      <td>3.853920</td>
      <td>3.109952</td>
      <td>3.113485</td>
      <td>3.358200</td>
      <td>3.323662</td>
      <td>2.581060</td>
      <td>3.403936</td>
      <td>2.877143</td>
      <td>3.319140</td>
      <td>3.394087</td>
      <td>3.417838</td>
      <td>3.191309</td>
      <td>3.464902</td>
      <td>3.432508</td>
      <td>3.204978</td>
      <td>2.231913</td>
      <td>3.263791</td>
      <td>2.904573</td>
      <td>2.773060</td>
      <td>3.129337</td>
      <td>3.631103</td>
      <td>2.970294</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>3.441901</td>
      <td>2.726429</td>
      <td>3.053205</td>
      <td>3.364688</td>
      <td>3.356330</td>
      <td>2.422045</td>
      <td>2.913697</td>
      <td>3.230137</td>
      <td>3.590240</td>
      <td>5.000000</td>
      <td>3.149271</td>
      <td>3.291314</td>
      <td>3.352514</td>
    </tr>
    <tr>
      <th>149</th>
      <td>3.874892</td>
      <td>3.162535</td>
      <td>3.659703</td>
      <td>3.000000</td>
      <td>2.863328</td>
      <td>3.566884</td>
      <td>3.255441</td>
      <td>3.402344</td>
      <td>3.324309</td>
      <td>3.521742</td>
      <td>3.158463</td>
      <td>3.422438</td>
      <td>3.519569</td>
      <td>3.515995</td>
      <td>2.778553</td>
      <td>3.527701</td>
      <td>3.753004</td>
      <td>3.666983</td>
      <td>2.727796</td>
      <td>3.244657</td>
      <td>3.370610</td>
      <td>2.804128</td>
      <td>3.213092</td>
      <td>3.231439</td>
      <td>3.849643</td>
      <td>3.648152</td>
      <td>3.655045</td>
      <td>3.483298</td>
      <td>3.712604</td>
      <td>3.596773</td>
      <td>2.392924</td>
      <td>3.310330</td>
      <td>3.291727</td>
      <td>2.511538</td>
      <td>3.881667</td>
      <td>4.002404</td>
      <td>3.362305</td>
      <td>2.907712</td>
      <td>3.000000</td>
      <td>2.932967</td>
      <td>...</td>
      <td>3.764382</td>
      <td>3.348402</td>
      <td>3.000000</td>
      <td>4.068195</td>
      <td>3.331685</td>
      <td>3.323439</td>
      <td>4.000000</td>
      <td>3.540884</td>
      <td>2.805303</td>
      <td>3.616753</td>
      <td>3.097737</td>
      <td>3.546515</td>
      <td>3.606318</td>
      <td>3.638829</td>
      <td>3.408298</td>
      <td>3.700579</td>
      <td>3.651514</td>
      <td>3.430519</td>
      <td>2.450036</td>
      <td>3.483958</td>
      <td>3.115675</td>
      <td>2.995974</td>
      <td>3.349664</td>
      <td>3.858605</td>
      <td>3.204465</td>
      <td>3.474492</td>
      <td>3.433642</td>
      <td>3.648319</td>
      <td>2.927574</td>
      <td>3.269455</td>
      <td>3.584101</td>
      <td>3.566848</td>
      <td>2.641196</td>
      <td>3.151317</td>
      <td>3.438586</td>
      <td>3.809644</td>
      <td>3.247022</td>
      <td>3.368433</td>
      <td>3.515756</td>
      <td>3.567118</td>
    </tr>
    <tr>
      <th>150</th>
      <td>5.000000</td>
      <td>3.148902</td>
      <td>4.000000</td>
      <td>3.783362</td>
      <td>2.853904</td>
      <td>3.535095</td>
      <td>3.231292</td>
      <td>3.385276</td>
      <td>3.302385</td>
      <td>3.510539</td>
      <td>3.131710</td>
      <td>3.393615</td>
      <td>3.490478</td>
      <td>3.487233</td>
      <td>4.000000</td>
      <td>3.523165</td>
      <td>3.721174</td>
      <td>3.651788</td>
      <td>2.701386</td>
      <td>3.236294</td>
      <td>3.339384</td>
      <td>2.786769</td>
      <td>3.188079</td>
      <td>3.207715</td>
      <td>3.827957</td>
      <td>3.617408</td>
      <td>3.631309</td>
      <td>3.466675</td>
      <td>3.693700</td>
      <td>3.582414</td>
      <td>2.371711</td>
      <td>3.287757</td>
      <td>3.263802</td>
      <td>2.482999</td>
      <td>3.853515</td>
      <td>3.984071</td>
      <td>3.329771</td>
      <td>2.889624</td>
      <td>3.592202</td>
      <td>2.893954</td>
      <td>...</td>
      <td>3.742426</td>
      <td>3.326204</td>
      <td>3.668401</td>
      <td>4.043622</td>
      <td>4.000000</td>
      <td>3.300520</td>
      <td>3.000000</td>
      <td>3.521848</td>
      <td>2.792728</td>
      <td>3.608304</td>
      <td>3.080164</td>
      <td>3.518016</td>
      <td>3.590139</td>
      <td>3.620370</td>
      <td>3.395728</td>
      <td>3.672837</td>
      <td>3.637685</td>
      <td>3.400571</td>
      <td>2.417489</td>
      <td>3.458539</td>
      <td>3.103291</td>
      <td>2.966363</td>
      <td>3.334010</td>
      <td>3.824963</td>
      <td>3.169250</td>
      <td>3.452033</td>
      <td>3.415263</td>
      <td>3.622393</td>
      <td>2.923202</td>
      <td>3.245422</td>
      <td>3.564975</td>
      <td>3.549349</td>
      <td>2.612498</td>
      <td>3.119567</td>
      <td>3.429374</td>
      <td>3.784447</td>
      <td>3.233478</td>
      <td>3.346038</td>
      <td>3.489890</td>
      <td>3.541781</td>
    </tr>
    <tr>
      <th>151</th>
      <td>3.835242</td>
      <td>3.133507</td>
      <td>3.618795</td>
      <td>3.769706</td>
      <td>3.000000</td>
      <td>3.525195</td>
      <td>3.220660</td>
      <td>3.367332</td>
      <td>3.289846</td>
      <td>3.489022</td>
      <td>3.120812</td>
      <td>3.389895</td>
      <td>3.483965</td>
      <td>3.473887</td>
      <td>2.743539</td>
      <td>3.497372</td>
      <td>3.712043</td>
      <td>3.629138</td>
      <td>2.690318</td>
      <td>3.217563</td>
      <td>3.342812</td>
      <td>2.779243</td>
      <td>3.175973</td>
      <td>3.203770</td>
      <td>3.817188</td>
      <td>3.610568</td>
      <td>3.620110</td>
      <td>3.449685</td>
      <td>3.679109</td>
      <td>3.567909</td>
      <td>2.358190</td>
      <td>3.274645</td>
      <td>3.248218</td>
      <td>2.470139</td>
      <td>3.861023</td>
      <td>3.953989</td>
      <td>3.311404</td>
      <td>2.876605</td>
      <td>3.576960</td>
      <td>2.891404</td>
      <td>...</td>
      <td>3.737251</td>
      <td>3.302030</td>
      <td>3.652484</td>
      <td>4.031684</td>
      <td>3.296977</td>
      <td>3.000000</td>
      <td>3.550693</td>
      <td>3.503512</td>
      <td>2.774831</td>
      <td>3.587451</td>
      <td>3.063677</td>
      <td>3.514746</td>
      <td>3.567568</td>
      <td>3.607006</td>
      <td>3.376642</td>
      <td>3.663908</td>
      <td>3.621531</td>
      <td>3.385128</td>
      <td>2.399378</td>
      <td>3.455406</td>
      <td>3.082788</td>
      <td>2.959064</td>
      <td>3.318573</td>
      <td>3.817043</td>
      <td>3.000000</td>
      <td>3.435803</td>
      <td>3.399808</td>
      <td>3.616585</td>
      <td>2.901591</td>
      <td>3.235632</td>
      <td>3.551958</td>
      <td>3.525805</td>
      <td>2.601377</td>
      <td>3.117651</td>
      <td>3.408645</td>
      <td>3.770430</td>
      <td>3.212371</td>
      <td>3.329481</td>
      <td>3.476335</td>
      <td>3.523089</td>
    </tr>
    <tr>
      <th>152</th>
      <td>3.962178</td>
      <td>3.250337</td>
      <td>3.744140</td>
      <td>3.898303</td>
      <td>2.956889</td>
      <td>3.637694</td>
      <td>3.334126</td>
      <td>3.484199</td>
      <td>3.405482</td>
      <td>3.611169</td>
      <td>3.243412</td>
      <td>3.498445</td>
      <td>3.594770</td>
      <td>3.597613</td>
      <td>2.868800</td>
      <td>3.620421</td>
      <td>3.832595</td>
      <td>3.757765</td>
      <td>2.811610</td>
      <td>3.340937</td>
      <td>3.438590</td>
      <td>2.887712</td>
      <td>3.291055</td>
      <td>3.306579</td>
      <td>3.931702</td>
      <td>3.726670</td>
      <td>3.737535</td>
      <td>3.577881</td>
      <td>3.801684</td>
      <td>3.677351</td>
      <td>2.477317</td>
      <td>3.390579</td>
      <td>3.370773</td>
      <td>2.584315</td>
      <td>3.960963</td>
      <td>4.090938</td>
      <td>3.444424</td>
      <td>2.985172</td>
      <td>3.700704</td>
      <td>3.003195</td>
      <td>...</td>
      <td>3.840920</td>
      <td>3.435164</td>
      <td>3.783303</td>
      <td>4.146561</td>
      <td>3.427347</td>
      <td>3.410177</td>
      <td>3.662200</td>
      <td>3.628573</td>
      <td>2.888842</td>
      <td>3.715254</td>
      <td>3.178801</td>
      <td>3.623777</td>
      <td>3.695335</td>
      <td>3.727301</td>
      <td>3.498948</td>
      <td>3.778229</td>
      <td>3.739441</td>
      <td>3.510526</td>
      <td>2.512692</td>
      <td>3.561393</td>
      <td>3.202925</td>
      <td>3.061658</td>
      <td>3.430589</td>
      <td>3.936920</td>
      <td>3.276981</td>
      <td>3.554590</td>
      <td>3.523555</td>
      <td>3.725885</td>
      <td>3.026539</td>
      <td>3.348306</td>
      <td>3.667686</td>
      <td>3.657706</td>
      <td>2.709122</td>
      <td>3.231237</td>
      <td>3.528446</td>
      <td>3.884633</td>
      <td>3.000000</td>
      <td>3.454969</td>
      <td>3.596344</td>
      <td>3.654120</td>
    </tr>
  </tbody>
</table>
<p>138 rows Ã— 140 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">food_name_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">food_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">food_name_dict</span><span class="p">):</span>
        <span class="n">food_name_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">'food_code'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Give Recommendation to One User</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">USER_ID</span> <span class="o">=</span> <span class="mi">129</span>
<span class="n">food_code_arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">name_arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">prediction_arr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">user_rated_food_code</span> <span class="o">=</span> <span class="n">rating</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">==</span><span class="n">USER_ID</span><span class="p">,</span><span class="s1">'food_code'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">zeros_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">USER_ID</span><span class="p">)]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">user_rated_food_code</span><span class="p">):</span>
    <span class="n">food_code_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="n">name_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">food_name_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)])</span>
    <span class="n">prediction_arr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Recommendation for user id : </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">USER_ID</span><span class="p">))</span>
<span class="n">rating</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rating</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span><span class="o">==</span><span class="n">USER_ID</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">food_df</span><span class="p">[[</span><span class="s1">'food_code'</span><span class="p">,</span> <span class="s1">'name'</span><span class="p">,</span><span class="s1">'category'</span><span class="p">,</span><span class="s1">'type'</span><span class="p">]],</span><span class="n">on</span><span class="o">=</span><span class="s1">'food_code'</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'rating'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Recommendation for user id : 129
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating_id</th>
      <th>user_id</th>
      <th>food_id</th>
      <th>food_code</th>
      <th>rating</th>
      <th>User_ID</th>
      <th>Food_ID</th>
      <th>name</th>
      <th>category</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>615</td>
      <td>129</td>
      <td>202</td>
      <td>58151200</td>
      <td>5</td>
      <td>114</td>
      <td>76</td>
      <td>Sushi roll, salmon</td>
      <td>Egg rolls, dumplings, sushi</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>1</th>
      <td>616</td>
      <td>129</td>
      <td>204</td>
      <td>58151220</td>
      <td>5</td>
      <td>114</td>
      <td>78</td>
      <td>Sushi roll tuna</td>
      <td>Egg rolls, dumplings, sushi</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>6</th>
      <td>621</td>
      <td>129</td>
      <td>370</td>
      <td>61210010</td>
      <td>5</td>
      <td>114</td>
      <td>88</td>
      <td>Orange juice, 100%,  freshly squeezed</td>
      <td>Fruit drinks</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>2</th>
      <td>617</td>
      <td>129</td>
      <td>203</td>
      <td>58151210</td>
      <td>4</td>
      <td>114</td>
      <td>77</td>
      <td>Sushi roll, shrimp</td>
      <td>Egg rolls, dumplings, sushi</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>5</th>
      <td>620</td>
      <td>129</td>
      <td>372</td>
      <td>61210250</td>
      <td>4</td>
      <td>114</td>
      <td>89</td>
      <td>Orange juice, 100%, with calcium added, canned...</td>
      <td>Fruit drinks</td>
      <td>Beverage</td>
    </tr>
    <tr>
      <th>3</th>
      <td>618</td>
      <td>129</td>
      <td>170</td>
      <td>32103030</td>
      <td>2</td>
      <td>114</td>
      <td>57</td>
      <td>Egg salad, made with creamy dressing</td>
      <td>Eggs and omelets</td>
      <td>Food</td>
    </tr>
    <tr>
      <th>4</th>
      <td>619</td>
      <td>129</td>
      <td>183</td>
      <td>41311020</td>
      <td>2</td>
      <td>114</td>
      <td>64</td>
      <td>Sambar, vegetable stew</td>
      <td>Vegetable dishes</td>
      <td>Food</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">recommendation_columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'food_code'</span><span class="p">:</span> <span class="n">food_code_arr</span><span class="p">,</span>
                          <span class="s1">'name'</span><span class="p">:</span> <span class="n">name_arr</span><span class="p">,</span>
                          <span class="s1">'predicted_rating'</span><span class="p">:</span> <span class="n">prediction_arr</span><span class="p">,</span>
                          <span class="p">}</span>

<span class="n">rec_for_user</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">recommendation_columns</span><span class="p">)</span>

<span class="c1"># SORTED RATING FOR ONE USER</span>
<span class="n">rec_for_user</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">'predicted_rating'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>food_code</th>
      <th>name</th>
      <th>predicted_rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>98</th>
      <td>11511400</td>
      <td>Chocolate milk, ready to drink, low fat</td>
      <td>4.190182</td>
    </tr>
    <tr>
      <th>35</th>
      <td>27550720</td>
      <td>Tuna salad sandwich, on bread</td>
      <td>4.137423</td>
    </tr>
    <tr>
      <th>41</th>
      <td>28350050</td>
      <td>Fish chowder</td>
      <td>4.124354</td>
    </tr>
    <tr>
      <th>58</th>
      <td>58151230</td>
      <td>Sushi roll, vegetable</td>
      <td>4.039911</td>
    </tr>
    <tr>
      <th>0</th>
      <td>11432000</td>
      <td>Yogurt, low fat milk, fruit</td>
      <td>4.014369</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>72202010</td>
      <td>Broccoli casserole with noodles</td>
      <td>2.846332</td>
    </tr>
    <tr>
      <th>125</th>
      <td>92611100</td>
      <td>Oatmeal beverage with milk</td>
      <td>2.766398</td>
    </tr>
    <tr>
      <th>33</th>
      <td>27451070</td>
      <td>Codfish salad, Puerto Rican style, Serenata</td>
      <td>2.646078</td>
    </tr>
    <tr>
      <th>111</th>
      <td>64133100</td>
      <td>Watermelon juice, 100%</td>
      <td>2.578853</td>
    </tr>
    <tr>
      <th>30</th>
      <td>27450070</td>
      <td>Shrimp salad</td>
      <td>2.521929</td>
    </tr>
  </tbody>
</table>
<p>133 rows Ã— 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Save-predicted-data-to-csv-file">
<a class="anchor" href="#Save-predicted-data-to-csv-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Save predicted data to csv file<a class="anchor-link" href="#Save-predicted-data-to-csv-file"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">zeros_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'recs.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="recohut/notebook"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/tensorflow/health&fitness/food/knn/2021/07/25/ayuhealth-food-recommender.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Jupyter notebook database.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/recohut" target="_blank" title="recohut"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
