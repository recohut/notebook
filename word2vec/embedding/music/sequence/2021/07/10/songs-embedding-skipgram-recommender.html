<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Song Embeddings - Skipgram Recommender | reconb</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Song Embeddings - Skipgram Recommender" />
<meta name="author" content="<a href='https://github.com/jalammar/jalammar.github.io'>Jay Alammar</a>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this notebook, we’ll use human-made music playlists to learn song embeddings. We’ll treat a playlist as if it’s a sentence and the songs it contains as words. We feed that to the word2vec algorithm which then learns embeddings for every song we have. These embeddings can then be used to recommend similar songs." />
<meta property="og:description" content="In this notebook, we’ll use human-made music playlists to learn song embeddings. We’ll treat a playlist as if it’s a sentence and the songs it contains as words. We feed that to the word2vec algorithm which then learns embeddings for every song we have. These embeddings can then be used to recommend similar songs." />
<link rel="canonical" href="https://nb.recohut.com/word2vec/embedding/music/sequence/2021/07/10/songs-embedding-skipgram-recommender.html" />
<meta property="og:url" content="https://nb.recohut.com/word2vec/embedding/music/sequence/2021/07/10/songs-embedding-skipgram-recommender.html" />
<meta property="og:site_name" content="reconb" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-07-10T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Song Embeddings - Skipgram Recommender" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"<a href='https://github.com/jalammar/jalammar.github.io'>Jay Alammar</a>"},"dateModified":"2021-07-10T00:00:00-05:00","datePublished":"2021-07-10T00:00:00-05:00","description":"In this notebook, we’ll use human-made music playlists to learn song embeddings. We’ll treat a playlist as if it’s a sentence and the songs it contains as words. We feed that to the word2vec algorithm which then learns embeddings for every song we have. These embeddings can then be used to recommend similar songs.","headline":"Song Embeddings - Skipgram Recommender","mainEntityOfPage":{"@type":"WebPage","@id":"https://nb.recohut.com/word2vec/embedding/music/sequence/2021/07/10/songs-embedding-skipgram-recommender.html"},"url":"https://nb.recohut.com/word2vec/embedding/music/sequence/2021/07/10/songs-embedding-skipgram-recommender.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nb.recohut.com/feed.xml" title="reconb" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">reconb</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Song Embeddings - Skipgram Recommender</h1><p class="page-description">In this notebook, we'll use human-made music playlists to learn song embeddings. We'll treat a playlist as if it's a sentence and the songs it contains as words. We feed that to the word2vec algorithm which then learns embeddings for every song we have. These embeddings can then be used to recommend similar songs.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-07-10T00:00:00-05:00" itemprop="datePublished">
        Jul 10, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name"><a href='https://github.com/jalammar/jalammar.github.io'>Jay Alammar</a></span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      9 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Word2Vec">Word2Vec</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Embedding">Embedding</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Music">Music</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#Sequence">Sequence</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/recohut/notebook/tree/master/_notebooks/2021-07-10-songs-embedding-skipgram-recommender.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/recohut/notebook/master?filepath=_notebooks%2F2021-07-10-songs-embedding-skipgram-recommender.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/recohut/notebook/blob/master/_notebooks/2021-07-10-songs-embedding-skipgram-recommender.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frecohut%2Fnotebook%2Fblob%2Fmaster%2F_notebooks%2F2021-07-10-songs-embedding-skipgram-recommender.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Downloading-data">Downloading data </a></li>
<li class="toc-entry toc-h2"><a href="#Setup">Setup </a></li>
<li class="toc-entry toc-h2"><a href="#Training-dataset">Training dataset </a></li>
<li class="toc-entry toc-h2"><a href="#Training-Word2vec">Training Word2vec </a></li>
<li class="toc-entry toc-h2"><a href="#Prepare-songs-metadata">Prepare songs metadata </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Title-and-artist">Title and artist </a></li>
<li class="toc-entry toc-h3"><a href="#Tags">Tags </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Recommend">Recommend </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Paranoid-Android---Radiohead">Paranoid Android - Radiohead </a></li>
<li class="toc-entry toc-h3"><a href="#California-Love---2Pac">California Love - 2Pac </a></li>
<li class="toc-entry toc-h3"><a href="#Billie-Jean---Michael-Jackson">Billie Jean - Michael Jackson </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-07-10-songs-embedding-skipgram-recommender.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This technique is used by Spotify, AirBnB, Alibaba, and others. It accounts for a vast portion of their user activity, user media consumption, and/or sales (in the case of Alibaba). The dataset we'll use was collected by Shuo Chen from Cornell University. The <a href="https://www.cs.cornell.edu/~shuochen/lme/data_page.html">dataset</a> contains playlists from hundreds of radio stations from around the US.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Downloading-data">
<a class="anchor" href="#Downloading-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Downloading data<a class="anchor-link" href="#Downloading-data"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="o">-</span><span class="n">q</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">cornell</span><span class="o">.</span><span class="n">edu</span><span class="o">/~</span><span class="n">shuochen</span><span class="o">/</span><span class="n">lme</span><span class="o">/</span><span class="n">dataset</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="err">!</span><span class="n">tar</span> <span class="o">-</span><span class="n">xf</span> <span class="n">dataset</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">
<a class="anchor" href="#Setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup<a class="anchor-link" href="#Setup"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">gensim</span> 
<span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">Word2Vec</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-dataset">
<a class="anchor" href="#Training-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training dataset<a class="anchor-link" href="#Training-dataset"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"/content/dataset/yes_complete/train.txt"</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="c1"># skipping first 2 lines as they contain only metadata</span>
  <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
  <span class="c1"># select playlists with at least 2 songs, a minimum threshold for sequence learning </span>
  <span class="n">playlists</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">'Playlist #1:</span><span class="se">\n</span><span class="s1"> '</span><span class="p">,</span> <span class="n">playlists</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">'Playlist #2:</span><span class="se">\n</span><span class="s1"> '</span><span class="p">,</span> <span class="n">playlists</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Playlist #1:
  ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32', '33', '34', '35', '36', '37', '38', '39', '40', '41', '2', '42', '43', '44', '45', '46', '47', '48', '20', '49', '8', '50', '51', '52', '53', '54', '55', '56', '57', '25', '58', '59', '60', '61', '62', '3', '63', '64', '65', '66', '46', '47', '67', '2', '48', '68', '69', '70', '57', '50', '71', '72', '53', '73', '25', '74', '59', '20', '46', '75', '76', '77', '59', '20', '43'] 

Playlist #2:
  ['78', '79', '80', '3', '62', '81', '14', '82', '48', '83', '84', '17', '85', '86', '87', '88', '74', '89', '90', '91', '4', '73', '62', '92', '17', '53', '59', '93', '94', '51', '50', '27', '95', '48', '96', '97', '98', '99', '100', '57', '101', '102', '25', '103', '3', '104', '105', '106', '107', '47', '108', '109', '110', '111', '112', '113', '25', '63', '62', '114', '115', '84', '116', '117', '118', '119', '120', '121', '122', '123', '50', '70', '71', '124', '17', '85', '14', '82', '48', '125', '47', '46', '72', '53', '25', '73', '4', '126', '59', '74', '20', '43', '127', '128', '129', '13', '82', '48', '130', '131', '132', '133', '134', '135', '136', '137', '59', '46', '138', '43', '20', '139', '140', '73', '57', '70', '141', '3', '1', '74', '142', '143', '144', '145', '48', '13', '25', '146', '50', '147', '126', '59', '20', '148', '149', '150', '151', '152', '56', '153', '154', '155', '156', '157', '158', '159', '160', '161', '162', '163', '164', '165', '166', '167', '168', '169', '170', '171', '172', '173', '174', '175', '60', '176', '51', '177', '178', '179', '180', '181', '182', '183', '184', '185', '57', '186', '187', '188', '189', '190', '191', '46', '192', '193', '194', '195', '196', '197', '198', '25', '199', '200', '49', '201', '100', '202', '203', '204', '205', '206', '207', '32', '208', '209', '210']
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-Word2vec">
<a class="anchor" href="#Training-Word2vec" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training Word2vec<a class="anchor-link" href="#Training-Word2vec"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our dataset is now in the shape the the Word2Vec model expects as input. We pass the dataset to the model, and set the following key parameters:</p>
<ul>
<li>size: Embedding size for the songs.</li>
<li>window: word2vec algorithm parameter -- maximum distance between the current and predicted word (song) within a sentence</li>
<li>negative: word2vec algorithm parameter -- Number of negative examples to use at each training step that the model needs to identify as noise</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">(</span><span class="n">playlists</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">workers</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is now trained. Every song has an embedding. We only have song IDs, though, no titles or other info. Let's grab the song information file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-songs-metadata">
<a class="anchor" href="#Prepare-songs-metadata" aria-hidden="true"><span class="octicon octicon-link"></span></a>Prepare songs metadata<a class="anchor-link" href="#Prepare-songs-metadata"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Title-and-artist">
<a class="anchor" href="#Title-and-artist" aria-hidden="true"><span class="octicon octicon-link"></span></a>Title and artist<a class="anchor-link" href="#Title-and-artist"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">head</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">yes_complete</span><span class="o">/</span><span class="n">song_hash</span><span class="o">.</span><span class="n">txt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 	Gucci Time (w\/ Swizz Beatz)	Gucci Mane
1 	Aston Martin Music (w\/ Drake &amp; Chrisette Michelle)	Rick Ross
2 	Get Back Up (w\/ Chris Brown)	T.I.
3 	Hot Toddy (w\/ Jay-Z &amp; Ester Dean)	Usher
4 	Whip My Hair	Willow
5 	Down On Me (w\/ 50 Cent)	Jeremih
6 	Black And Yellow	Wiz Khalifa
7 	Blowing Me Kisses	Soulja Boy
8 	Lay It Down	Lloyd
9 	Good For My Money (w\/ Lloyd)	Baby Bash
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"/content/dataset/yes_complete/song_hash.txt"</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">songs_file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">songs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">songs_file</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">songs_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">songs</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'title'</span><span class="p">,</span> <span class="s1">'artist'</span><span class="p">])</span>
<span class="n">songs_df</span> <span class="o">=</span> <span class="n">songs_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
<span class="n">songs_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>artist</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gucci Time (w\/ Swizz Beatz)</td>
      <td>Gucci Mane</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aston Martin Music (w\/ Drake &amp; Chrisette Mich...</td>
      <td>Rick Ross</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Get Back Up (w\/ Chris Brown)</td>
      <td>T.I.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Hot Toddy (w\/ Jay-Z &amp; Ester Dean)</td>
      <td>Usher</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Whip My Hair</td>
      <td>Willow</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">songs_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>artist</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Aston Martin Music (w\/ Drake &amp; Chrisette Mich...</td>
      <td>Rick Ross</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Shake It</td>
      <td>Elephant Man</td>
    </tr>
    <tr>
      <th>100</th>
      <td>I'm Yours</td>
      <td>Jason Mraz</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">songs_df</span><span class="p">[</span><span class="n">songs_df</span><span class="o">.</span><span class="n">artist</span> <span class="o">==</span> <span class="s1">'Rush'</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>artist</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1861</th>
      <td>Tom Sawyer</td>
      <td>Rush</td>
    </tr>
    <tr>
      <th>2640</th>
      <td>Red Barchetta</td>
      <td>Rush</td>
    </tr>
    <tr>
      <th>2655</th>
      <td>Fly By Night</td>
      <td>Rush</td>
    </tr>
    <tr>
      <th>2691</th>
      <td>Freewill</td>
      <td>Rush</td>
    </tr>
    <tr>
      <th>2748</th>
      <td>Limelight</td>
      <td>Rush</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tags">
<a class="anchor" href="#Tags" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tags<a class="anchor-link" href="#Tags"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">head</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">yes_complete</span><span class="o">/</span><span class="n">tag_hash</span><span class="o">.</span><span class="n">txt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0, rock
1, pop
2, favorites
3, alternative
4, love
5, male vocalists
6, american
7, indie
8, classic rock
9, awesome
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"/content/dataset/yes_complete/tag_hash.txt"</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">tags_file</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tags_file</span><span class="p">]</span>
  <span class="n">tag_name</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="n">b</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
  <span class="n">tag_name</span><span class="p">[</span><span class="s1">'#'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'no tag'</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Tag name for tag id </span><span class="si">{}</span><span class="s1"> is "</span><span class="si">{}</span><span class="s1">"</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'10'</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">[</span><span class="s1">'10'</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Tag name for tag id </span><span class="si">{}</span><span class="s1"> is "</span><span class="si">{}</span><span class="s1">"</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">'80'</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">[</span><span class="s1">'80'</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'There are total </span><span class="si">{}</span><span class="s1"> tags'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tag_name</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tag name for tag id 10 is "jazz"

Tag name for tag id 80 is "rhythm and blues"

There are total 251 tags
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">head</span> <span class="o">/</span><span class="n">content</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">yes_complete</span><span class="o">/</span><span class="n">tags</span><span class="o">.</span><span class="n">txt</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>154
20 35 40 65 72 130 154 193
154
1 49
1 6 21 35 49 65 78 80 141 154
21 35 38 49 65 72 114 141 154
1 5 6 21 33 49 63 65 72 87 98 110 141 147 154 197
49 65 72 141 197
11 35 154
#
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"/content/dataset/yes_complete/tags.txt"</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">song_tags</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
  <span class="n">song_tags</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">' '</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">song_tags</span><span class="p">]</span>
  <span class="n">song_tags</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">song_tags</span><span class="p">)}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">tags_for_song</span><span class="p">(</span><span class="n">song_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
  <span class="n">tag_ids</span> <span class="o">=</span> <span class="n">song_tags</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">song_id</span><span class="p">)]</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">tag_name</span><span class="p">[</span><span class="n">tag_id</span><span class="p">]</span> <span class="k">for</span> <span class="n">tag_id</span> <span class="ow">in</span> <span class="n">tag_ids</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Tags for song "</span><span class="si">{}</span><span class="s1">" : </span><span class="si">{}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">songs_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">tags_for_song</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tags for song "Gucci Time (w\/ Swizz Beatz)" : ['wjlb-fm']

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Recommend">
<a class="anchor" href="#Recommend" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recommend<a class="anchor-link" href="#Recommend"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">recommend</span><span class="p">(</span><span class="n">song_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">topn</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="c1"># song info</span>
  <span class="n">song_info</span> <span class="o">=</span> <span class="n">songs_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">song_id</span><span class="p">]</span>
  <span class="n">song_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">', '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags_for_song</span><span class="p">(</span><span class="n">song_id</span><span class="p">))]</span>
  <span class="n">query_song</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'title'</span><span class="p">:</span><span class="n">song_info</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
                             <span class="s1">'artist'</span><span class="p">:</span><span class="n">song_info</span><span class="o">.</span><span class="n">artist</span><span class="p">,</span>
                             <span class="s1">'tags'</span><span class="p">:</span><span class="n">song_tags</span><span class="p">})</span>

  <span class="c1"># similar songs</span>
  <span class="n">similar_songs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">song_id</span><span class="p">),</span> <span class="n">topn</span><span class="o">=</span><span class="n">topn</span><span class="p">))[:,</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">recommendations</span> <span class="o">=</span> <span class="n">songs_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">similar_songs</span><span class="p">]</span>
  <span class="n">recommendations</span><span class="p">[</span><span class="s1">'tags'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">tags_for_song</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">similar_songs</span><span class="p">]</span>

  <span class="n">recommendations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">query_song</span><span class="p">,</span> <span class="n">recommendations</span><span class="p">])</span>

  <span class="n">axis_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Query'</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'Recommendation '</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">topn</span><span class="p">)]</span>
  <span class="c1"># recommendations.index = axis_name</span>
  <span class="n">recommendations</span> <span class="o">=</span> <span class="n">recommendations</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">([{</span><span class="s1">'selector'</span><span class="p">:</span> <span class="s1">'th'</span><span class="p">,</span> <span class="s1">'props'</span><span class="p">:</span> <span class="p">[(</span><span class="s1">'background-color'</span><span class="p">,</span> <span class="s1">'gray'</span><span class="p">)]}])</span>
  
  <span class="k">return</span> <span class="n">recommendations</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">recs</span> <span class="o">=</span> <span class="n">recommend</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">recs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_a92d05ec_e163_11eb_afea_0242ac1c0002 th {
          background-color: gray;
    }</style>
<table id="T_a92d05ec_e163_11eb_afea_0242ac1c0002">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">title</th>        <th class="col_heading level0 col1">artist</th>        <th class="col_heading level0 col2">tags</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row0" class="row_heading level0 row0">Query</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row0_col0" class="data row0 col0">Shake It</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row0_col1" class="data row0 col1">Elephant Man</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row0_col2" class="data row0 col2">no tag</td>
            </tr>
            <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row1" class="row_heading level0 row1">Recommendation 1</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row1_col0" class="data row1 col0">Pudrete</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row1_col1" class="data row1 col1">Banda MS</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row1_col2" class="data row1 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row2" class="row_heading level0 row2">Recommendation 2</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row2_col0" class="data row2 col0">Let Me Know</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row2_col1" class="data row2 col1">Roisin Murphy</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row2_col2" class="data row2 col2">['rock', 'pop', 'favorites', 'love', 'female vocalists', '00s', 'dance', 'favourites', 'cool', 'chillout', 'electronic', 'sexy', 'british', 'upbeat', 'sad', 'seen live', 'indie pop', 'love it', 'electronica', 'female', 'good stuff', 'uk', 'lovely', 'disco', 'electro', 'favorite artists', '2007']</td>
            </tr>
            <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row3" class="row_heading level0 row3">Recommendation 3</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row3_col0" class="data row3 col0">In This Lifetime</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row3_col1" class="data row3 col1">The Psycho Realm</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row3_col2" class="data row3 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row4" class="row_heading level0 row4">Recommendation 4</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row4_col0" class="data row4 col0">Take A Bow</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row4_col1" class="data row4 col1">Rihanna</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row4_col2" class="data row4 col2">['pop', 'love', 'american', 'beautiful', 'soul', 'female vocalists', '00s', 'mellow', 'favorite', 'dance', 'favourites', 'cool', 'chillout', 'rnb', 'sexy', 'female vocalist', 'hip-hop', 'love songs', 'sad', 'hip hop', 'ballad', 'piano', 'memories', 'relaxing', 'love at first listen', 'female', 'r&amp;b', 'slow', 'sweet', 'love song', 'soft', 'rb', 'r and b', 'emo', '&lt;3', 'slow jams', 'major key tonality', 'guilty pleasures', 'emotional', '2008', 'a subtle use of vocal harmony', 'cute']</td>
            </tr>
            <tr>
                        <th id="T_a92d05ec_e163_11eb_afea_0242ac1c0002level0_row5" class="row_heading level0 row5">Recommendation 5</th>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row5_col0" class="data row5 col0">Get Right</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row5_col1" class="data row5 col1">Jennifer Lopez</td>
                        <td id="T_a92d05ec_e163_11eb_afea_0242ac1c0002row5_col2" class="data row5 col2">['pop', 'favorites', 'love', 'american', 'soul', 'female vocalists', '00s', 'dance', 'singer-songwriter', '90s', 'favourites', 'cool', 'catchy', 'rnb', 'sexy', 'fun', 'party', 'happy', 'female vocalist', 'hip-hop', 'funk', 'upbeat', 'hip hop', 'female', 'funky', 'r&amp;b', '2000s', 'latin', 'energetic', 'top 40', 'vocal', 'female vocals', 'english', 'urban', 'uplifting', 'r and b', 'hardcore', 'guilty pleasures', 'guilty pleasure', 'hiphop', 'new york', 'sing along', 'feelgood']</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Paranoid-Android---Radiohead">
<a class="anchor" href="#Paranoid-Android---Radiohead" aria-hidden="true"><span class="octicon octicon-link"></span></a>Paranoid Android - Radiohead<a class="anchor-link" href="#Paranoid-Android---Radiohead"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">recommend</span><span class="p">(</span><span class="n">song_id</span><span class="o">=</span><span class="mi">19563</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_e7dc063e_e164_11eb_afea_0242ac1c0002 th {
          background-color: gray;
    }</style>
<table id="T_e7dc063e_e164_11eb_afea_0242ac1c0002">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">title</th>        <th class="col_heading level0 col1">artist</th>        <th class="col_heading level0 col2">tags</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row0_col0" class="data row0 col0">Paranoid Android</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row0_col1" class="data row0 col1">Radiohead</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row0_col2" class="data row0 col2">rock, pop, favorites, alternative, love, male vocalists, indie, classic rock, awesome, beautiful, mellow, alternative rock, favorite, chill, 90s, classic, favourites, chillout, indie rock, guitar, favorite songs, male vocalist, electronic, loved, british, favourite, soundtrack, amazing, sad, favourite songs, great song, ballad, melancholy, epic, experimental, psychedelic, memories, electronica, love at first listen, fucking awesome, progressive rock, great, best, nostalgia, melancholic, fav, good stuff, uk, great lyrics, ambient, perfect, psychedelic rock, dark, britpop, brilliant, alternative  punk, progressive, emotional, masterpiece, best songs ever, rockin, genius, all time favourites, alt rock, 1990s</td>
            </tr>
            <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row1" class="row_heading level0 row1">43036 </th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row1_col0" class="data row1 col0">Que Te Quieran Mas Que Yo</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row1_col1" class="data row1 col1">Marco Antonio Solis</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row1_col2" class="data row1 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row2" class="row_heading level0 row2">64157 </th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row2_col0" class="data row2 col0">Paryer And Meditation</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row2_col1" class="data row2 col1">Jessica Williams</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row2_col2" class="data row2 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row3" class="row_heading level0 row3">65275 </th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row3_col0" class="data row3 col0">Hallelujah Goat</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row3_col1" class="data row3 col1">Volbeat</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row3_col2" class="data row3 col2">['rock', 'awesome', 'hard rock', 'metal', 'heavy metal', 'good', 'rock and roll']</td>
            </tr>
            <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row4" class="row_heading level0 row4">66070 </th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row4_col0" class="data row4 col0">You're My Christmas Present</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row4_col1" class="data row4 col1">Jimmy Beaumont &amp; The Skyliners</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row4_col2" class="data row4 col2">['christmas']</td>
            </tr>
            <tr>
                        <th id="T_e7dc063e_e164_11eb_afea_0242ac1c0002level0_row5" class="row_heading level0 row5">16550 </th>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row5_col0" class="data row5 col0">Jump Start</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row5_col1" class="data row5 col1">Nils</td>
                        <td id="T_e7dc063e_e164_11eb_afea_0242ac1c0002row5_col2" class="data row5 col2">['no tag']</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="California-Love---2Pac">
<a class="anchor" href="#California-Love---2Pac" aria-hidden="true"><span class="octicon octicon-link"></span></a>California Love - 2Pac<a class="anchor-link" href="#California-Love---2Pac"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">recommend</span><span class="p">(</span><span class="n">song_id</span><span class="o">=</span><span class="mi">842</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_087be396_e165_11eb_afea_0242ac1c0002 th {
          background-color: gray;
    }</style>
<table id="T_087be396_e165_11eb_afea_0242ac1c0002">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">title</th>        <th class="col_heading level0 col1">artist</th>        <th class="col_heading level0 col2">tags</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row0_col0" class="data row0 col0">California Love (w\/ Dr. Dre &amp; Roger Troutman)</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row0_col1" class="data row0 col1">2Pac</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row0_col2" class="data row0 col2">favorites, love, oldies, dance, 90s, classic, loved, party, hip-hop, hip hop, rap, fav, old school, songs i absolutely love, hiphop, acclaimed music top 3000, california, 1990s</td>
            </tr>
            <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row1" class="row_heading level0 row1">20597 </th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row1_col0" class="data row1 col0">Monk'n Around</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row1_col1" class="data row1 col1">Ryan Cohan</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row1_col2" class="data row1 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row2" class="row_heading level0 row2">41172 </th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row2_col0" class="data row2 col0">Nadie Como Tu</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row2_col1" class="data row2 col1">Ramon Ayala Y Sus Bravos Del Norte</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row2_col2" class="data row2 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row3" class="row_heading level0 row3">44549 </th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row3_col0" class="data row3 col0">Crash</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row3_col1" class="data row3 col1">The Primitives</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row3_col2" class="data row3 col2">['rock', 'pop', 'favorites', 'alternative', 'indie', 'female vocalists', '80s', '90s', 'cool', 'catchy', 'party', 'favourite', 'happy', 'female vocalist', 'upbeat', 'soundtrack', 'indie pop', 'memories', 'female', 'new wave', 'uplifting', 'britpop', 'major key tonality', "80's", '1980s', 'acclaimed music top 3000', 'rockin']</td>
            </tr>
            <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row4" class="row_heading level0 row4">53636 </th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row4_col0" class="data row4 col0">Always There For You</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row4_col1" class="data row4 col1">Stryper</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row4_col2" class="data row4 col2">['80s', 'hard rock', 'heavy metal', 'christian', 'christian rock']</td>
            </tr>
            <tr>
                        <th id="T_087be396_e165_11eb_afea_0242ac1c0002level0_row5" class="row_heading level0 row5">48409 </th>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row5_col0" class="data row5 col0">-</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row5_col1" class="data row5 col1">-</td>
                        <td id="T_087be396_e165_11eb_afea_0242ac1c0002row5_col2" class="data row5 col2">['no tag']</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Billie-Jean---Michael-Jackson">
<a class="anchor" href="#Billie-Jean---Michael-Jackson" aria-hidden="true"><span class="octicon octicon-link"></span></a>Billie Jean - Michael Jackson<a class="anchor-link" href="#Billie-Jean---Michael-Jackson"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">recommend</span><span class="p">(</span><span class="n">song_id</span><span class="o">=</span><span class="mi">3822</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style type="text/css">
    #T_0e25e2c4_e165_11eb_afea_0242ac1c0002 th {
          background-color: gray;
    }</style>
<table id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002">
<thead>    <tr>        <th class="blank level0"></th>        <th class="col_heading level0 col0">title</th>        <th class="col_heading level0 col1">artist</th>        <th class="col_heading level0 col2">tags</th>    </tr>
</thead>
<tbody>
                <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row0" class="row_heading level0 row0">0</th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row0_col0" class="data row0 col0">Billie Jean</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row0_col1" class="data row0 col1">Michael Jackson</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row0_col2" class="data row0 col2">rock, pop, favorites, alternative, love, male vocalists, american, classic rock, awesome, beautiful, soul, oldies, favorite, 80s, dance, singer-songwriter, 90s, classic, favourites, cool, 70s, catchy, favorite songs, rnb, male vocalist, electronic, sexy, loved, fun, party, favourite, pop rock, funk, amazing, usa, rhythm and blues, memories, funky, r&amp;b, best, nostalgia, energetic, top 40, old school, nice, english, rb, urban, groovy, disco, perfect, guilty pleasures, 80's, brilliant, my favorites, guilty pleasure, 1980s, retro, masterpiece, motown, classics, best songs ever, classic soul, legend</td>
            </tr>
            <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row1" class="row_heading level0 row1">48164 </th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row1_col0" class="data row1 col0">Heartbeat</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row1_col1" class="data row1 col1">Could Nothings</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row1_col2" class="data row1 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row2" class="row_heading level0 row2">30835 </th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row2_col0" class="data row2 col0">Steve's Tune</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row2_col1" class="data row2 col1">Steve Lambert</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row2_col2" class="data row2 col2">['no tag']</td>
            </tr>
            <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row3" class="row_heading level0 row3">11901 </th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row3_col0" class="data row3 col0">So Much Trouble In The World</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row3_col1" class="data row3 col1">Bob Marley &amp; The Wailers</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row3_col2" class="data row3 col2">['mellow', 'chill', 'classic', 'favourites', 'cool', '70s', 'favourite', 'sad', 'great song', 'summer', 'relax', 'best', 'drjazzmrfunkmusic', 'reggae', 'the best', 'legend']</td>
            </tr>
            <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row4" class="row_heading level0 row4">70557 </th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row4_col0" class="data row4 col0">Carmelita</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row4_col1" class="data row4 col1">Warren Zevon</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row4_col2" class="data row4 col2">['rock', 'classic rock', 'mellow', 'singer-songwriter', '70s', 'hard rock', 'guitar', 'male vocalist', 'folk', 'acoustic', 'progressive rock', 'vocal', 'folk rock', 'americana', 'radioparadise', 'covers', 'perfect', 'radio paradise', 'my pop music', 'southern rock']</td>
            </tr>
            <tr>
                        <th id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002level0_row5" class="row_heading level0 row5">14550 </th>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row5_col0" class="data row5 col0">Heavy</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row5_col1" class="data row5 col1">Collective Soul</td>
                        <td id="T_0e25e2c4_e165_11eb_afea_0242ac1c0002row5_col2" class="data row5 col2">['rock', 'pop', 'favorites', 'alternative', 'male vocalists', 'awesome', '00s', 'alternative rock', '90s', 'hard rock', 'loved', 'upbeat', 'great song', 'memories', 'progressive rock', 'grunge', 'faves', 'heavy', 'a subtle use of vocal harmony', 'favs']</td>
            </tr>
    </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="recohut/notebook"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/word2vec/embedding/music/sequence/2021/07/10/songs-embedding-skipgram-recommender.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Jupyter notebook database.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/recohut" target="_blank" title="recohut"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
