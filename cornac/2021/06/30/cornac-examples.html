<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Cornac Examples | reconb</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Cornac Examples" />
<meta name="author" content="<a href='https://nbviewer.jupyter.org/github/PreferredAI/tutorials/tree/master/recommender-systems/'>Cornac</a>" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Multiple examples showcasing the features of cornac library and recommender concepts" />
<meta property="og:description" content="Multiple examples showcasing the features of cornac library and recommender concepts" />
<link rel="canonical" href="https://nb.recohut.com/cornac/2021/06/30/cornac-examples.html" />
<meta property="og:url" content="https://nb.recohut.com/cornac/2021/06/30/cornac-examples.html" />
<meta property="og:site_name" content="reconb" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-30T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Cornac Examples" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"<a href='https://nbviewer.jupyter.org/github/PreferredAI/tutorials/tree/master/recommender-systems/'>Cornac</a>"},"dateModified":"2021-06-30T00:00:00-05:00","datePublished":"2021-06-30T00:00:00-05:00","description":"Multiple examples showcasing the features of cornac library and recommender concepts","headline":"Cornac Examples","mainEntityOfPage":{"@type":"WebPage","@id":"https://nb.recohut.com/cornac/2021/06/30/cornac-examples.html"},"url":"https://nb.recohut.com/cornac/2021/06/30/cornac-examples.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://nb.recohut.com/feed.xml" title="reconb" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">reconb</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Cornac Examples</h1><p class="page-description">Multiple examples showcasing the features of cornac library and recommender concepts</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-06-30T00:00:00-05:00" itemprop="datePublished">
        Jun 30, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name"><a href='https://nbviewer.jupyter.org/github/PreferredAI/tutorials/tree/master/recommender-systems/'>Cornac</a></span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      25 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#Cornac">Cornac</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/recohut/notebook/tree/master/_notebooks/2021-06-30-cornac-examples.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/recohut/notebook/master?filepath=_notebooks%2F2021-06-30-cornac-examples.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/recohut/notebook/blob/master/_notebooks/2021-06-30-cornac-examples.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Frecohut%2Fnotebook%2Fblob%2Fmaster%2F_notebooks%2F2021-06-30-cornac-examples.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#EDA">EDA </a></li>
<li class="toc-entry toc-h2"><a href="#Recomendations-based-on-item-popularity">Recomendations based on item popularity </a></li>
<li class="toc-entry toc-h2"><a href="#User-based-collaborative-filtering">User-based collaborative filtering </a></li>
<li class="toc-entry toc-h2"><a href="#Item-based-collaborative-filtering">Item-based collaborative filtering </a></li>
<li class="toc-entry toc-h2"><a href="#Matrix-factorization">Matrix factorization </a></li>
<li class="toc-entry toc-h2"><a href="#Implicit-matrix-factorization">Implicit matrix factorization </a></li>
<li class="toc-entry toc-h2"><a href="#Neural-Collaborative-Filtering">Neural Collaborative Filtering </a></li>
<li class="toc-entry toc-h2"><a href="#Variational-Autoencoder-for-Collaborative-Filtering-(VAECF)">Variational Autoencoder for Collaborative Filtering (VAECF) </a></li>
<li class="toc-entry toc-h2"><a href="#Running-Experiment">Running Experiment </a></li>
<li class="toc-entry toc-h2"><a href="#PMF-ratio">PMF ratio </a></li>
<li class="toc-entry toc-h2"><a href="#Given-data">Given data </a></li>
<li class="toc-entry toc-h2"><a href="#C2PF">C2PF </a></li>
<li class="toc-entry toc-h2"><a href="#Hyperparameters">Hyperparameters </a></li>
<li class="toc-entry toc-h2"><a href="#Social-BPR">Social BPR </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-06-30-cornac-examples.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">U</span> <span class="n">cornac</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>     |████████████████████████████████| 13.4MB 194kB/s 
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">cornac</span>
<span class="n">cornac</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'1.4.1'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span><span class="p">,</span> <span class="n">sparse</span>

<span class="kn">from</span> <span class="nn">cornac.data</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">cornac.datasets</span> <span class="kn">import</span> <span class="n">movielens</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">UserKNN</span><span class="p">,</span> <span class="n">ItemKNN</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">MF</span><span class="p">,</span> <span class="n">NMF</span><span class="p">,</span> <span class="n">BaselineOnly</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">BPR</span><span class="p">,</span> <span class="n">WMF</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">GMF</span><span class="p">,</span> <span class="n">MLP</span><span class="p">,</span> <span class="n">NeuMF</span><span class="p">,</span> <span class="n">VAECF</span><span class="p">,</span> <span class="n">WMF</span>

<span class="o">%</span><span class="n">tensorflow_version</span> <span class="mf">1.</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="EDA">
<a class="anchor" href="#EDA" aria-hidden="true"><span class="octicon octicon-link"></span></a>EDA<a class="anchor-link" href="#EDA"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">df_100k3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./data/ml-100k/ratings.csv'</span><span class="p">,</span>
                 <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s2">"UserId"</span><span class="p">,</span><span class="s2">"MovieId"</span><span class="p">,</span><span class="s2">"Rating"</span><span class="p">])</span>
<span class="n">df_100k3</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span> <span class="s2">"item_id"</span><span class="p">,</span> <span class="s2">"rating"</span><span class="p">]</span>
<span class="n">df_100k3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>item_id</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>186</td>
      <td>302</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>377</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>244</td>
      <td>51</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>166</td>
      <td>346</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">df_user_100k</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./data/ml-100k/users.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"UserID"</span><span class="p">)</span>
<span class="n">df_user_100k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Occupation</th>
      <th>Zip Code</th>
    </tr>
    <tr>
      <th>UserID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>24</td>
      <td>M</td>
      <td>technician</td>
      <td>85711</td>
    </tr>
    <tr>
      <th>2</th>
      <td>53</td>
      <td>F</td>
      <td>other</td>
      <td>94043</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23</td>
      <td>M</td>
      <td>writer</td>
      <td>32067</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24</td>
      <td>M</td>
      <td>technician</td>
      <td>43537</td>
    </tr>
    <tr>
      <th>5</th>
      <td>33</td>
      <td>F</td>
      <td>other</td>
      <td>15213</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">df_item_100k</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'./data/ml-100k/items.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"ItemID"</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">"Video Release Date"</span><span class="p">,</span> <span class="s2">"IMDb URL"</span><span class="p">,</span> <span class="s2">"unknown"</span><span class="p">])</span>
<span class="n">df_item_100k</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Title</th>
      <th>Release Date</th>
      <th>Action</th>
      <th>Adventure</th>
      <th>Animation</th>
      <th>Children's</th>
      <th>Comedy</th>
      <th>Crime</th>
      <th>Documentary</th>
      <th>Drama</th>
      <th>Fantasy</th>
      <th>Film-Noir</th>
      <th>Horror</th>
      <th>Musical</th>
      <th>Mystery</th>
      <th>Romance</th>
      <th>Sci-Fi</th>
      <th>Thriller</th>
      <th>War</th>
      <th>Western</th>
    </tr>
    <tr>
      <th>ItemID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Toy Story (1995)</td>
      <td>01-Jan-1995</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>GoldenEye (1995)</td>
      <td>01-Jan-1995</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Four Rooms (1995)</td>
      <td>01-Jan-1995</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Get Shorty (1995)</td>
      <td>01-Jan-1995</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Copycat (1995)</td>
      <td>01-Jan-1995</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Rating distribution</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"rating"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">"ch:.25"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"rating"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">"ch:.25"</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fe392c6e8d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sparsity</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">print_sparsity</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">n_users</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">user_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
  <span class="n">n_items</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">item_id</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
  <span class="n">n_ratings</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
  <span class="n">rating_matrix_size</span> <span class="o">=</span> <span class="n">n_users</span> <span class="o">*</span> <span class="n">n_items</span>
  <span class="n">sparsity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">n_ratings</span> <span class="o">/</span> <span class="n">rating_matrix_size</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of users: </span><span class="si">{</span><span class="n">n_users</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of items: </span><span class="si">{</span><span class="n">n_items</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of available ratings: </span><span class="si">{</span><span class="n">n_ratings</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Number of all possible ratings: </span><span class="si">{</span><span class="n">rating_matrix_size</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"-"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"SPARSITY: </span><span class="si">{</span><span class="n">sparsity</span> <span class="o">*</span> <span class="mf">100.0</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%"</span><span class="p">)</span>

<span class="n">print_sparsity</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of users: 943
Number of items: 1682
Number of available ratings: 100000
Number of all possible ratings: 1586126
----------------------------------------
SPARSITY: 93.70%
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this MovieLens dataset, the data has been prepared in such a way that each user has at least 20 ratings. As a result, it's relatively dense as compared to many other recommendation datasets that are usually much sparser (often 99% or more).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Power Law Distribution</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">item_rate_count</span> <span class="o">=</span> <span class="n">df_100k3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"item_id"</span><span class="p">)[</span><span class="s2">"user_id"</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">item_rate_count</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">item_rate_count</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">"edge"</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"long tail of rating frequency"</span><span class="p">,</span> 
            <span class="n">xlabel</span><span class="o">=</span><span class="s2">"item ordered by decreasing frequency"</span><span class="p">,</span> 
            <span class="n">ylabel</span><span class="o">=</span><span class="s2">"#ratings"</span><span class="p">)</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">item_rate_count</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">count</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">count</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"log-log plot"</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">"#ratings (log scale)"</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">"#items (log scale)"</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>User profiling</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_uir</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">uknn_pearson</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Pearson"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">uid_map</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>118</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">user_profiling</span><span class="p">(</span><span class="n">UID</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">user_df</span><span class="p">,</span> <span class="n">item_df</span><span class="p">,</span> <span class="n">TOPK</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
  <span class="n">dataset</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_uir</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
  <span class="n">uknn_pearson</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Pearson"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

  <span class="n">rating_mat</span> <span class="o">=</span> <span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">matrix</span>
  <span class="n">user_id2idx</span> <span class="o">=</span> <span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">uid_map</span>
  <span class="n">user_idx2id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">user_ids</span><span class="p">)</span>
  <span class="n">item_id2idx</span> <span class="o">=</span> <span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">iid_map</span>
  <span class="n">item_idx2id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">item_ids</span><span class="p">)</span>

  <span class="n">UIDX</span> <span class="o">=</span> <span class="n">uknn_pearson</span><span class="o">.</span><span class="n">train_set</span><span class="o">.</span><span class="n">uid_map</span><span class="p">[</span><span class="n">UID</span><span class="p">]</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"UserID = </span><span class="si">{</span><span class="n">UID</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">"-"</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">user_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">UID</span><span class="p">])</span>

  <span class="n">rating_arr</span> <span class="o">=</span> <span class="n">rating_mat</span><span class="p">[</span><span class="n">UIDX</span><span class="p">]</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
  <span class="n">top_rated_items</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">rating_arr</span><span class="p">)[</span><span class="o">-</span><span class="n">TOPK</span><span class="p">:]</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">TOP </span><span class="si">{</span><span class="n">TOPK</span><span class="si">}</span><span class="s2"> RATED ITEMS BY USER </span><span class="si">{</span><span class="n">UID</span><span class="si">}</span><span class="s2">:"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">item_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="nb">int</span><span class="p">(</span><span class="n">item_idx2id</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">top_rated_items</span><span class="p">]])</span>

<span class="n">user_profiling</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">df_100k3</span><span class="p">,</span> <span class="n">df_user_100k</span><span class="p">,</span> <span class="n">df_item_100k</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>UserID = 2
-------------------------
Age              53
Gender            F
Occupation    other
Zip Code      94043
Name: 2, dtype: object

TOP 5 RATED ITEMS BY USER 2:
                                Title Release Date  ...  War  Western
ItemID                                              ...              
50                   Star Wars (1977)  01-Jan-1977  ...    1        0
251            Shall We Dance? (1996)  11-Jul-1997  ...    0        0
272          Good Will Hunting (1997)  01-Jan-1997  ...    0        0
311     Wings of the Dove, The (1997)  01-Jan-1997  ...    0        0
242                      Kolya (1996)  24-Jan-1997  ...    0        0

[5 rows x 20 columns]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Recomendations-based-on-item-popularity">
<a class="anchor" href="#Recomendations-based-on-item-popularity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Recomendations based on item popularity<a class="anchor-link" href="#Recomendations-based-on-item-popularity"> </a>
</h2>
<p>Since some items are much more popular than the rest, intuitively many users may prefer these popular items. From that observation, it inspires a simple approach for providing recommendations based on popularity (i.e., number of ratings) of the items.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">'''Let's do a simple experiment with the popularity approach. In this </span>
<span class="sd">experiment, we will split the rating data into 5 folds for cross-validation. </span>
<span class="sd">For each run, 4 folds will be used for training and the remaining fold will </span>
<span class="sd">be used for evaluation. We measure the recommendation performance using </span>
<span class="sd">Recall@20 metric.'''</span>

<span class="k">def</span> <span class="nf">itempop_cornac</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">'user_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">,</span> <span class="s1">'item_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">})</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
  <span class="n">eval_method</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">eval_methods</span><span class="o">.</span><span class="n">CrossValidation</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># 5-fold cross validation</span>
  <span class="n">most_pop</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MostPop</span><span class="p">()</span> <span class="c1"># recommender system based on item popularity</span>
  <span class="n">rec_20</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1"># recall@20 metric</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">eval_method</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">most_pop</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">rec_20</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span> <span class="c1"># put everything together into an experiment</span>

<span class="n">itempop_cornac</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
[MostPop]
       | Recall@20 | Train (s) | Test (s)
------ + --------- + --------- + --------
Fold 0 |    0.1263 |    0.0054 |   0.4017
Fold 1 |    0.1304 |    0.0053 |   0.3883
Fold 2 |    0.1337 |    0.0055 |   0.4014
Fold 3 |    0.1252 |    0.0058 |   0.4019
Fold 4 |    0.1187 |    0.0054 |   0.4046
------ + --------- + --------- + --------
Mean   |    0.1269 |    0.0055 |   0.3996
Std    |    0.0051 |    0.0002 |   0.0058

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="User-based-collaborative-filtering">
<a class="anchor" href="#User-based-collaborative-filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>User-based collaborative filtering<a class="anchor-link" href="#User-based-collaborative-filtering"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">userknn_cornac</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">'user_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">,</span> <span class="s1">'item_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">})</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
  <span class="n">K</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># number of nearest neighbors</span>
  <span class="n">VERBOSE</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span>
  <span class="n">uknn_cosine</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"cosine"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Cosine"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">uknn_cosine_mc</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"cosine"</span><span class="p">,</span> <span class="n">mean_centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Cosine-MC"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">uknn_pearson</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Pearson"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">uknn_pearson_mc</span> <span class="o">=</span> <span class="n">UserKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">mean_centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"UserKNN-Pearson-MC"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
                    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">uknn_cosine</span><span class="p">,</span> <span class="n">uknn_cosine_mc</span><span class="p">,</span> <span class="n">uknn_pearson</span><span class="p">,</span> <span class="n">uknn_pearson_mc</span><span class="p">],</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">()],</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">userknn_cornac</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
                   |   RMSE | Train (s) | Test (s)
------------------ + ------ + --------- + --------
UserKNN-Cosine     | 0.9102 |    0.1444 |   1.3036
UserKNN-Cosine-MC  | 0.8947 |    0.1369 |   1.2839
UserKNN-Pearson    | 0.8947 |    0.1458 |   1.2950
UserKNN-Pearson-MC | 0.8947 |    0.1360 |   1.2894

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Item-based-collaborative-filtering">
<a class="anchor" href="#Item-based-collaborative-filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Item-based collaborative filtering<a class="anchor-link" href="#Item-based-collaborative-filtering"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">itemknn_cornac</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">'user_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">,</span> <span class="s1">'item_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">})</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
  <span class="n">K</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># number of nearest neighbors</span>
  <span class="n">VERBOSE</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span>
  <span class="n">iknn_cosine</span> <span class="o">=</span> <span class="n">ItemKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"cosine"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"ItemKNN-Cosine"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">iknn_cosine_mc</span> <span class="o">=</span> <span class="n">ItemKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"cosine"</span><span class="p">,</span> <span class="n">mean_centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"ItemKNN-AdjustedCosine"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">iknn_pearson</span> <span class="o">=</span> <span class="n">ItemKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"ItemKNN-Pearson"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">iknn_pearson_mc</span> <span class="o">=</span> <span class="n">ItemKNN</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">similarity</span><span class="o">=</span><span class="s2">"pearson"</span><span class="p">,</span> <span class="n">mean_centered</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"ItemKNN-Pearson-MC"</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
                    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">iknn_cosine</span><span class="p">,</span> <span class="n">iknn_cosine_mc</span><span class="p">,</span> <span class="n">iknn_pearson</span><span class="p">,</span> <span class="n">iknn_pearson_mc</span><span class="p">],</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">()],</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">itemknn_cornac</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
                       |   RMSE | Train (s) | Test (s)
---------------------- + ------ + --------- + --------
ItemKNN-Cosine         | 0.9687 |    0.2175 |   1.3857
ItemKNN-AdjustedCosine | 0.9099 |    0.2107 |   1.4040
ItemKNN-Pearson        | 0.9624 |    0.2462 |   1.3763
ItemKNN-Pearson-MC     | 0.9573 |    0.2374 |   1.3883

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Matrix-factorization">
<a class="anchor" href="#Matrix-factorization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Matrix factorization<a class="anchor-link" href="#Matrix-factorization"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">mf_cornac</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">'user_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">,</span> <span class="s1">'item_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">})</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
  <span class="n">K</span> <span class="o">=</span> <span class="mi">100</span>
  <span class="n">VERBOSE</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span>
  <span class="n">lbd</span> <span class="o">=</span> <span class="mf">0.01</span>
  <span class="n">baseline</span> <span class="o">=</span> <span class="n">BaselineOnly</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="n">lbd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">mf1</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"MF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
  <span class="n">mf2</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="n">lbd</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"MF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">,lambda=</span><span class="si">{</span><span class="n">lbd</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
  <span class="n">mf3</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="n">lbd</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"MF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">,bias)"</span><span class="p">)</span>
  <span class="n">nmf</span> <span class="o">=</span> <span class="n">NMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"NMF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
  <span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
                    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">baseline</span><span class="p">,</span> <span class="n">mf1</span><span class="p">,</span> <span class="n">mf2</span><span class="p">,</span> <span class="n">mf3</span><span class="p">,</span> <span class="n">nmf</span><span class="p">],</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">()],</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">mf_cornac</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
                        |   RMSE | Train (s) | Test (s)
----------------------- + ------ + --------- + --------
BaselineOnly            | 0.8892 |    0.0113 |   0.2159
MF(K=100)               | 0.8665 |    0.5043 |   0.2463
MF(K=100,lambda=0.0100) | 0.8647 |    0.5154 |   0.2466
MF(K=100,bias)          | 0.8614 |    0.5224 |   0.2324
NMF(K=100)              | 0.8807 |    8.7957 |   0.2519

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implicit-matrix-factorization">
<a class="anchor" href="#Implicit-matrix-factorization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Implicit matrix factorization<a class="anchor-link" href="#Implicit-matrix-factorization"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">implicitmf_cornac</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">'user_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">,</span> <span class="s1">'item_id'</span><span class="p">:</span><span class="nb">object</span><span class="p">})</span>
  <span class="n">records</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_records</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">result</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>

  <span class="n">K</span> <span class="o">=</span> <span class="mi">50</span>
  <span class="n">VERBOSE</span> <span class="o">=</span> <span class="kc">False</span>
  <span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span>
  <span class="n">mf</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"MF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
  <span class="n">wmf</span> <span class="o">=</span> <span class="n">WMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_u</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_v</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"WMF(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
  <span class="n">bpr</span> <span class="o">=</span> <span class="n">BPR</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">"BPR(K=</span><span class="si">{</span><span class="n">K</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

  <span class="n">eval_metrics</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">(),</span> 
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">AUC</span><span class="p">(),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">FMeasure</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">NDCG</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">MRR</span><span class="p">(),</span>
  <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">MAP</span><span class="p">()</span>
  <span class="p">]</span>

  <span class="n">rs</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>

  <span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">rs</span><span class="p">,</span>
                    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">mf</span><span class="p">,</span> <span class="n">wmf</span><span class="p">,</span> <span class="n">bpr</span><span class="p">],</span>
                    <span class="n">metrics</span><span class="o">=</span><span class="n">eval_metrics</span><span class="p">,</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="n">implicitmf_cornac</span><span class="p">(</span><span class="n">df_100k3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
          |   RMSE |    AUC |  F1@10 |    MAP |    MRR | NDCG@10 | NDCG@20 | NDCG@30 | Precision@10 | Recall@10 | Train (s) | Test (s)
--------- + ------ + ------ + ------ + ------ + ------ + ------- + ------- + ------- + ------------ + --------- + --------- + --------
MF(K=50)  | 0.8909 | 0.6573 | 0.0290 | 0.0402 | 0.1453 |  0.0539 |  0.0565 |  0.0626 |       0.0524 |    0.0241 |    0.2498 |   2.0077
WMF(K=50) | 1.1012 | 0.8980 | 0.0734 | 0.0956 | 0.2387 |  0.1068 |  0.1292 |  0.1506 |       0.0968 |    0.0800 |    6.4536 |   2.1959
BPR(K=50) | 1.5631 | 0.9356 | 0.0859 | 0.1146 | 0.2337 |  0.1096 |  0.1393 |  0.1662 |       0.0938 |    0.1000 |    6.5871 |   1.9878

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can observe, the strength of the MF model is the ability to predict ratings well (lower RMSE). However, WMF model is designed to rank items, by fitting binary adoptions, thus it outperforms MF across all the listed ranking metrics.</p>
<p>BPR only tries to preserve the ordinal constraints without learning to predict the rating values. Thus, RMSE is not the right metric to evaluate BPR model. Minimizing the loss function of BPR is analogous to maximizing AUC, therefore, we expect BPR to do well on that metric.</p>
<p>Both BPR and WMF models are designed to obtain good performances in terms of ranking metrics. With reasonable efforts for hyper-parameter tuning, we should see comparable performance between the two models.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Neural-Collaborative-Filtering">
<a class="anchor" href="#Neural-Collaborative-Filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Neural Collaborative Filtering<a class="anchor-link" href="#Neural-Collaborative-Filtering"> </a>
</h2>
<p>Neural collaborative filtering consists of a family of models developed based on neural networks to tackle the problem of collaborative filtering based on implicit feedback. The final model NeuMF is a combination of two components, namely Generalized Matrix Factorization (GMF) and Multi-Layer Perceptrons (MLP), which are also independent models respectively.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">GMF_FACTORS</span> <span class="o">=</span> <span class="mi">8</span>  <span class="c1"># @param</span>
<span class="n">MLP_LAYERS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>  <span class="c1"># @param</span>
<span class="n">ACTIVATION</span> <span class="o">=</span> <span class="s2">"tanh"</span>  <span class="c1"># @param ["tanh", "sigmoid", "relu", "leaky_relu"]</span>
<span class="n">NEG_SAMPLES</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># @param</span>
<span class="n">NUM_EPOCHS</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># @param </span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c1"># @param</span>
<span class="n">LEARNING_RATE</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># @param</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">gmf</span> <span class="o">=</span> <span class="n">GMF</span><span class="p">(</span><span class="n">num_factors</span><span class="o">=</span><span class="n">GMF_FACTORS</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="n">NUM_EPOCHS</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> 
          <span class="n">num_neg</span><span class="o">=</span><span class="n">NEG_SAMPLES</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">LEARNING_RATE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="n">MLP_LAYERS</span><span class="p">,</span> <span class="n">act_fn</span><span class="o">=</span><span class="n">ACTIVATION</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="n">NUM_EPOCHS</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> 
          <span class="n">num_neg</span><span class="o">=</span><span class="n">NEG_SAMPLES</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">LEARNING_RATE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>
<span class="n">neumf</span> <span class="o">=</span> <span class="n">NeuMF</span><span class="p">(</span><span class="n">num_factors</span><span class="o">=</span><span class="n">GMF_FACTORS</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="n">MLP_LAYERS</span><span class="p">,</span> <span class="n">act_fn</span><span class="o">=</span><span class="n">ACTIVATION</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="n">NUM_EPOCHS</span><span class="p">,</span>
              <span class="n">num_neg</span><span class="o">=</span><span class="n">NEG_SAMPLES</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="n">LEARNING_RATE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>

<span class="n">wmf</span> <span class="o">=</span> <span class="n">WMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">GMF_FACTORS</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>

<span class="n">ml_100k</span> <span class="o">=</span> <span class="n">movielens</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">(</span><span class="n">variant</span><span class="o">=</span><span class="s2">"100K"</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">Reader</span><span class="p">(</span><span class="n">bin_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">))</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span>
  <span class="n">data</span><span class="o">=</span><span class="n">ml_100k</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span>
<span class="p">)</span>
<span class="n">ndcg_50</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">NDCG</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">rec_50</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
  <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
  <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">gmf</span><span class="p">,</span> <span class="n">mlp</span><span class="p">,</span> <span class="n">neumf</span><span class="p">,</span> <span class="n">wmf</span><span class="p">],</span>
  <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ndcg_50</span><span class="p">,</span> <span class="n">rec_50</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Data from http://files.grouplens.org/datasets/movielens/ml-100k/u.data
will be cached into /root/.cornac/ml-100k/u.data

File cached!

TEST:
...
      | NDCG@50 | Recall@50 | Train (s) | Test (s)
----- + ------- + --------- + --------- + --------
GMF   |  0.1609 |    0.2778 |   28.6248 |   1.0193
MLP   |  0.1630 |    0.2807 |   29.0589 |   1.1897
NeuMF |  0.2412 |    0.4268 |   29.9544 |   1.2884
WMF   |  0.1976 |    0.3753 |    9.2373 |   0.5958

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Variational-Autoencoder-for-Collaborative-Filtering-(VAECF)">
<a class="anchor" href="#Variational-Autoencoder-for-Collaborative-Filtering-(VAECF)" aria-hidden="true"><span class="octicon octicon-link"></span></a>Variational Autoencoder for Collaborative Filtering (VAECF)<a class="anchor-link" href="#Variational-Autoencoder-for-Collaborative-Filtering-(VAECF)"> </a>
</h2>
<p>Variational Autoencoders (VAE) is a type of autoencoders which is a neural network with auto-associative mapping of inputs. Normal autoencoders learns a determinisic latent representation of an input, while VAE learns a distribution of that representation. VAECF model extends VAE for the collaborative filtering problem with implicit feedback data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">NUM_FACTORS</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># @param</span>
<span class="n">AE_LAYERS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>  <span class="c1"># @param</span>
<span class="n">ACTIVATION</span> <span class="o">=</span> <span class="s2">"tanh"</span>  <span class="c1"># @param ["tanh", "sigmoid", "relu", "leaky_relu"]</span>
<span class="n">LIKELIHOOD</span> <span class="o">=</span> <span class="s2">"bern"</span>  <span class="c1"># @param ["bern", "mult", "gaus", "pois"]</span>
<span class="n">NUM_EPOCHS</span> <span class="o">=</span> <span class="mi">600</span>  <span class="c1"># @param </span>
<span class="n">BATCH_SIZE</span> <span class="o">=</span> <span class="mi">256</span>  <span class="c1"># @param</span>
<span class="n">LEARNING_RATE</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># @param</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">vaecf</span> <span class="o">=</span> <span class="n">VAECF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">NUM_FACTORS</span><span class="p">,</span> <span class="n">autoencoder_structure</span><span class="o">=</span><span class="n">AE_LAYERS</span><span class="p">,</span> <span class="n">act_fn</span><span class="o">=</span><span class="n">ACTIVATION</span><span class="p">,</span>
              <span class="n">likelihood</span><span class="o">=</span><span class="n">LIKELIHOOD</span><span class="p">,</span> <span class="n">n_epochs</span><span class="o">=</span><span class="n">NUM_EPOCHS</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCH_SIZE</span><span class="p">,</span>
              <span class="n">learning_rate</span><span class="o">=</span><span class="n">LEARNING_RATE</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">wmf</span> <span class="o">=</span> <span class="n">WMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">NUM_FACTORS</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span><span class="p">)</span>

<span class="n">ml_100k</span> <span class="o">=</span> <span class="n">movielens</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">(</span><span class="n">variant</span><span class="o">=</span><span class="s2">"100K"</span><span class="p">,</span> <span class="n">reader</span><span class="o">=</span><span class="n">Reader</span><span class="p">(</span><span class="n">bin_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">))</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span>
  <span class="n">data</span><span class="o">=</span><span class="n">ml_100k</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">VERBOSE</span>
<span class="p">)</span>

<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
  <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">vaecf</span><span class="p">,</span> <span class="n">wmf</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">rec_50</span><span class="p">,</span> <span class="n">ndcg_50</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
      | NDCG@50 | Recall@50 | Train (s) | Test (s)
----- + ------- + --------- + --------- + --------
VAECF |  0.2418 |    0.4268 |   56.6568 |   1.0349
WMF   |  0.2045 |    0.3958 |   10.5690 |   0.6070

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Running-Experiment">
<a class="anchor" href="#Running-Experiment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Running Experiment<a class="anchor-link" href="#Running-Experiment"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">cornac</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">MF</span><span class="p">,</span> <span class="n">PMF</span><span class="p">,</span> <span class="n">BPR</span>
<span class="kn">from</span> <span class="nn">cornac.metrics</span> <span class="kn">import</span> <span class="n">MAE</span><span class="p">,</span> <span class="n">RMSE</span><span class="p">,</span> <span class="n">Precision</span><span class="p">,</span> <span class="n">Recall</span><span class="p">,</span> <span class="n">NDCG</span><span class="p">,</span> <span class="n">AUC</span>

<span class="c1"># load the built-in MovieLens 100K and split the data based on ratio</span>
<span class="n">ml_100k</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">movielens</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">()</span>
<span class="n">rs</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ml_100k</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rating_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># initialize models, here we are comparing: Biased MF, PMF, and BPR</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">),</span>
    <span class="n">PMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">),</span>
    <span class="n">BPR</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># define metrics to evaluate the models</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">MAE</span><span class="p">(),</span> <span class="n">RMSE</span><span class="p">(),</span> <span class="n">Precision</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">NDCG</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">AUC</span><span class="p">()]</span>

<span class="c1"># put it together in an experiment, voilà!</span>
<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">rs</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span> <span class="n">user_based</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
    |    MAE |   RMSE |    AUC | NDCG@10 | Precision@10 | Recall@10 | Train (s) | Test (s)
--- + ------ + ------ + ------ + ------- + ------------ + --------- + --------- + --------
MF  | 0.7430 | 0.8998 | 0.7445 |  0.0479 |       0.0437 |    0.0352 |    0.1202 |   1.4422
PMF | 0.7534 | 0.9138 | 0.7744 |  0.0617 |       0.0533 |    0.0479 |    2.2300 |   1.7559
BPR | 2.0143 | 2.2267 | 0.8695 |  0.0975 |       0.0727 |    0.0891 |    3.8556 |   1.4108

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="PMF-ratio">
<a class="anchor" href="#PMF-ratio" aria-hidden="true"><span class="octicon octicon-link"></span></a>PMF ratio<a class="anchor-link" href="#PMF-ratio"> </a>
</h2>
<p>Example to run Probabilistic Matrix Factorization (PMF) model with Ratio Split evaluation strategy</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">cornac</span>
<span class="kn">from</span> <span class="nn">cornac.datasets</span> <span class="kn">import</span> <span class="n">movielens</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">PMF</span>


<span class="c1"># Load the MovieLens 100K dataset</span>
<span class="n">ml_100k</span> <span class="o">=</span> <span class="n">movielens</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">()</span>

<span class="c1"># Instantiate an evaluation method.</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ml_100k</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rating_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Instantiate a PMF recommender model.</span>
<span class="n">pmf</span> <span class="o">=</span> <span class="n">PMF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># Instantiate evaluation metrics.</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">MAE</span><span class="p">()</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">()</span>
<span class="n">rec_20</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">pre_20</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Instantiate and then run an experiment.</span>
<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
    <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">pmf</span><span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">rec_20</span><span class="p">,</span> <span class="n">pre_20</span><span class="p">],</span>
    <span class="n">user_based</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
    |    MAE |   RMSE | Precision@20 | Recall@20 | Train (s) | Test (s)
--- + ------ + ------ + ------------ + --------- + --------- + --------
PMF | 0.7408 | 0.8992 |       0.0502 |    0.0903 |    2.2457 |   1.2484

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Given-data">
<a class="anchor" href="#Given-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Given data<a class="anchor-link" href="#Given-data"> </a>
</h2>
<p>Example on how to train and evaluate a model with provided train and test sets</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">cornac.data</span> <span class="kn">import</span> <span class="n">Reader</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">BaseMethod</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">MF</span>
<span class="kn">from</span> <span class="nn">cornac.metrics</span> <span class="kn">import</span> <span class="n">MAE</span><span class="p">,</span> <span class="n">RMSE</span>
<span class="kn">from</span> <span class="nn">cornac.utils</span> <span class="kn">import</span> <span class="n">cache</span>


<span class="c1"># Download MovieLens 100K provided train and test sets</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">Reader</span><span class="p">()</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">cache</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://files.grouplens.org/datasets/movielens/ml-100k/u1.base"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span>
    <span class="n">cache</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">"http://files.grouplens.org/datasets/movielens/ml-100k/u1.test"</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Instantiate a Base evaluation method using the provided train and test sets</span>
<span class="n">eval_method</span> <span class="o">=</span> <span class="n">BaseMethod</span><span class="o">.</span><span class="n">from_splits</span><span class="p">(</span>
    <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">,</span> <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Instantiate the MF model</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">MF</span><span class="p">(</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">lambda_reg</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Evaluation</span>
<span class="n">test_result</span><span class="p">,</span> <span class="n">val_result</span> <span class="o">=</span> <span class="n">eval_method</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">mf</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">MAE</span><span class="p">(),</span> <span class="n">RMSE</span><span class="p">()],</span> <span class="n">user_based</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">test_result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Data from http://files.grouplens.org/datasets/movielens/ml-100k/u1.base
will be cached into /root/.cornac/u1.base
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>1.60MB [00:00, 2.19MB/s]                           
0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>File cached!
Data from http://files.grouplens.org/datasets/movielens/ml-100k/u1.test
will be cached into /root/.cornac/u1.test
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>401kB [00:00, 852kB/s]                            
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>File cached!
rating_threshold = 1.0
exclude_unknowns = False
---</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 72%|███████▏  | 18/25 [00:00&lt;00:00, 140.99it/s, loss=32731.62]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Training data:
Number of users = 943
Number of items = 1650
Number of ratings = 80000
Max rating = 5.0
Min rating = 1.0
Global mean = 3.5
---
Test data:
Number of users = 459
Number of items = 1410
Number of ratings = 20000
Number of unknown users = 0
Number of unknown items = 32
---
Total users = 943
Total items = 1682

[MF] Training started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 25/25 [00:00&lt;00:00, 129.03it/s, loss=28517.47]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!

[MF] Evaluation started!
   |    MAE |   RMSE | Train (s) | Test (s)
-- + ------ + ------ + --------- + --------
MF | 0.7447 | 0.9166 |    0.1995 |   0.6030

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="C2PF">
<a class="anchor" href="#C2PF" aria-hidden="true"><span class="octicon octicon-link"></span></a>C2PF<a class="anchor-link" href="#C2PF"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Collaborative Context Poisson Factorization (C2PF) with Amazon Office dataset.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">"""Fit to and evaluate C2PF [1] on the Office Amazon dataset.</span>
<span class="sd">[1] Salah, Aghiles, and Hady W. Lauw. A Bayesian Latent Variable Model of User Preferences with Item Context. \</span>
<span class="sd">    In IJCAI, pp. 2667-2674. 2018.</span>
<span class="sd">"""</span>

<span class="kn">from</span> <span class="nn">cornac.data</span> <span class="kn">import</span> <span class="n">GraphModality</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>
<span class="kn">from</span> <span class="nn">cornac.experiment</span> <span class="kn">import</span> <span class="n">Experiment</span>
<span class="kn">from</span> <span class="nn">cornac</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">cornac.models</span> <span class="kn">import</span> <span class="n">C2PF</span>
<span class="kn">from</span> <span class="nn">cornac.datasets</span> <span class="kn">import</span> <span class="n">amazon_office</span> <span class="k">as</span> <span class="n">office</span>


<span class="c1"># In addition to user-item feedback, C2PF integrates item-to-item contextual relationships</span>
<span class="c1"># The necessary data can be loaded as follows</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">office</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">()</span>
<span class="n">contexts</span> <span class="o">=</span> <span class="n">office</span><span class="o">.</span><span class="n">load_graph</span><span class="p">()</span>

<span class="c1"># Instantiate a GraphModality, it makes it convenient to work with graph (network) auxiliary information</span>
<span class="c1"># For more details, please refer to the tutorial on how to work with auxiliary data</span>
<span class="n">item_graph_modality</span> <span class="o">=</span> <span class="n">GraphModality</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">contexts</span><span class="p">)</span>

<span class="c1"># Define an evaluation method to split feedback into train and test sets</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">ratings</span><span class="p">,</span>
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">rating_threshold</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span>
    <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">item_graph</span><span class="o">=</span><span class="n">item_graph_modality</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Instantiate C2PF</span>
<span class="n">c2pf</span> <span class="o">=</span> <span class="n">C2PF</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">variant</span><span class="o">=</span><span class="s2">"c2pf"</span><span class="p">)</span>

<span class="c1"># Evaluation metrics</span>
<span class="n">ndcg</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">NDCG</span><span class="p">(</span><span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mrr</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">MRR</span><span class="p">()</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">pre</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Put everything together into an experiment and run it</span>
<span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">c2pf</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ndcg</span><span class="p">,</span> <span class="n">mrr</span><span class="p">,</span> <span class="n">rec</span><span class="p">,</span> <span class="n">pre</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Data from https://static.preferred.ai/cornac/datasets/amazon_office/rating.zip
will be cached into /root/.cornac/amazon_office/rating.txt
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>213kB [00:01, 171kB/s]                            
0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unzipping ...
File cached!
Data from https://static.preferred.ai/cornac/datasets/amazon_office/context.zip
will be cached into /root/.cornac/amazon_office/context.txt
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>344kB [00:01, 271kB/s]                            
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unzipping ...
File cached!
rating_threshold = 3.5
exclude_unknowns = True
---
Training data:
Number of users = 3698
Number of items = 6405
Number of ratings = 42625
Max rating = 5.0
Min rating = 1.0
Global mean = 4.4
---
Test data:
Number of users = 3269
Number of items = 3549
Number of ratings = 10404
Number of unknown users = 0
Number of unknown items = 0
---
Total users = 3698
Total items = 6405

[C2PF] Training started!
Learning...
Learning completed!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/3269 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
[C2PF] Evaluation started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 3269/3269 [00:09&lt;00:00, 350.86it/s]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
     |    MRR | NDCG@-1 | Precision@20 | Recall@20 | Train (s) | Test (s)
---- + ------ + ------- + ------------ + --------- + --------- + --------
C2PF | 0.0611 |  0.1913 |       0.0136 |    0.0868 | 1314.9453 |   9.3316

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Hyperparameters">
<a class="anchor" href="#Hyperparameters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hyperparameters<a class="anchor-link" href="#Hyperparameters"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">"""Example for hyper-parameter searching with Matrix Factorization"""</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cornac</span>
<span class="kn">from</span> <span class="nn">cornac.datasets</span> <span class="kn">import</span> <span class="n">movielens</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>
<span class="kn">from</span> <span class="nn">cornac.hyperopt</span> <span class="kn">import</span> <span class="n">Discrete</span><span class="p">,</span> <span class="n">Continuous</span>
<span class="kn">from</span> <span class="nn">cornac.hyperopt</span> <span class="kn">import</span> <span class="n">GridSearch</span><span class="p">,</span> <span class="n">RandomSearch</span>


<span class="c1"># Load MovieLens 100K ratings</span>
<span class="n">ml_100k</span> <span class="o">=</span> <span class="n">movielens</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">(</span><span class="n">variant</span><span class="o">=</span><span class="s2">"100K"</span><span class="p">)</span>

<span class="c1"># Define an evaluation method to split feedback into train, validation and test sets</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ml_100k</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">val_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Instantiate MAE and RMSE for evaluation</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">MAE</span><span class="p">()</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">RMSE</span><span class="p">()</span>

<span class="c1"># Define a base MF model with fixed hyper-parameters</span>
<span class="n">mf</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">MF</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">early_stop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Wrap MF model inside GridSearch along with the searching space</span>
<span class="n">gs_mf</span> <span class="o">=</span> <span class="n">GridSearch</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">mf</span><span class="p">,</span>
    <span class="n">space</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Discrete</span><span class="p">(</span><span class="s2">"k"</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
        <span class="n">Discrete</span><span class="p">(</span><span class="s2">"use_bias"</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
        <span class="n">Discrete</span><span class="p">(</span><span class="s2">"lambda_reg"</span><span class="p">,</span> <span class="p">[</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">]),</span>
    <span class="p">],</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">rmse</span><span class="p">,</span>
    <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Wrap MF model inside RandomSearch along with the searching space, try 30 times</span>
<span class="n">rs_mf</span> <span class="o">=</span> <span class="n">RandomSearch</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">mf</span><span class="p">,</span>
    <span class="n">space</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Discrete</span><span class="p">(</span><span class="s2">"k"</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
        <span class="n">Discrete</span><span class="p">(</span><span class="s2">"use_bias"</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]),</span>
        <span class="n">Continuous</span><span class="p">(</span><span class="s2">"lambda_reg"</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">rmse</span><span class="p">,</span>
    <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
    <span class="n">n_trails</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Put everything together into an experiment and run it</span>
<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
    <span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span>
    <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">gs_mf</span><span class="p">,</span> <span class="n">rs_mf</span><span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span><span class="p">],</span>
    <span class="n">user_based</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>rating_threshold = 1.0
exclude_unknowns = True
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 75%|███████▌  | 15/20 [00:00&lt;00:00, 113.22it/s, loss=31685.08]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>---
Training data:
Number of users = 943
Number of items = 1656
Number of ratings = 80000
Max rating = 5.0
Min rating = 1.0
Global mean = 3.5
---
Test data:
Number of users = 925
Number of items = 1254
Number of ratings = 9984
Number of unknown users = 0
Number of unknown items = 0
---
Validation data:
Number of users = 922
Number of items = 1235
Number of ratings = 9988
---
Total users = 943
Total items = 1656

[GridSearch_MF] Training started!
Evaluating: {'k': 10, 'lambda_reg': 0.0001, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 117.48it/s, loss=28069.14]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 135.92it/s, loss=29540.58]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.0001, 'use_bias': True}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 138.72it/s, loss=28466.41]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.001, 'use_bias': False}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 122.73it/s, loss=29679.09]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.001, 'use_bias': True}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 134.49it/s, loss=29168.98]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.01, 'use_bias': False}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 122.54it/s, loss=30386.51]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.01, 'use_bias': True}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 138.90it/s, loss=33891.18]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.1, 'use_bias': False}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 129.45it/s, loss=33907.84]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.1, 'use_bias': True}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
 75%|███████▌  | 15/20 [00:00&lt;00:00, 80.51it/s, loss=30235.88]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.0001, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 79.79it/s, loss=24809.18]
 15%|█▌        | 3/20 [00:00&lt;00:00, 82.12it/s, loss=35532.26]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 30, 'lambda_reg': 0.0001, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 78.13it/s, loss=26479.67]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 80%|████████  | 16/20 [00:00&lt;00:00, 84.55it/s, loss=29081.02]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.001, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 80.98it/s, loss=24763.03]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 80%|████████  | 16/20 [00:00&lt;00:00, 80.95it/s, loss=30655.64]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.001, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 79.88it/s, loss=26515.29]
 10%|█         | 2/20 [00:00&lt;00:00, 90.06it/s, loss=252966.80]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 30, 'lambda_reg': 0.01, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 74.03it/s, loss=26736.58]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 80%|████████  | 16/20 [00:00&lt;00:00, 83.59it/s, loss=31441.78]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.01, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 81.56it/s, loss=28064.21]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 85%|████████▌ | 17/20 [00:00&lt;00:00, 90.88it/s, loss=34440.27]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.1, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 86.20it/s, loss=33572.37]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 80%|████████  | 16/20 [00:00&lt;00:00, 85.06it/s, loss=33991.67]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.1, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 80.74it/s, loss=33831.92]
  5%|▌         | 1/20 [00:00&lt;00:00, 68.43it/s, loss=546675.25]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.0001, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 57.63it/s, loss=22798.65]
  5%|▌         | 1/20 [00:00&lt;00:00, 68.89it/s, loss=41469.27]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.0001, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 60.71it/s, loss=24302.16]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 55%|█████▌    | 11/20 [00:00&lt;00:00, 63.89it/s, loss=33206.38]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.001, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 54.75it/s, loss=23045.52]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 60%|██████    | 12/20 [00:00&lt;00:00, 66.91it/s, loss=33009.37]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.001, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 63.26it/s, loss=24565.52]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 10/20 [00:00&lt;00:00, 53.04it/s, loss=34417.25]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.01, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 55.37it/s, loss=24783.99]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.01, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 55.83it/s, loss=26360.77]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 60%|██████    | 12/20 [00:00&lt;00:00, 59.66it/s, loss=35750.37]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.1, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 58.32it/s, loss=33372.11]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 55%|█████▌    | 11/20 [00:00&lt;00:00, 61.39it/s, loss=34167.66]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.1, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 58.49it/s, loss=33779.37]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Best parameter settings: {'k': 50, 'lambda_reg': 0.01, 'use_bias': False}
RMSE = 0.9220

[GridSearch_MF] Evaluation started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 75%|███████▌  | 15/20 [00:00&lt;00:00, 79.16it/s, loss=33960.62]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
[RandomSearch_MF] Training started!
Evaluating: {'k': 30, 'lambda_reg': 0.08612193189485716, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 77.07it/s, loss=33654.50]
 30%|███       | 6/20 [00:00&lt;00:00, 141.43it/s, loss=38583.63]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 10, 'lambda_reg': 0.06501679843184538, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 100.55it/s, loss=33031.33]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 75%|███████▌  | 15/20 [00:00&lt;00:00, 83.19it/s, loss=33864.39]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.0694755346230901, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 72.34it/s, loss=33263.62]
 15%|█▌        | 3/20 [00:00&lt;00:00, 72.29it/s, loss=62142.05] </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.08344455898777325, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 57.71it/s, loss=32557.79]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 113.03it/s, loss=32853.84]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.06841850071431532, 'use_bias': False}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
100%|██████████| 20/20 [00:00&lt;00:00, 124.30it/s, loss=33150.24]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.05636623382282792, 'use_bias': True}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
 70%|███████   | 14/20 [00:00&lt;00:00, 76.65it/s, loss=35203.05]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.09375336481584197, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 73.56it/s, loss=33380.41]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 10/20 [00:00&lt;00:00, 53.25it/s, loss=33705.49]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.003348765700165698, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 48.41it/s, loss=25168.01]
 10%|█         | 2/20 [00:00&lt;00:00, 119.17it/s, loss=322194.56]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 10, 'lambda_reg': 0.04834871514338827, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 100.29it/s, loss=32004.79]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 10/20 [00:00&lt;00:00, 54.17it/s, loss=34853.15]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.0293367690175802, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 50.23it/s, loss=27899.66]
 10%|█         | 2/20 [00:00&lt;00:00, 114.57it/s, loss=36735.89]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 10, 'lambda_reg': 0.008332232500049594, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 103.31it/s, loss=30316.82]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 55%|█████▌    | 11/20 [00:00&lt;00:00, 61.34it/s, loss=33973.71]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.05440617877888826, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 55.02it/s, loss=32135.47]
  0%|          | 0/20 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 30, 'lambda_reg': 0.05911135478061436, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 69.46it/s, loss=32609.57]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 60%|██████    | 12/20 [00:00&lt;00:00, 76.24it/s, loss=33982.51]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.06601038205965916, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 66.61it/s, loss=32986.09]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 101.00it/s, loss=33249.00]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.08521209412017094, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 100.27it/s, loss=33249.00]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 95%|█████████▌| 19/20 [00:00&lt;00:00, 107.30it/s, loss=29760.30]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.00035195130988261385, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 98.99it/s, loss=29069.75] 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 106.21it/s, loss=30486.16]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.020650725560393792, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
 55%|█████▌    | 11/20 [00:00&lt;00:00, 57.71it/s, loss=33524.53]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.009120595685760981, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 52.97it/s, loss=24341.06]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 70%|███████   | 14/20 [00:00&lt;00:00, 74.48it/s, loss=33847.32]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.05819710438128485, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 74.83it/s, loss=32835.14]
 10%|█         | 2/20 [00:00&lt;00:00, 87.17it/s, loss=251168.25] </pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 30, 'lambda_reg': 0.003045882175220655, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 71.26it/s, loss=25421.24]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 50, 'lambda_reg': 0.021020313541605162, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 52.99it/s, loss=28414.02]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 10/20 [00:00&lt;00:00, 51.96it/s, loss=36176.66]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.0931018404851425, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 50.41it/s, loss=32988.32]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 108.93it/s, loss=28873.34]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.004135755775979635, 'use_bias': False}
Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
 60%|██████    | 12/20 [00:00&lt;00:00, 69.02it/s, loss=33869.27]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.040445801068814305, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 63.04it/s, loss=31712.69]
  5%|▌         | 1/20 [00:00&lt;00:00, 132.08it/s, loss=41573.63]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Evaluating: {'k': 10, 'lambda_reg': 0.07677103563371872, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 110.49it/s, loss=33682.86]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 50%|█████     | 10/20 [00:00&lt;00:00, 54.03it/s, loss=35032.48]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.03065512171145367, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 51.99it/s, loss=28106.60]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 75%|███████▌  | 15/20 [00:00&lt;00:00, 77.31it/s, loss=31036.10]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.007274328332829502, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 74.36it/s, loss=26083.12]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 90%|█████████ | 18/20 [00:00&lt;00:00, 95.74it/s, loss=32830.86]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 10, 'lambda_reg': 0.05198029254841431, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 87.32it/s, loss=32142.98]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 55%|█████▌    | 11/20 [00:00&lt;00:00, 62.66it/s, loss=35979.21]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 50, 'lambda_reg': 0.09457717620040243, 'use_bias': False}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 54.57it/s, loss=33207.05]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 65%|██████▌   | 13/20 [00:00&lt;00:00, 72.72it/s, loss=33535.01]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Evaluating: {'k': 30, 'lambda_reg': 0.022599564709232942, 'use_bias': True}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 20/20 [00:00&lt;00:00, 68.46it/s, loss=29700.91]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!
Best parameter settings: {'k': 50, 'lambda_reg': 0.009120595685760981, 'use_bias': False}
RMSE = 0.9211

[RandomSearch_MF] Evaluation started!

VALIDATION:
...
                |    MAE |   RMSE | Time (s)
--------------- + ------ + ------ + --------
GridSearch_MF   | 0.7229 | 0.9220 |   0.1563
RandomSearch_MF | 0.7212 | 0.9211 |   0.1615

TEST:
...
                |    MAE |   RMSE | Train (s) | Test (s)
--------------- + ------ + ------ + --------- + --------
GridSearch_MF   | 0.7210 | 0.9217 |   11.4011 |   0.1963
RandomSearch_MF | 0.7227 | 0.9245 |   15.3778 |   0.2546

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Social-BPR">
<a class="anchor" href="#Social-BPR" aria-hidden="true"><span class="octicon octicon-link"></span></a>Social BPR<a class="anchor-link" href="#Social-BPR"> </a>
</h2>
<p>Example for Social Bayesian Personalized Ranking (SBPR) with Epinions dataset</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">cornac</span>
<span class="kn">from</span> <span class="nn">cornac.data</span> <span class="kn">import</span> <span class="n">Reader</span><span class="p">,</span> <span class="n">GraphModality</span>
<span class="kn">from</span> <span class="nn">cornac.datasets</span> <span class="kn">import</span> <span class="n">epinions</span>
<span class="kn">from</span> <span class="nn">cornac.eval_methods</span> <span class="kn">import</span> <span class="n">RatioSplit</span>


<span class="c1"># SBPR integrates user social network into Bayesian Personalized Ranking.</span>
<span class="c1"># The necessary data can be loaded as follows</span>
<span class="n">feedback</span> <span class="o">=</span> <span class="n">epinions</span><span class="o">.</span><span class="n">load_feedback</span><span class="p">(</span>
    <span class="n">Reader</span><span class="p">(</span><span class="n">bin_threshold</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># feedback is binarised (turned into implicit) using Reader.</span>
<span class="n">trust</span> <span class="o">=</span> <span class="n">epinions</span><span class="o">.</span><span class="n">load_trust</span><span class="p">()</span>

<span class="c1"># Instantiate a GraphModality, it makes it convenient to work with graph (network) auxiliary information</span>
<span class="c1"># For more details, please refer to the tutorial on how to work with auxiliary data</span>
<span class="n">user_graph_modality</span> <span class="o">=</span> <span class="n">GraphModality</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">trust</span><span class="p">)</span>

<span class="c1"># Define an evaluation method to split feedback into train and test sets</span>
<span class="n">ratio_split</span> <span class="o">=</span> <span class="n">RatioSplit</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">feedback</span><span class="p">,</span>
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">rating_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">exclude_unknowns</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">user_graph</span><span class="o">=</span><span class="n">user_graph_modality</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Instantiate SBPR model</span>
<span class="n">sbpr</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">SBPR</span><span class="p">(</span>
    <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">lambda_u</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
    <span class="n">lambda_v</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span>
    <span class="n">lambda_b</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Use Recall@10 for evaluation</span>
<span class="n">rec_10</span> <span class="o">=</span> <span class="n">cornac</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Recall</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Put everything together into an experiment and run it</span>
<span class="n">cornac</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span><span class="n">eval_method</span><span class="o">=</span><span class="n">ratio_split</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="p">[</span><span class="n">sbpr</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">rec_10</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Data from http://www.trustlet.org/datasets/downloaded_epinions/ratings_data.txt.bz2
will be cached into /root/.cornac/epinions/ratings_data.txt
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2.62MB [00:01, 1.99MB/s]                            
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unzipping ...
File cached!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>0.00B [00:00, ?B/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Data from http://www.trustlet.org/datasets/downloaded_epinions/trust_data.txt.bz2
will be cached into /root/.cornac/epinions/trust_data.txt
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>1.70MB [00:00, 2.19MB/s]                           
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Unzipping ...
File cached!
rating_threshold = 0.5
exclude_unknowns = True
---
Training data:
Number of users = 37153
Number of items = 111967
Number of ratings = 445853
Max rating = 1.0
Min rating = 1.0
Global mean = 1.0
---
Test data:
Number of users = 16312
Number of items = 19302
Number of ratings = 41537
Number of unknown users = 0
Number of unknown items = 0
---
Total users = 37153
Total items = 111967

[SBPR] Training started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Building social data: 100%|██████████| 37153/37153 [00:21&lt;00:00, 1738.91it/s]
100%|██████████| 50/50 [00:10&lt;00:00,  4.77it/s, skipped=0.06%]
  0%|          | 0/16312 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization finished!

[SBPR] Evaluation started!
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 16312/16312 [05:16&lt;00:00, 51.56it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
TEST:
...
     | Recall@10 | Train (s) | Test (s)
---- + --------- + --------- + --------
SBPR |    0.0183 |   40.7528 | 316.3553

</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="recohut/notebook"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/cornac/2021/06/30/cornac-examples.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Jupyter notebook database.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/recohut" target="_blank" title="recohut"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
